/*! For license information please see LICENSES */
(window.webpackJsonp=window.webpackJsonp||[]).push([[13,2,9,10],{332:function(e,t,n){var content=n(370);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(107).default)("4bbf5dd6",content,!0,{sourceMap:!1})},334:function(e,t,n){var content=n(381);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(107).default)("f2cfb362",content,!0,{sourceMap:!1})},335:function(e,t,n){var content=n(383);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(107).default)("540d890d",content,!0,{sourceMap:!1})},336:function(e,t,n){var content=n(385);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(107).default)("ea5f3fec",content,!0,{sourceMap:!1})},343:function(e,t,n){var content=n(368);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(107).default)("102eaadc",content,!0,{sourceMap:!1})},358:function(e,t,n){e.exports=n.p+"img/roofcar.caf06e2.png"},359:function(e,t,n){e.exports=n.p+"img/doorcar.3cd1df8.png"},360:function(e,t,n){e.exports=n.p+"img/bumpercar.66e8ecf.png"},361:function(e,t,n){e.exports=n.p+"img/side-mirrorcar.b540a5d.png"},362:function(e,t,n){e.exports=n.p+"img/handlecar.4f485c0.png"},363:function(e,t,n){e.exports=n.p+"img/clockcar.c595d3a.png"},364:function(e,t,n){e.exports=n.p+"img/starcar.ccbf1b9.png"},365:function(e,t,n){e.exports=n.p+"img/wheelcar.03a56cb.png"},366:function(e,t,n){e.exports=n.p+"img/car.b218231.png"},367:function(e,t,n){"use strict";n(343)},368:function(e,t,n){var r=n(106)(!1);r.push([e.i,".mdi-chevron-down{color:#fff!important}",""]),e.exports=r},369:function(e,t,n){"use strict";var r=n(332),o=n.n(r);n.d(t,"default",(function(){return o.a}))},370:function(e,t,n){var r=n(106)(!1);r.push([e.i,".b8j8u5XfDS{position:fixed;top:0;right:0;width:20rem;height:calc(80vh - 8rem);background-color:rgba(0,0,0,.4);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);overflow-y:scroll}.b8j8u5XfDS::-webkit-scrollbar{width:5px}.b8j8u5XfDS::-webkit-scrollbar-track{background:#f1f1f1}.b8j8u5XfDS::-webkit-scrollbar-thumb{background:#b7b5b5;border-radius:5rem}.b8j8u5XfDS::-webkit-scrollbar-thumb:hover{background:#555}._4jjWhw6XeR{display:flex;justify-content:space-between;margin:1.5rem 1rem}.whpVF-G2oC{align-items:center}.whpVF-G2oC,.uOR0zl9mIS{display:flex;color:#fff;font-size:1.2rem;background-color:rgba(0,0,0,.2);border-radius:32px;padding:2px 8px 2px 6px}.uOR0zl9mIS{margin:2rem 1rem;justify-content:space-between}.KhGkUCyQh-{border:1px solid #a9e3ff;box-shadow:0 0 5px #4cc7f4,inset 0 0 5px #4cc7f4;border-radius:32px}.KhGkUCyQh-,.ura3P-m6At{width:50%;padding:.4rem 0;text-align:center;cursor:pointer}.ura3P-m6At{border-radius:32px}._77XAzxRXDH,.K7yMIIEmii,.Wq6lmqNI5V,.LGmqQCgP6R,.KnnedEmPGh,.nO-FHLDqUa,.IX447pRtiE,.lD4V9a8tnw,.MqTRr2mAoI,.YACOxSVFoZ,.uFEO\\+v1Eni,.TmN4Nc6tHp,._9o2mxzbCRp,.PDTje77suX{font-size:1.2rem;color:#fff;margin-left:1rem;cursor:pointer}._4fi4XCZ\\+H6{width:3em;height:3rem}.VmIGIJyHON{background-color:#b8b5b5;height:.5px}._9ySq4CVH7q{position:fixed;top:calc(80vh - 8rem);right:0;border-right:5px solid #f1f1f1;width:20rem;background-color:rgba(0,0,0,.4);-webkit-backdrop-filter:blur(5px);backdrop-filter:blur(5px);border-bottom-left-radius:1rem;padding-left:1rem;padding-bottom:1rem;padding-right:1rem}.kg9h5d\\+Itx{margin-top:1rem;margin-bottom:1rem;display:flex;justify-content:space-between}.SSUIR5n8VY,.QXE-pXpJEu,.\\+b9nXPX7B3,._7DGcIi---q,.Mh\\+eqUr\\+mi,.iudk4v97ZZ,.lAFrYHHaun,.qhv-k6NVdS,.PnsEpetUdM,.wsRzr8CRtW,.BfxHwDq0Dy,.yQaw5x813H,.RW43zpYrPt,.ONhIrjniwH{width:3.5rem;height:3.5rem;border-radius:50%;display:inline-block}.SSUIR5n8VY{background-color:#0f1110}.QXE-pXpJEu{background-color:#0d0f0e}.\\+b9nXPX7B3{background-color:#e4e4e4}._7DGcIi---q{background-color:#9e9e9e}.Mh\\+eqUr\\+mi{background-color:#47a4dd}.iudk4v97ZZ{background-color:#c6312d}.lAFrYHHaun{background-color:#d39027}.qhv-k6NVdS{background-color:#eb1932}.PnsEpetUdM{background-color:#d7ccb6}.wsRzr8CRtW{background-color:#bf191d}.BfxHwDq0Dy{background-color:#b3adad}.yQaw5x813H{background-color:#366549}.RW43zpYrPt{background-color:#545465}.ONhIrjniwH{background-color:#876c5b}.m\\+koAQkzPM{color:#fff;margin-top:.5rem}",""]),r.locals={position:"b8j8u5XfDS",title:"_4jjWhw6XeR",logo:"whpVF-G2oC",select:"uOR0zl9mIS",selectcol:"KhGkUCyQh-",selectcol1:"ura3P-m6At",menutext:"_77XAzxRXDH",menutext1:"K7yMIIEmii",menutext2:"Wq6lmqNI5V",menutext3:"LGmqQCgP6R",menutext4:"KnnedEmPGh",menutext5:"nO-FHLDqUa",menutext6:"IX447pRtiE",menutext7:"lD4V9a8tnw",menutext8:"MqTRr2mAoI",menutext9:"YACOxSVFoZ",menutext10:"uFEO+v1Eni",menutext11:"TmN4Nc6tHp",menutext12:"_9o2mxzbCRp",menutext13:"PDTje77suX",menuimg:"_4fi4XCZ+H6",divider:"VmIGIJyHON",menucolor:"_9ySq4CVH7q",menuflex:"kg9h5d+Itx",colorselect0:"SSUIR5n8VY",colorselect1:"QXE-pXpJEu",colorselect2:"+b9nXPX7B3",colorselect3:"_7DGcIi---q",colorselect4:"Mh+eqUr+mi",colorselect5:"iudk4v97ZZ",colorselect6:"lAFrYHHaun",colorselect7:"qhv-k6NVdS",colorselect8:"PnsEpetUdM",colorselect9:"wsRzr8CRtW",colorselect10:"BfxHwDq0Dy",colorselect11:"yQaw5x813H",colorselect12:"RW43zpYrPt",colorselect13:"ONhIrjniwH",colorname:"m+koAQkzPM"},e.exports=r},380:function(e,t,n){"use strict";var r=n(334),o=n.n(r);n.d(t,"default",(function(){return o.a}))},381:function(e,t,n){var r=n(106)(!1);r.push([e.i,".zjMQVzxteK{position:fixed;z-index:50;width:100%;height:100%;top:0;left:0;background:#000;display:flex;justify-content:center;align-items:center}.fJ5yGDcKUH{max-width:500px;max-height:200px}.bYjNxH3J09{font-family:fantasy;position:fixed;bottom:1.5rem}.bYjNxH3J09 a{text-decoration:none;color:#fff;font-size:1.6rem}.bYjNxH3J09 a:hover{color:#e8b429}body{justify-content:center;background:#000;height:100vh;padding:0;margin:0}.bM0vxz\\+kTu,body{align-items:center;display:flex}.bM0vxz\\+kTu{background:hsla(0,0%,100%,.1);justify-content:flex-start;position:relative;padding:0 5px;width:200px;margin:25px auto 0}.bM0vxz\\+kTu,.FHbxhDqVe1{border-radius:100px;height:10px}.FHbxhDqVe1{-webkit-animation:_4PzvtLp1K0 3s normal forwards;animation:_4PzvtLp1K0 3s normal forwards;box-shadow:0 10px 40px -10px #fff;background:#fff;width:0}@-webkit-keyframes _4PzvtLp1K0{0%{width:0}to{width:70%}}@keyframes _4PzvtLp1K0{0%{width:0}to{width:70%}}",""]),r.locals={loading:"zjMQVzxteK",img:"fJ5yGDcKUH",text:"bYjNxH3J09",progress:"bM0vxz+kTu",progressvalue:"FHbxhDqVe1",load:"_4PzvtLp1K0"},e.exports=r},382:function(e,t,n){"use strict";var r=n(335),o=n.n(r);n.d(t,"default",(function(){return o.a}))},383:function(e,t,n){var r=n(106)(!1);r.push([e.i,".fiLMp082kg{position:fixed;top:2rem;left:2rem;font-size:1.2rem}.fiLMp082kg a{text-decoration:none;color:#000}.kAOALfLUKD{position:fixed;bottom:2rem;left:2rem;font-size:1.4rem}",""]),r.locals={me:"fiLMp082kg",tutorial:"kAOALfLUKD"},e.exports=r},384:function(e,t,n){"use strict";var r=n(336),o=n.n(r);n.d(t,"default",(function(){return o.a}))},385:function(e,t,n){var r=n(106)(!1);r.push([e.i,".d-COb14seX{position:fixed;bottom:2rem;right:2rem;z-index:1}",""]),r.locals={position:"d-COb14seX"},e.exports=r},391:function(e,t,n){"use strict";n.r(t);var r={props:["openModal"],data:function(){return{page:1,showsetting:!0,namecolor:["Đen mờ","Đen bóng","Trắng bóng","Xám bóng","Xanh nước biển","Đỏ đua bóng","Vàng hướng dương tráng bóng","Rolling sea Coated","Kem Ngà Tráng bóng","Đỏ máu bọc vinyl nhôm bóng","Siêu sương mù bạc bọc vinyl nhôm bóng","Xanh lục bọc vinyl nhôm bóng","Đen xanh lá","Nâu"],hexcolor:["#0f1110","#0d0f0e","#e4e4e4","#9e9e9e","#47a4dd","#c6312d","#d39027","#eb1932","#d7ccb6","#bf191d","#b3adad","#366549","#545465","#876c5b"],dsnamecolor:"Min",colorbefore:1,menutextbefore:1,color:null,carpart:0}},methods:{changeColor:function(e){this.dsnamecolor=this.namecolor[this.colorbefore],document.getElementsByClassName(this.$style["colorselect"+this.colorbefore])[0].style.boxShadow="none",document.getElementsByClassName(this.$style["colorselect"+this.colorbefore])[0].style.border="none",this.dsnamecolor=this.namecolor[e],document.getElementsByClassName(this.$style["colorselect"+e])[0].style.boxShadow="0 0 5px #4cc7f4, inset 0 0 5px #4cc7f4",document.getElementsByClassName(this.$style["colorselect"+e])[0].style.border="1px solid #a9e3ff",this.colorbefore=e,this.color=this.hexcolor[e]},changePage:function(e){0==e&&this.page>1&&(this.page=this.page-1),1==e&&this.page<4&&(this.page=this.page+1)},closeModal:function(){this.$emit("closeMenu")},changeColorFull:function(){this.carpart=0,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext1)[0].style.color="#48ceff",this.menutextbefore=1},changeDuoToneUp:function(){this.carpart=1,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext2)[0].style.color="#48ceff",this.menutextbefore=2},changeDuoToneDown:function(){this.carpart=2,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext3)[0].style.color="#48ceff",this.menutextbefore=3},changenocUp:function(){this.carpart=3,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext4)[0].style.color="#48ceff",this.menutextbefore=4},changenocVai:function(){this.carpart=4,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext5)[0].style.color="#48ceff",this.menutextbefore=5},changeVienKinh:function(){this.carpart=5,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext6)[0].style.color="#48ceff",this.menutextbefore=6},changeCalant:function(){this.carpart=6,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext7)[0].style.color="#48ceff",this.menutextbefore=7},changeGuong:function(){this.carpart=7,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext8)[0].style.color="#48ceff",this.menutextbefore=8},changeNamCua:function(){this.carpart=8,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext9)[0].style.color="#48ceff",this.menutextbefore=9},changeLogo:function(){this.carpart=9,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext10)[0].style.color="#48ceff",this.menutextbefore=10},changeViencop:function(){this.carpart=10,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext11)[0].style.color="#48ceff",this.menutextbefore=11},changeLazang:function(){this.carpart=11,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext12)[0].style.color="#48ceff",this.menutextbefore=12},changeAllDiem:function(){this.carpart=12,document.getElementsByClassName(this.$style["menutext"+this.menutextbefore])[0].style.color="#ffffff",document.getElementsByClassName(this.$style.menutext13)[0].style.color="#48ceff",this.menutextbefore=13}},watch:{openModal:function(e,t){this.showsetting=1==e},color:function(e,t){e&&(0==this.carpart&&this.$emit("changeColor","fullcar",this.color),1==this.carpart&&this.$emit("changeColor","duotoneup",this.color),2==this.carpart&&this.$emit("changeColor","duotonedown",this.color),3==this.carpart&&this.$emit("changeColor","nocup",this.color),4==this.carpart&&this.$emit("changeColor","nocvai",this.color),5==this.carpart&&this.$emit("changeColor","vienkinh",this.color),6==this.carpart&&this.$emit("changeColor","calant",this.color),7==this.carpart&&this.$emit("changeColor","guong",this.color),8==this.carpart&&this.$emit("changeColor","namcua",this.color),9==this.carpart&&this.$emit("changeColor","logo",this.color),10==this.carpart&&this.$emit("changeColor","viencop",this.color),11==this.carpart&&this.$emit("changeColor","lazang",this.color),12==this.carpart&&this.$emit("changeColor","alldiem",this.color))}}},o=(n(367),n(369)),l=n(72),c=n(344),h=n.n(c),d=n(348),f=n(395),m=n(456),v=n(375),y=n(374),x=n(331);var component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{directives:[{name:"show",rawName:"v-show",value:e.showsetting,expression:"showsetting"}]},[r("div",{class:[e.$style.position]},[r("div",{class:[e.$style.title]},[r("div",{class:[e.$style.logo]},[r("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{"fill-rule":"evenodd","clip-path":"evenodd",d:"M20.2449 6.68344C20.0967 6.94319 19.7603 7.03679 19.4935 6.89249L16.8428 5.4586L16.8909 9.34351C16.8946 9.64064 16.6503 9.88441 16.3451 9.888C16.04 9.89159 15.7896 9.65363 15.7859 9.3565L15.7371 5.41502L13.0935 6.74118C12.8222 6.87727 12.489 6.77345 12.3493 6.5093C12.2095 6.24515 12.3161 5.92069 12.5874 5.7846L16.0257 4.05974C16.19 3.97735 16.3856 3.98034 16.5471 4.0677L20.0302 5.95182C20.2969 6.09612 20.3931 6.42368 20.2449 6.68344ZM23.4318 7.55824C23.2625 7.80549 23.3312 8.13953 23.5851 8.30436L26.1081 9.94222L22.5394 11.6797C22.2664 11.8126 22.1558 12.1358 22.2923 12.4016C22.4287 12.6674 22.7606 12.7751 23.0336 12.6422L26.6543 10.8794V13.7751C26.6543 14.0722 26.9016 14.3131 27.2068 14.3131C27.512 14.3131 27.7594 14.0722 27.7594 13.7751V10.0088C27.7594 9.82893 27.667 9.66094 27.5133 9.56116L24.1981 7.40902C23.9441 7.24419 23.6011 7.311 23.4318 7.55824ZM8.32754 8.09628C8.49681 8.34353 8.4282 8.67758 8.17429 8.8424L5.65126 10.4803L9.21999 12.2178C9.49293 12.3507 9.60356 12.6738 9.46709 12.9396C9.33062 13.2054 8.99872 13.3131 8.72578 13.1802L5.10509 11.4174V14.3131C5.10509 14.6103 4.8577 14.8511 4.55254 14.8511C4.24738 14.8511 4 14.6103 4 14.3131V10.5469C4 10.367 4.09233 10.199 4.24605 10.0992L7.5613 7.94706C7.81521 7.78223 8.15827 7.84904 8.32754 8.09628ZM12.5057 14.3566C12.2252 14.2396 11.9004 14.3661 11.7802 14.6392C11.66 14.9123 11.7899 15.2286 12.0704 15.3457L15.6033 16.82V20.7695C15.6033 21.0667 15.8507 21.3076 16.1558 21.3076C16.461 21.3076 16.7084 21.0667 16.7084 20.7695V16.7978L19.7182 15.3324C19.9911 15.1995 20.1018 14.8763 19.9653 14.6105C19.8288 14.3448 19.4969 14.237 19.224 14.3699L16.1379 15.8724L12.5057 14.3566ZM4.96768 18.9307C5.27205 18.9522 5.50095 19.2098 5.47895 19.5062L5.26029 22.4512L8.85827 20.7718C9.13345 20.6434 9.46346 20.7565 9.59536 21.0244C9.72727 21.2924 9.61111 21.6137 9.33593 21.7422L5.68556 23.446L8.0345 25.2218C8.27554 25.404 8.31923 25.742 8.13209 25.9767C7.94495 26.2114 7.59784 26.254 7.3568 26.0717L4.30168 23.7621C4.15575 23.6518 4.0761 23.4777 4.08943 23.2983L4.37674 19.4286C4.39874 19.1322 4.66332 18.9093 4.96768 18.9307ZM26.609 19.5062C26.587 19.2098 26.8159 18.9522 27.1203 18.9307C27.4247 18.9093 27.6892 19.1322 27.7112 19.4286L27.9986 23.2983C28.0119 23.4777 27.9322 23.6518 27.7863 23.7621L24.7312 26.0717C24.4901 26.254 24.143 26.2114 23.9559 25.9767C23.7688 25.742 23.8124 25.404 24.0535 25.2218L26.4024 23.446L22.7521 21.7422C22.4769 21.6137 22.3607 21.2924 22.4926 21.0244C22.6245 20.7565 22.9545 20.6434 23.2297 20.7718L26.8277 22.4512L26.609 19.5062ZM12.5104 27.1944C12.2436 27.0501 11.9072 27.1437 11.759 27.4035C11.6108 27.6632 11.707 27.9908 11.9737 28.1351L15.4568 30.0192C15.6183 30.1065 15.814 30.1095 15.9782 30.0271L19.4165 28.3023C19.6878 28.1662 19.7944 27.8417 19.6547 27.5776C19.5149 27.3134 19.1817 27.2096 18.9104 27.3457L16.2668 28.6719L16.218 24.7304C16.2143 24.4333 15.9639 24.1953 15.6588 24.1989C15.3537 24.2025 15.1093 24.4463 15.113 24.7434L15.1611 28.6283L12.5104 27.1944Z",fill:"currentColor"}})]),e._v("\n          Kingwrap\n      ")]),e._v(" "),r("div",{staticStyle:{color:"#fff"},on:{click:e.closeModal}},[r("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[r("g",{attrs:{"clip-path":"url(#icon_chevron-right_ef5fe580b4e91)"}},[r("path",{attrs:{d:"M10.856 5.88306L21.1444 16.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}}),e._v(" "),r("path",{attrs:{d:"M10.856 27.1169L21.1444 16.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}})]),e._v(" "),r("defs",[r("clipPath",{attrs:{id:"icon_chevron-right_ef5fe580b4e91"}},[r("rect",{attrs:{width:"12",height:"23",fill:"currentColor",transform:"translate(10 5)"}})])])])])]),e._v(" "),r("div",{class:[e.$style.select]},[r("div",{class:[e.$style.selectcol]},[e._v("Màu")]),e._v(" "),r("div",{class:[e.$style.selectcol1]})]),e._v(" "),r("div",{staticStyle:{margin:"1rem","margin-bottom":"0px"}},[r("div",{class:[e.$style.divider]})]),e._v(" "),r("v-list",{attrs:{color:"rgba(255, 0, 0, 0)"}},[r("v-list-item",{on:{click:e.changeColorFull}},[r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none"}},[r("path",{attrs:{d:"M8.11797 18.1738C8.49959 18.1738 8.87264 18.2861 9.18994 18.4964C9.50725 18.7067 9.75455 19.0057 9.90059 19.3554C10.0466 19.7051 10.0848 20.09 10.0104 20.4613C9.93594 20.8326 9.75218 21.1736 9.48233 21.4413C9.21249 21.709 8.86868 21.8913 8.4944 21.9651C8.12011 22.039 7.73215 22.0011 7.37959 21.8562C7.02702 21.7114 6.72567 21.466 6.51366 21.1513C6.30164 20.8365 6.18848 20.4664 6.18848 20.0879C6.18916 19.5804 6.39266 19.094 6.75436 18.7352C7.11607 18.3764 7.60645 18.1745 8.11797 18.1738ZM8.11797 21.1531C8.33036 21.1531 8.53797 21.0906 8.71457 20.9736C8.89116 20.8565 9.0288 20.6902 9.11007 20.4955C9.19135 20.3009 9.21262 20.0867 9.17118 19.8801C9.12975 19.6734 9.02747 19.4836 8.87729 19.3346C8.72711 19.1857 8.53577 19.0842 8.32747 19.0431C8.11916 19.002 7.90325 19.0231 7.70703 19.1037C7.51081 19.1843 7.3431 19.3209 7.2251 19.4961C7.10711 19.6712 7.04413 19.8772 7.04413 20.0879C7.04436 20.3703 7.15756 20.6411 7.3589 20.8409C7.56024 21.0406 7.83324 21.1529 8.11797 21.1531Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M22.6839 18.1738C23.0655 18.1738 23.4386 18.2861 23.7559 18.4964C24.0732 18.7067 24.3205 19.0057 24.4665 19.3554C24.6125 19.7051 24.6508 20.09 24.5763 20.4613C24.5019 20.8326 24.3181 21.1736 24.0482 21.4413C23.7784 21.709 23.4346 21.8913 23.0603 21.9651C22.686 22.039 22.2981 22.0011 21.9455 21.8562C21.5929 21.7114 21.2916 21.466 21.0796 21.1513C20.8676 20.8365 20.7544 20.4664 20.7544 20.0879C20.7551 19.5804 20.9586 19.094 21.3203 18.7352C21.682 18.3764 22.1724 18.1745 22.6839 18.1738ZM22.6839 21.1531C22.8963 21.1531 23.1039 21.0906 23.2805 20.9736C23.4571 20.8565 23.5947 20.6902 23.676 20.4955C23.7573 20.3009 23.7785 20.0867 23.7371 19.8801C23.6957 19.6734 23.5934 19.4836 23.4432 19.3346C23.293 19.1857 23.1017 19.0842 22.8934 19.0431C22.6851 19.002 22.4692 19.0231 22.2729 19.1037C22.0767 19.1843 21.909 19.3209 21.791 19.4961C21.673 19.6712 21.61 19.8772 21.61 20.0879C21.6103 20.3703 21.7235 20.6411 21.9248 20.8409C22.1262 21.0406 22.3992 21.1529 22.6839 21.1531Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M25.9006 21.3348C25.6102 21.3349 25.3215 21.2902 25.0449 21.2023L24.7473 21.1082V20.7984C24.7475 20.76 24.7501 20.7217 24.7556 20.6838C24.7654 20.6075 24.7695 20.5306 24.7677 20.4537C24.7677 20.4486 24.7677 20.3349 24.7763 20.1533C24.7765 19.5881 24.5557 19.0449 24.1605 18.6379C23.7652 18.2309 23.2261 17.9918 22.6568 17.971C22.097 17.9995 21.5677 18.2331 21.1715 18.6265C20.7754 19.02 20.5405 19.5453 20.5125 20.1006C20.5125 20.1269 20.5176 20.2033 20.5279 20.3256C20.5336 20.3914 20.5254 20.4577 20.5039 20.5203C20.4824 20.5828 20.448 20.6403 20.403 20.6889C20.3579 20.7376 20.3033 20.7764 20.2423 20.803C20.1814 20.8296 20.1153 20.8433 20.0487 20.8433H10.6006C10.5188 20.8431 10.4387 20.82 10.3696 20.7766C10.3004 20.7332 10.2448 20.6713 10.2095 20.5981V20.5896C10.1806 20.5252 10.1681 20.4547 10.173 20.3844C10.1779 20.3141 10.2003 20.2462 10.238 20.1864L10.243 20.1779C10.2549 20.1602 10.2607 20.1389 10.2593 20.1176V20.0854C10.2575 19.5269 10.0338 18.9915 9.63674 18.5955C9.23964 18.1996 8.70112 17.9748 8.13809 17.9701C7.57805 17.9993 7.0489 18.2334 6.65282 18.6272C6.25674 19.0211 6.02178 19.5468 5.99374 20.1024C5.99117 20.1953 5.99766 20.2881 6.01275 20.3799C6.02581 20.4593 6.01814 20.5407 5.99082 20.6165C5.96349 20.6923 5.91738 20.76 5.85649 20.8132C5.79561 20.8664 5.72202 20.9033 5.64279 20.9206C5.56356 20.9379 5.48117 20.935 5.40339 20.9121C4.99186 20.7922 4.62903 20.5465 4.36642 20.2101C4.04609 19.8474 3.87351 19.3792 3.88219 18.8971C3.8314 18.1795 3.90188 17.4585 4.09088 16.764L4.09777 16.7411C4.14534 16.5791 4.24179 16.4354 4.37415 16.3294C4.39253 16.3158 4.40862 16.2995 4.42198 16.281C4.5264 16.07 4.58632 15.84 4.59809 15.6051C4.60985 15.3703 4.5733 15.1356 4.4905 14.9153L4.46314 14.8432V14.7659C4.46314 14.3313 4.8833 14.2295 5.08524 14.1811C5.24532 14.1498 5.3996 14.0946 5.54294 14.0173C5.88467 13.8387 6.18226 13.5873 6.41426 13.281C6.64625 12.9747 6.80677 12.6211 6.88449 12.2458C6.87025 12.1776 6.87184 12.1071 6.88888 12.0395C6.90591 11.9719 6.93794 11.9089 6.98288 11.8554C7.03178 11.8006 7.09246 11.7574 7.16044 11.7291C7.22843 11.7007 7.30216 11.6879 7.37582 11.6916H7.45437C7.49287 11.6916 7.53993 11.6916 7.60582 11.6916C7.81369 11.6901 8.02138 11.6777 8.22792 11.6543C8.69168 11.605 8.98769 11.5617 9.39755 11.5023L9.66201 11.4641L9.80929 11.4429C10.9216 11.2842 11.4854 11.2044 11.9167 11.173C12.0262 11.1645 12.2067 11.1611 12.5156 11.1611C12.8519 11.1611 13.3216 11.161 13.9701 11.1704H14.06C14.8546 11.1379 15.6505 11.1711 16.4395 11.2697H16.4627C17.0548 11.3774 17.6338 11.5464 18.1903 11.7739L18.2144 11.7841C19.1623 12.2407 20.0571 12.7986 20.883 13.4477C20.9421 13.4851 21.0079 13.5327 21.0892 13.5904C21.2907 13.7388 21.5005 13.8759 21.7174 14.0011C21.9195 14.1134 22.1375 14.1948 22.3641 14.2422H22.3735C22.7398 14.3271 23.1076 14.4213 23.4627 14.5113C23.734 14.5801 24.0138 14.6505 24.2894 14.7176C25.096 14.8309 25.8699 15.1105 26.5611 15.5383L26.5816 15.5511L26.6004 15.5664C27.139 15.9895 27.5529 16.5486 27.7984 17.185C27.9824 17.6519 28.5137 19.2679 27.6487 20.4596C27.4327 20.7573 27.1481 20.9994 26.8187 21.1659L26.7878 21.1812L26.7554 21.1914C26.4797 21.2829 26.1913 21.3312 25.9006 21.3348ZM25.6251 20.4665C25.9052 20.5062 26.1908 20.485 26.4619 20.4045C26.6568 20.3002 26.8253 20.1534 26.9547 19.975C27.1505 19.5936 27.2566 19.173 27.2647 18.7449C27.2729 18.3169 27.1829 17.8927 27.0017 17.5042V17.4983C26.8142 17.0118 26.5001 16.5833 26.0913 16.2565C25.5008 15.8949 24.8408 15.6595 24.1534 15.5655L24.1114 15.557C23.8247 15.4874 23.5355 15.4144 23.2557 15.3439C22.9058 15.2591 22.543 15.164 22.1853 15.0791C21.875 15.0133 21.5765 14.9014 21.2998 14.7472C21.0554 14.6066 20.819 14.4525 20.592 14.2855C20.521 14.2346 20.4543 14.1871 20.421 14.1667L20.3969 14.1523L20.3748 14.1345C19.5961 13.5201 18.7521 12.992 17.8576 12.5598C17.3636 12.3588 16.8501 12.2089 16.3251 12.1125C15.5837 12.0204 14.8358 11.9898 14.0892 12.0209H13.9668C13.3191 12.015 12.8544 12.0115 12.5181 12.0115C12.3401 12.0115 12.0904 12.0116 11.9783 12.0209C11.5753 12.0498 11.025 12.1287 9.9246 12.2848L9.77754 12.3061L9.51495 12.3443C9.11108 12.4029 8.79277 12.4496 8.3119 12.4996C8.09114 12.5234 7.89332 12.537 7.71277 12.5404C7.44811 13.4743 6.82316 14.2672 5.97327 14.7472C5.7915 14.8509 5.59595 14.9286 5.39232 14.9781C5.5168 15.555 5.43828 16.1569 5.16984 16.6833L5.15104 16.7165C5.08998 16.8131 5.01327 16.8991 4.92418 16.9711L4.91394 16.9796L4.90809 16.9949C4.74502 17.6001 4.6854 18.2281 4.73178 18.8529V18.8742V18.8954C4.72256 19.1761 4.82236 19.4495 5.01066 19.6592L5.03218 19.6847C5.06951 19.7335 5.11054 19.7792 5.15522 19.8214C5.24793 19.0998 5.59405 18.4337 6.13266 17.9401C6.67127 17.4465 7.36804 17.1568 8.10049 17.1222H8.1218C8.89811 17.124 9.64346 17.4248 10.2006 17.9611C10.7577 18.4974 11.083 19.2274 11.108 19.9971H19.6645C19.7178 19.2402 20.05 18.529 20.5977 17.9993C21.1454 17.4696 21.8703 17.1583 22.6345 17.1247H22.6654C23.4641 17.1448 24.223 17.4753 24.7784 18.0451C25.3338 18.615 25.6412 19.3785 25.6345 20.1711V20.1881C25.6259 20.3519 25.6259 20.4546 25.6259 20.4563L25.6251 20.4665Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M22.5414 9L23.1754 9.04497L23.1215 9.68406L23.0933 9.74861C22.9302 10.1168 22.7097 10.4571 22.4396 10.757C21.9108 11.4207 21.3213 12.0446 20.7634 12.6243C20.1148 13.2932 19.6032 13.7889 19.1043 14.2311C18.708 14.5828 18.2781 14.8955 17.8209 15.1648C17.7356 15.2187 17.637 15.248 17.5359 15.2497C17.434 15.2484 17.3348 15.2162 17.252 15.1573C17.1692 15.0984 17.1068 15.0157 17.073 14.9204C16.9274 14.5747 16.6716 14.2858 16.3448 14.0979H16.3406C16.2719 14.0633 16.2123 14.0132 16.1666 13.9517C16.1209 13.8902 16.0904 13.8189 16.0774 13.7436C16.0644 13.6683 16.0693 13.5911 16.0918 13.5181C16.1143 13.445 16.1539 13.3781 16.2071 13.3229C16.6633 12.7929 17.18 12.3175 17.7471 11.9063C18.6635 11.2179 19.6219 10.5609 20.5965 9.95397C21.0201 9.683 21.4596 9.43731 21.9126 9.21811C22.0944 9.12811 22.287 9.06161 22.4858 9.02031L22.5414 9ZM17.6822 14.2464C17.9812 14.0502 18.2656 13.8326 18.5328 13.5954C19.0154 13.171 19.5123 12.6855 20.1455 12.0328C20.6846 11.476 21.2528 10.875 21.7567 10.2443C21.518 10.375 21.2846 10.5134 21.0561 10.6594H21.0517C20.0968 11.2535 19.1565 11.8986 18.2589 12.5734L18.2529 12.5777C17.8391 12.8777 17.4546 13.2156 17.1046 13.5869C17.3331 13.7727 17.5282 13.9957 17.6813 14.2464H17.6822Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M14.6608 17.0695C14.5238 17.0694 14.3872 17.0543 14.2535 17.0245C14.0821 16.9934 13.9291 16.8987 13.8257 16.7596L13.7358 16.6383L13.753 16.2937L13.8461 16.1842L13.8608 16.1655C13.8929 16.1242 13.9284 16.0856 13.9669 16.0501C14.2092 15.8155 14.3737 15.5132 14.4384 15.1835C14.4762 14.9885 14.527 14.7962 14.5907 14.6079C14.7137 14.2496 14.9736 13.9537 15.3145 13.7838C15.4887 13.6942 15.682 13.6473 15.8783 13.6471C16.0421 13.6469 16.2043 13.6795 16.355 13.743C16.6268 13.8456 16.8696 14.0116 17.0632 14.2268C17.2568 14.442 17.3953 14.7003 17.4672 14.9798C17.5353 15.2133 17.531 15.4617 17.4547 15.6927C17.3784 15.9238 17.2336 16.1267 17.0394 16.275C16.7003 16.5451 16.3115 16.7468 15.8946 16.8692C15.5304 16.9866 15.1514 17.0528 14.7686 17.066C14.7301 17.0686 14.6951 17.0695 14.6608 17.0695ZM15.88 14.4967C15.8204 14.4967 15.7617 14.511 15.7089 14.5384H15.703C15.5618 14.6079 15.4538 14.7298 15.4026 14.8778C15.3514 15.0297 15.3105 15.1849 15.2802 15.3422C15.2208 15.6474 15.1048 15.9389 14.9381 16.202C15.174 16.1791 15.4067 16.1307 15.632 16.0577H15.6431C15.9568 15.966 16.2492 15.814 16.5038 15.6104L16.515 15.6019C16.5737 15.5579 16.6174 15.4972 16.6404 15.4279C16.6633 15.3586 16.6643 15.284 16.6433 15.214L16.6381 15.1945C16.6007 15.0452 16.5274 14.9071 16.4244 14.7921C16.3214 14.6771 16.1919 14.5886 16.0469 14.5341L16.0281 14.5265C15.9815 14.5061 15.9309 14.4957 15.88 14.4959V14.4967Z",fill:"currentColor"}})])])]),e._v(" "),r("v-list-item-title",[r("p",{class:[e.$style.menutext1]},[e._v("Đổi màu xe")])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeDuoToneUp}},[r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none"}},[r("path",{attrs:{d:"M7.375 12H4.625C4.45924 12 4.30027 11.9473 4.18306 11.8536C4.06585 11.7598 4 11.6326 4 11.5C4 11.3674 4.06585 11.2402 4.18306 11.1464C4.30027 11.0527 4.45924 11 4.625 11H7.375C7.54076 11 7.69973 11.0527 7.81694 11.1464C7.93415 11.2402 8 11.3674 8 11.5C8 11.6326 7.93415 11.7598 7.81694 11.8536C7.69973 11.9473 7.54076 12 7.375 12Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M5.42308 14H3.57692C3.42391 14 3.27717 13.9473 3.16898 13.8536C3.06078 13.7598 3 13.6326 3 13.5C3 13.3674 3.06078 13.2402 3.16898 13.1464C3.27717 13.0527 3.42391 13 3.57692 13H5.42308C5.57609 13 5.72283 13.0527 5.83102 13.1464C5.93922 13.2402 6 13.3674 6 13.5C6 13.6326 5.93922 13.7598 5.83102 13.8536C5.72283 13.9473 5.57609 14 5.42308 14Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M4.46429 16H2.53571C2.39363 16 2.25737 15.9473 2.15691 15.8536C2.05644 15.7598 2 15.6326 2 15.5C2 15.3674 2.05644 15.2402 2.15691 15.1464C2.25737 15.0527 2.39363 15 2.53571 15H4.46429C4.60637 15 4.74263 15.0527 4.84309 15.1464C4.94356 15.2402 5 15.3674 5 15.5C5 15.6326 4.94356 15.7598 4.84309 15.8536C4.74263 15.9473 4.60637 16 4.46429 16Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M10.2518 18.0155C10.6334 18.0155 11.0064 18.1278 11.3237 18.3381C11.641 18.5484 11.8883 18.8473 12.0344 19.1971C12.1804 19.5468 12.2186 19.9317 12.1442 20.303C12.0697 20.6743 11.886 21.0153 11.6161 21.283C11.3463 21.5507 11.0025 21.733 10.6282 21.8068C10.2539 21.8807 9.86594 21.8428 9.51337 21.6979C9.16081 21.553 8.85946 21.3077 8.64744 20.9929C8.43543 20.6782 8.32227 20.3081 8.32227 19.9296C8.32294 19.4221 8.52645 18.9357 8.88815 18.5769C9.24986 18.2181 9.74024 18.0162 10.2518 18.0155ZM10.2518 20.9948C10.4641 20.9948 10.6718 20.9323 10.8484 20.8153C11.0249 20.6982 11.1626 20.5319 11.2439 20.3372C11.3251 20.1426 11.3464 19.9284 11.305 19.7217C11.2635 19.5151 11.1613 19.3253 11.0111 19.1763C10.8609 19.0273 10.6696 18.9259 10.4613 18.8848C10.253 18.8437 10.037 18.8648 9.84082 18.9454C9.6446 19.026 9.47689 19.1626 9.35889 19.3377C9.2409 19.5129 9.17792 19.7189 9.17792 19.9296C9.17814 20.212 9.29135 20.4828 9.49269 20.6825C9.69402 20.8823 9.96703 20.9946 10.2518 20.9948Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M24.8177 18.0155C25.1993 18.0155 25.5723 18.1278 25.8896 18.3381C26.207 18.5484 26.4543 18.8473 26.6003 19.1971C26.7463 19.5468 26.7845 19.9317 26.7101 20.303C26.6356 20.6743 26.4519 21.0153 26.182 21.283C25.9122 21.5507 25.5684 21.733 25.1941 21.8068C24.8198 21.8807 24.4319 21.8428 24.0793 21.6979C23.7267 21.553 23.4254 21.3077 23.2134 20.9929C23.0013 20.6782 22.8882 20.3081 22.8882 19.9296C22.8889 19.4221 23.0924 18.9357 23.4541 18.5769C23.8158 18.2181 24.3062 18.0162 24.8177 18.0155ZM24.8177 20.9948C25.0301 20.9948 25.2377 20.9323 25.4143 20.8153C25.5909 20.6982 25.7285 20.5319 25.8098 20.3372C25.8911 20.1426 25.9123 19.9284 25.8709 19.7217C25.8295 19.5151 25.7272 19.3253 25.577 19.1763C25.4268 19.0273 25.2355 18.9259 25.0272 18.8848C24.8189 18.8437 24.603 18.8648 24.4067 18.9454C24.2105 19.026 24.0428 19.1626 23.9248 19.3377C23.8068 19.5129 23.7438 19.7189 23.7438 19.9296C23.7441 20.212 23.8573 20.4828 24.0586 20.6825C24.2599 20.8823 24.5329 20.9946 24.8177 20.9948Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M28.0344 21.1764C27.744 21.1766 27.4553 21.1319 27.1787 21.044L26.8811 20.9498V20.64C26.8812 20.6017 26.8839 20.5634 26.8894 20.5254C26.8992 20.4492 26.9033 20.3723 26.9015 20.2954C26.9015 20.2903 26.9015 20.1766 26.9101 19.9949C26.9103 19.4298 26.6895 18.8866 26.2943 18.4796C25.899 18.0726 25.3599 17.8335 24.7906 17.8126C24.2308 17.8412 23.7015 18.0748 23.3053 18.4682C22.9092 18.8616 22.6743 19.3869 22.6462 19.9423C22.6462 19.9686 22.6514 20.045 22.6617 20.1672C22.6674 20.2331 22.6592 20.2994 22.6377 20.3619C22.6162 20.4245 22.5818 20.4819 22.5368 20.5306C22.4917 20.5793 22.4371 20.6181 22.3761 20.6447C22.3152 20.6713 22.2491 20.685 22.1825 20.685H12.7344C12.6525 20.6848 12.5725 20.6617 12.5033 20.6183C12.4342 20.5749 12.3786 20.513 12.3433 20.4397V20.4313C12.3144 20.3669 12.3018 20.2964 12.3068 20.2261C12.3117 20.1558 12.3341 20.0879 12.3717 20.0281L12.3768 20.0196C12.3887 20.0018 12.3945 19.9806 12.393 19.9593V19.9271C12.3913 19.3685 12.1676 18.8332 11.7705 18.4372C11.3734 18.0412 10.8349 17.8165 10.2719 17.8118C9.71184 17.8409 9.18269 18.0751 8.78661 18.4689C8.39053 18.8628 8.15556 19.3884 8.12753 19.9441C8.12496 20.037 8.13145 20.1298 8.14654 20.2215C8.1596 20.301 8.15193 20.3824 8.12461 20.4582C8.09728 20.534 8.05117 20.6017 7.99028 20.6549C7.9294 20.708 7.85581 20.745 7.77658 20.7623C7.69735 20.7796 7.61496 20.7767 7.53718 20.7538C7.12565 20.6339 6.76282 20.3882 6.5002 20.0518C6.17988 19.689 6.0073 19.2209 6.01598 18.7387C5.96519 18.0211 6.03567 17.3001 6.22467 16.6056L6.23156 16.5827C6.27913 16.4207 6.37558 16.2771 6.50793 16.1711C6.52632 16.1575 6.54241 16.1412 6.55577 16.1227C6.66019 15.9116 6.7201 15.6816 6.73187 15.4468C6.74364 15.212 6.70709 14.9773 6.62429 14.757L6.59693 14.6848V14.6076C6.59693 14.173 7.01709 14.0711 7.21903 14.0228C7.37911 13.9915 7.53339 13.9363 7.67673 13.8589C8.01846 13.6804 8.31605 13.429 8.54805 13.1227C8.78004 12.8164 8.94056 12.4628 9.01828 12.0875C9.00403 12.0192 9.00563 11.9488 9.02266 11.8812C9.0397 11.8136 9.07173 11.7506 9.11667 11.697C9.16557 11.6423 9.22625 11.5991 9.29423 11.5707C9.36222 11.5424 9.43595 11.5296 9.50961 11.5332H9.58816C9.62666 11.5332 9.67372 11.5332 9.73961 11.5332C9.94748 11.5317 10.1552 11.5193 10.3617 11.4959C10.8255 11.4467 11.1215 11.4033 11.5313 11.3439L11.7958 11.3058L11.9431 11.2846C13.0554 11.1258 13.6192 11.0461 14.0505 11.0146C14.16 11.0062 14.3405 11.0027 14.6494 11.0027C14.9856 11.0027 15.4554 11.0027 16.1039 11.0121H16.1938C16.9884 10.9795 17.7843 11.0128 18.5733 11.1114H18.5965C19.1886 11.2191 19.7676 11.388 20.3241 11.6156L20.3481 11.6258C21.2961 12.0824 22.1909 12.6402 23.0168 13.2894C23.0759 13.3267 23.1417 13.3743 23.223 13.4321C23.4245 13.5805 23.6343 13.7175 23.8512 13.8428C24.0533 13.9551 24.2713 14.0364 24.4979 14.0839H24.5073C24.8735 14.1688 25.2414 14.263 25.5965 14.353C25.8678 14.4217 26.1476 14.4922 26.4231 14.5593C27.2298 14.6726 28.0037 14.9521 28.6949 15.38L28.7154 15.3927L28.7342 15.4081C29.2727 15.8312 29.6866 16.3903 29.9322 17.0267C30.1162 17.4936 30.6475 19.1096 29.7825 20.3013C29.5665 20.599 29.2819 20.8411 28.9525 21.0076L28.9216 21.0229L28.8892 21.033C28.6135 21.1246 28.3251 21.1729 28.0344 21.1764ZM27.7588 20.3082C28.039 20.3478 28.3246 20.3267 28.5957 20.2462C28.7906 20.1419 28.9591 19.995 29.0885 19.8167C29.2843 19.4353 29.3903 19.0146 29.3985 18.5866C29.4067 18.1586 29.3167 17.7344 29.1355 17.3458V17.3399C28.948 16.8535 28.6339 16.425 28.2251 16.0981C27.6346 15.7365 26.9746 15.5011 26.2872 15.4071L26.2452 15.3986C25.9585 15.329 25.6693 15.2561 25.3895 15.1856C25.0396 15.1007 24.6768 15.0057 24.3191 14.9208C24.0088 14.855 23.7103 14.7431 23.4336 14.5889C23.1892 14.4483 22.9528 14.2942 22.7258 14.1272C22.6548 14.0763 22.5881 14.0287 22.5547 14.0084L22.5307 13.994L22.5086 13.9761C21.7299 13.3618 20.8858 12.8337 19.9913 12.4015C19.4974 12.2004 18.9839 12.0506 18.4589 11.9542C17.7174 11.8621 16.9696 11.8315 16.223 11.8626H16.1006C15.4529 11.8567 14.9881 11.8532 14.6519 11.8532C14.4739 11.8532 14.2242 11.8533 14.1121 11.8626C13.7091 11.8915 13.1588 11.9703 12.0584 12.1265L11.9113 12.1478L11.6487 12.186C11.2449 12.2446 10.9266 12.2912 10.4457 12.3413C10.2249 12.3651 10.0271 12.3786 9.84656 12.382C9.5819 13.316 8.95695 14.1089 8.10706 14.5889C7.92529 14.6926 7.72974 14.7702 7.52611 14.8198C7.65059 15.3967 7.57207 15.9985 7.30363 16.525L7.28483 16.5582C7.22377 16.6548 7.14706 16.7407 7.05797 16.8128L7.04773 16.8213L7.04188 16.8366C6.87881 17.4418 6.81919 18.0698 6.86557 18.6946V18.7158V18.7371C6.85635 19.0178 6.95615 19.2912 7.14445 19.5009L7.16597 19.5264C7.2033 19.5751 7.24433 19.6208 7.28901 19.6631C7.38172 18.9415 7.72784 18.2754 8.26645 17.7818C8.80506 17.2881 9.50183 16.9985 10.2343 16.9638H10.2556C11.0319 16.9656 11.7772 17.2665 12.3343 17.8028C12.8914 18.3391 13.2167 19.0691 13.2418 19.8388H21.7983C21.8516 19.0818 22.1838 18.3707 22.7315 17.841C23.2792 17.3113 24.0041 17 24.7682 16.9664H24.7992C25.5979 16.9864 26.3568 17.317 26.9122 17.8868C27.4676 18.4567 27.775 19.2202 27.7682 20.0128V20.0298C27.7597 20.1936 27.7597 20.2963 27.7597 20.298L27.7588 20.3082Z",fill:"currentColor"}})])])]),e._v(" "),r("v-list-item-title",[r("p",{class:[e.$style.menutext2]},[e._v("Dán Duo-Tone trên")])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeDuoToneDown}},[r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none"}},[r("path",{attrs:{d:"M7.375 12H4.625C4.45924 12 4.30027 11.9473 4.18306 11.8536C4.06585 11.7598 4 11.6326 4 11.5C4 11.3674 4.06585 11.2402 4.18306 11.1464C4.30027 11.0527 4.45924 11 4.625 11H7.375C7.54076 11 7.69973 11.0527 7.81694 11.1464C7.93415 11.2402 8 11.3674 8 11.5C8 11.6326 7.93415 11.7598 7.81694 11.8536C7.69973 11.9473 7.54076 12 7.375 12Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M5.42308 14H3.57692C3.42391 14 3.27717 13.9473 3.16898 13.8536C3.06078 13.7598 3 13.6326 3 13.5C3 13.3674 3.06078 13.2402 3.16898 13.1464C3.27717 13.0527 3.42391 13 3.57692 13H5.42308C5.57609 13 5.72283 13.0527 5.83102 13.1464C5.93922 13.2402 6 13.3674 6 13.5C6 13.6326 5.93922 13.7598 5.83102 13.8536C5.72283 13.9473 5.57609 14 5.42308 14Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M4.46429 16H2.53571C2.39363 16 2.25737 15.9473 2.15691 15.8536C2.05644 15.7598 2 15.6326 2 15.5C2 15.3674 2.05644 15.2402 2.15691 15.1464C2.25737 15.0527 2.39363 15 2.53571 15H4.46429C4.60637 15 4.74263 15.0527 4.84309 15.1464C4.94356 15.2402 5 15.3674 5 15.5C5 15.6326 4.94356 15.7598 4.84309 15.8536C4.74263 15.9473 4.60637 16 4.46429 16Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M10.2518 18.0155C10.6334 18.0155 11.0064 18.1278 11.3237 18.3381C11.641 18.5484 11.8883 18.8473 12.0344 19.1971C12.1804 19.5468 12.2186 19.9317 12.1442 20.303C12.0697 20.6743 11.886 21.0153 11.6161 21.283C11.3463 21.5507 11.0025 21.733 10.6282 21.8068C10.2539 21.8807 9.86594 21.8428 9.51337 21.6979C9.16081 21.553 8.85946 21.3077 8.64744 20.9929C8.43543 20.6782 8.32227 20.3081 8.32227 19.9296C8.32294 19.4221 8.52645 18.9357 8.88815 18.5769C9.24986 18.2181 9.74024 18.0162 10.2518 18.0155ZM10.2518 20.9948C10.4641 20.9948 10.6718 20.9323 10.8484 20.8153C11.0249 20.6982 11.1626 20.5319 11.2439 20.3372C11.3251 20.1426 11.3464 19.9284 11.305 19.7217C11.2635 19.5151 11.1613 19.3253 11.0111 19.1763C10.8609 19.0273 10.6696 18.9259 10.4613 18.8848C10.253 18.8437 10.037 18.8648 9.84082 18.9454C9.6446 19.026 9.47689 19.1626 9.35889 19.3377C9.2409 19.5129 9.17792 19.7189 9.17792 19.9296C9.17814 20.212 9.29135 20.4828 9.49269 20.6825C9.69402 20.8823 9.96703 20.9946 10.2518 20.9948Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M24.8177 18.0155C25.1993 18.0155 25.5723 18.1278 25.8896 18.3381C26.207 18.5484 26.4543 18.8473 26.6003 19.1971C26.7463 19.5468 26.7845 19.9317 26.7101 20.303C26.6356 20.6743 26.4519 21.0153 26.182 21.283C25.9122 21.5507 25.5684 21.733 25.1941 21.8068C24.8198 21.8807 24.4319 21.8428 24.0793 21.6979C23.7267 21.553 23.4254 21.3077 23.2134 20.9929C23.0013 20.6782 22.8882 20.3081 22.8882 19.9296C22.8889 19.4221 23.0924 18.9357 23.4541 18.5769C23.8158 18.2181 24.3062 18.0162 24.8177 18.0155ZM24.8177 20.9948C25.0301 20.9948 25.2377 20.9323 25.4143 20.8153C25.5909 20.6982 25.7285 20.5319 25.8098 20.3372C25.8911 20.1426 25.9123 19.9284 25.8709 19.7217C25.8295 19.5151 25.7272 19.3253 25.577 19.1763C25.4268 19.0273 25.2355 18.9259 25.0272 18.8848C24.8189 18.8437 24.603 18.8648 24.4067 18.9454C24.2105 19.026 24.0428 19.1626 23.9248 19.3377C23.8068 19.5129 23.7438 19.7189 23.7438 19.9296C23.7441 20.212 23.8573 20.4828 24.0586 20.6825C24.2599 20.8823 24.5329 20.9946 24.8177 20.9948Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M28.0344 21.1764C27.744 21.1766 27.4553 21.1319 27.1787 21.044L26.8811 20.9498V20.64C26.8812 20.6017 26.8839 20.5634 26.8894 20.5254C26.8992 20.4492 26.9033 20.3723 26.9015 20.2954C26.9015 20.2903 26.9015 20.1766 26.9101 19.9949C26.9103 19.4298 26.6895 18.8866 26.2943 18.4796C25.899 18.0726 25.3599 17.8335 24.7906 17.8126C24.2308 17.8412 23.7015 18.0748 23.3053 18.4682C22.9092 18.8616 22.6743 19.3869 22.6462 19.9423C22.6462 19.9686 22.6514 20.045 22.6617 20.1672C22.6674 20.2331 22.6592 20.2994 22.6377 20.3619C22.6162 20.4245 22.5818 20.4819 22.5368 20.5306C22.4917 20.5793 22.4371 20.6181 22.3761 20.6447C22.3152 20.6713 22.2491 20.685 22.1825 20.685H12.7344C12.6525 20.6848 12.5725 20.6617 12.5033 20.6183C12.4342 20.5749 12.3786 20.513 12.3433 20.4397V20.4313C12.3144 20.3669 12.3018 20.2964 12.3068 20.2261C12.3117 20.1558 12.3341 20.0879 12.3717 20.0281L12.3768 20.0196C12.3887 20.0018 12.3945 19.9806 12.393 19.9593V19.9271C12.3913 19.3685 12.1676 18.8332 11.7705 18.4372C11.3734 18.0412 10.8349 17.8165 10.2719 17.8118C9.71184 17.8409 9.18269 18.0751 8.78661 18.4689C8.39053 18.8628 8.15556 19.3884 8.12753 19.9441C8.12496 20.037 8.13145 20.1298 8.14654 20.2215C8.1596 20.301 8.15193 20.3824 8.12461 20.4582C8.09728 20.534 8.05117 20.6017 7.99028 20.6549C7.9294 20.708 7.85581 20.745 7.77658 20.7623C7.69735 20.7796 7.61496 20.7767 7.53718 20.7538C7.12565 20.6339 6.76282 20.3882 6.5002 20.0518C6.17988 19.689 6.0073 19.2209 6.01598 18.7387C5.96519 18.0211 6.03567 17.3001 6.22467 16.6056L6.23156 16.5827C6.27913 16.4207 6.37558 16.2771 6.50793 16.1711C6.52632 16.1575 6.54241 16.1412 6.55577 16.1227C6.66019 15.9116 6.7201 15.6816 6.73187 15.4468C6.74364 15.212 6.70709 14.9773 6.62429 14.757L6.59693 14.6848V14.6076C6.59693 14.173 7.01709 14.0711 7.21903 14.0228C7.37911 13.9915 7.53339 13.9363 7.67673 13.8589C8.01846 13.6804 8.31605 13.429 8.54805 13.1227C8.78004 12.8164 8.94056 12.4628 9.01828 12.0875C9.00403 12.0192 9.00563 11.9488 9.02266 11.8812C9.0397 11.8136 9.07173 11.7506 9.11667 11.697C9.16557 11.6423 9.22625 11.5991 9.29423 11.5707C9.36222 11.5424 9.43595 11.5296 9.50961 11.5332H9.58816C9.62666 11.5332 9.67372 11.5332 9.73961 11.5332C9.94748 11.5317 10.1552 11.5193 10.3617 11.4959C10.8255 11.4467 11.1215 11.4033 11.5313 11.3439L11.7958 11.3058L11.9431 11.2846C13.0554 11.1258 13.6192 11.0461 14.0505 11.0146C14.16 11.0062 14.3405 11.0027 14.6494 11.0027C14.9856 11.0027 15.4554 11.0027 16.1039 11.0121H16.1938C16.9884 10.9795 17.7843 11.0128 18.5733 11.1114H18.5965C19.1886 11.2191 19.7676 11.388 20.3241 11.6156L20.3481 11.6258C21.2961 12.0824 22.1909 12.6402 23.0168 13.2894C23.0759 13.3267 23.1417 13.3743 23.223 13.4321C23.4245 13.5805 23.6343 13.7175 23.8512 13.8428C24.0533 13.9551 24.2713 14.0364 24.4979 14.0839H24.5073C24.8735 14.1688 25.2414 14.263 25.5965 14.353C25.8678 14.4217 26.1476 14.4922 26.4231 14.5593C27.2298 14.6726 28.0037 14.9521 28.6949 15.38L28.7154 15.3927L28.7342 15.4081C29.2727 15.8312 29.6866 16.3903 29.9322 17.0267C30.1162 17.4936 30.6475 19.1096 29.7825 20.3013C29.5665 20.599 29.2819 20.8411 28.9525 21.0076L28.9216 21.0229L28.8892 21.033C28.6135 21.1246 28.3251 21.1729 28.0344 21.1764ZM27.7588 20.3082C28.039 20.3478 28.3246 20.3267 28.5957 20.2462C28.7906 20.1419 28.9591 19.995 29.0885 19.8167C29.2843 19.4353 29.3903 19.0146 29.3985 18.5866C29.4067 18.1586 29.3167 17.7344 29.1355 17.3458V17.3399C28.948 16.8535 28.6339 16.425 28.2251 16.0981C27.6346 15.7365 26.9746 15.5011 26.2872 15.4071L26.2452 15.3986C25.9585 15.329 25.6693 15.2561 25.3895 15.1856C25.0396 15.1007 24.6768 15.0057 24.3191 14.9208C24.0088 14.855 23.7103 14.7431 23.4336 14.5889C23.1892 14.4483 22.9528 14.2942 22.7258 14.1272C22.6548 14.0763 22.5881 14.0287 22.5547 14.0084L22.5307 13.994L22.5086 13.9761C21.7299 13.3618 20.8858 12.8337 19.9913 12.4015C19.4974 12.2004 18.9839 12.0506 18.4589 11.9542C17.7174 11.8621 16.9696 11.8315 16.223 11.8626H16.1006C15.4529 11.8567 14.9881 11.8532 14.6519 11.8532C14.4739 11.8532 14.2242 11.8533 14.1121 11.8626C13.7091 11.8915 13.1588 11.9703 12.0584 12.1265L11.9113 12.1478L11.6487 12.186C11.2449 12.2446 10.9266 12.2912 10.4457 12.3413C10.2249 12.3651 10.0271 12.3786 9.84656 12.382C9.5819 13.316 8.95695 14.1089 8.10706 14.5889C7.92529 14.6926 7.72974 14.7702 7.52611 14.8198C7.65059 15.3967 7.57207 15.9985 7.30363 16.525L7.28483 16.5582C7.22377 16.6548 7.14706 16.7407 7.05797 16.8128L7.04773 16.8213L7.04188 16.8366C6.87881 17.4418 6.81919 18.0698 6.86557 18.6946V18.7158V18.7371C6.85635 19.0178 6.95615 19.2912 7.14445 19.5009L7.16597 19.5264C7.2033 19.5751 7.24433 19.6208 7.28901 19.6631C7.38172 18.9415 7.72784 18.2754 8.26645 17.7818C8.80506 17.2881 9.50183 16.9985 10.2343 16.9638H10.2556C11.0319 16.9656 11.7772 17.2665 12.3343 17.8028C12.8914 18.3391 13.2167 19.0691 13.2418 19.8388H21.7983C21.8516 19.0818 22.1838 18.3707 22.7315 17.841C23.2792 17.3113 24.0041 17 24.7682 16.9664H24.7992C25.5979 16.9864 26.3568 17.317 26.9122 17.8868C27.4676 18.4567 27.775 19.2202 27.7682 20.0128V20.0298C27.7597 20.1936 27.7597 20.2963 27.7597 20.298L27.7588 20.3082Z",fill:"currentColor"}})])])]),e._v(" "),r("v-list-item-title",[r("p",{class:[e.$style.menutext3]},[e._v("Dán Duo-Tone dưới")])])],1),e._v(" "),r("v-list-group",{attrs:{value:!1},scopedSlots:e._u([{key:"activator",fn:function(){return[r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],attrs:{src:n(358)}})])]),e._v(" "),r("v-list-item-title",[r("p",{class:[e.$style.menutext]},[e._v("Dán nóc")])])]},proxy:!0}])},[e._v(" "),r("v-list-item",{on:{click:e.changenocUp}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext4]},[e._v("Dán nóc trên")])]),e._v(" "),r("v-list-item-icon",[r("v-icon",{attrs:{dark:""}},[e._v("mdi-plus-outline")])],1)],1),e._v(" "),r("v-list-item",{on:{click:e.changenocVai}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext5]},[e._v("Dán nóc vai")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("svg",{attrs:{width:"28",height:"28",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M15.6603 4.08013C15.7189 4.05064 15.8376 3.99718 15.9849 4.00012L15.9747 4.50574L15.9827 4.00008L15.9849 4.00012C16.129 4.00291 16.2442 4.05874 16.3002 4.08853C16.3691 4.12522 16.4351 4.1709 16.4946 4.2164C16.6144 4.30811 16.7504 4.43216 16.8957 4.57654C17.1884 4.86757 17.5562 5.27887 17.9689 5.77712C18.7958 6.7756 19.8252 8.15057 20.8286 9.67402C21.8314 11.1965 22.8154 12.8782 23.5456 14.4889C24.2683 16.083 24.769 17.664 24.7494 18.9711C24.7494 18.9689 24.7494 18.9667 24.7494 18.9645L24.242 18.9696L24.7493 18.9778C24.7494 18.9756 24.7494 18.9733 24.7494 18.9711C24.7603 20.1438 24.5398 21.3073 24.1003 22.3952C23.66 23.4852 23.0087 24.4781 22.1834 25.3171C21.3581 26.1562 20.375 26.8249 19.2904 27.2852C18.2057 27.7455 17.0408 27.9884 15.862 27.9999L15.8481 28L15.8342 27.9994C13.4559 27.8928 11.2171 26.8501 9.60925 25.1C8.00287 23.3514 7.15744 21.0396 7.25805 18.671C7.25801 18.6732 7.25797 18.6753 7.25793 18.6775L7.76524 18.6864L7.25833 18.6646C7.25823 18.6668 7.25814 18.6689 7.25805 18.671C7.28259 17.3698 7.79743 15.81 8.52272 14.2397C9.2549 12.6545 10.2262 11.007 11.2117 9.51884C12.1977 8.02997 13.2048 6.69025 14.0139 5.71977C14.4176 5.23562 14.778 4.83615 15.0658 4.55416C15.2086 4.41435 15.3433 4.29364 15.4632 4.2046C15.5227 4.16041 15.5896 4.11567 15.6603 4.08013ZM9.4445 14.6627C8.73482 16.1992 8.29172 17.6066 8.27255 18.6953L8.27232 18.7081C8.18148 20.8113 8.93136 22.8644 10.3577 24.4169C11.7808 25.966 13.7613 26.8904 15.8659 26.9883C16.9067 26.9764 17.9351 26.7611 18.8929 26.3546C19.8549 25.9464 20.7268 25.3532 21.4588 24.609C22.1907 23.8648 22.7685 22.9842 23.159 22.0175C23.5495 21.0507 23.7451 20.0168 23.7347 18.9747L23.7345 18.9613C23.7522 17.8827 23.3286 16.4663 22.6209 14.9054C21.9195 13.3583 20.9652 11.7244 19.9803 10.2291C18.996 8.73474 17.9884 7.38959 17.1863 6.421C16.7844 5.93571 16.4397 5.55175 16.1791 5.2927C16.0978 5.21189 16.0282 5.14676 15.9703 5.09614C15.9164 5.14276 15.852 5.20219 15.7771 5.27556C15.5232 5.52429 15.1871 5.89522 14.7944 6.36623C14.0108 7.30608 13.0257 8.61575 12.0586 10.076C11.0911 11.5371 10.1485 13.1385 9.4445 14.6627ZM11.1607 18.6138C11.1607 18.6138 11.1632 18.6155 11.1682 18.6206C11.1632 18.6167 11.1607 18.6138 11.1607 18.6138ZM11.4445 19.074C11.5018 19.1838 11.566 19.311 11.6393 19.4562C11.6523 19.4819 11.6656 19.5082 11.6792 19.5351C12.0902 20.3483 12.7119 21.5535 13.717 22.2553C14.5415 22.831 15.4818 23.1748 16.1754 23.4284C16.2813 23.4671 16.3814 23.5037 16.4745 23.5387C16.729 23.6344 16.9058 23.7093 17.0223 23.7707C16.9435 23.8241 16.8234 23.8835 16.6487 23.9354C16.3622 24.0206 15.9867 24.0674 15.5595 24.0554C14.702 24.0313 13.7143 23.7733 12.9254 23.2247C12.1967 22.718 11.7313 21.7355 11.5272 20.7109C11.4271 20.209 11.396 19.7254 11.4197 19.3304C11.4254 19.2359 11.434 19.1506 11.4445 19.074ZM17.6338 22.9556C17.4008 22.811 17.1064 22.6953 16.8327 22.5923C16.7283 22.5531 16.6205 22.5135 16.5102 22.473C15.8101 22.2158 15.0062 21.9206 14.2992 21.4269C13.5356 20.8937 13.0142 19.9283 12.5854 19.08C12.5654 19.0404 12.5453 19.0004 12.5251 18.9603C12.3494 18.611 12.1701 18.2546 11.9968 18.0323C11.9118 17.9231 11.7328 17.7149 11.4517 17.6725C11.0936 17.6184 10.8604 17.8532 10.7493 18.0136C10.5288 18.3318 10.4347 18.8051 10.4068 19.2699C10.3774 19.7588 10.4165 20.3292 10.5318 20.908C10.7584 22.0449 11.3048 23.3311 12.3448 24.0543C13.3246 24.7356 14.5136 25.0379 15.5309 25.0665C16.0411 25.0808 16.5276 25.0269 16.9387 24.9047C17.0568 24.8696 17.1747 24.8271 17.2882 24.7758L17.4046 24.7349L17.9678 24.2545C18.0849 24.0872 18.176 23.8656 18.1336 23.6112C18.0924 23.3647 17.9424 23.1923 17.8095 23.0811C17.801 23.074 17.7923 23.0669 17.7834 23.0599L17.6338 22.9882V22.9556Z",fill:"currentColor"}}),e._v(" "),r("path",{attrs:{d:"M17.1438 23.733C16.5908 24.525 14.0438 24.633 12.3008 23.417C10.5578 22.201 10.3068 18.931 10.8538 18.139C11.4008 17.347 11.9108 20.418 13.6538 21.639C15.3968 22.86 17.6998 22.941 17.1438 23.733Z",fill:"currentColor"}})])])])],1)],1),e._v(" "),r("v-list-group",{attrs:{value:!1},scopedSlots:e._u([{key:"activator",fn:function(){return[r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("svg",{attrs:{width:"32",height:"32",viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[r("path",{attrs:{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M18.0343 7.89307C16.9733 7.89307 16.1133 8.75313 16.1133 9.81407C16.1133 10.875 16.9733 11.7351 18.0343 11.7351C19.0952 11.7351 19.9553 10.875 19.9553 9.81407C19.9553 8.75313 19.0952 7.89307 18.0343 7.89307ZM15.1133 9.81407C15.1133 8.20084 16.4211 6.89307 18.0343 6.89307C19.6475 6.89307 20.9553 8.20084 20.9553 9.81407C20.9553 11.4273 19.6475 12.7351 18.0343 12.7351C16.4211 12.7351 15.1133 11.4273 15.1133 9.81407ZM13.2607 17.7921C13.4998 17.654 13.8057 17.7358 13.9438 17.975L17.843 24.7251L24.488 24.732C24.5091 24.732 24.53 24.7264 24.5483 24.716C24.5666 24.7054 24.5819 24.6903 24.5925 24.6721C24.6032 24.6538 24.6089 24.6331 24.6091 24.6119C24.6092 24.5908 24.6038 24.57 24.5935 24.5516L19.7847 16.0388L18.3875 18.4701C18.3234 18.5817 18.2227 18.6593 18.1093 18.6963C17.8865 18.7757 17.6318 18.6874 17.5092 18.4753L14.4943 13.2618L8.02716 24.534C8.01678 24.5523 8.01119 24.5733 8.01123 24.5943C8.01128 24.6154 8.01686 24.6362 8.02742 24.6545C8.03799 24.6728 8.05317 24.688 8.07144 24.6987C8.08952 24.7092 8.11002 24.7148 8.13094 24.715L16.6874 24.7239L13.0779 18.4752C12.9397 18.236 13.0216 17.9302 13.2607 17.7921ZM14.4935 12.0199C14.3611 12.0199 14.2309 12.0545 14.116 12.1204C14.0011 12.1863 13.9054 12.2811 13.8385 12.3954L7.15883 24.038C7.0617 24.2081 7.01081 24.4006 7.01123 24.5965C7.01166 24.7923 7.06338 24.9846 7.16125 25.1542C7.25912 25.3239 7.39973 25.4649 7.56907 25.5633C7.73841 25.6617 7.93056 25.714 8.12639 25.715L8.12848 25.715L24.4879 25.732C24.6838 25.732 24.8762 25.6808 25.046 25.5833C25.2158 25.4858 25.3572 25.3456 25.456 25.1765C25.5548 25.0074 25.6075 24.8154 25.609 24.6196C25.6105 24.4238 25.5605 24.2307 25.4643 24.0601L20.4465 15.1772L20.4457 15.1758C20.3801 15.059 20.2847 14.9617 20.1691 14.8938C20.0531 14.8258 19.921 14.7899 19.7865 14.7899C19.652 14.7899 19.5199 14.8258 19.4039 14.8938C19.289 14.9613 19.1939 15.0579 19.1284 15.1738L17.9455 17.2323L15.1498 12.3977L15.1485 12.3954C15.0815 12.2811 14.9859 12.1863 14.871 12.1204C14.7561 12.0545 14.6259 12.0199 14.4935 12.0199Z",fill:"currentColor"}})])])]),e._v(" "),r("v-list-item-title",[r("p",{class:[e.$style.menutext]},[e._v("Dán điểm")])])]},proxy:!0}])},[e._v(" "),r("v-list-item",{on:{click:e.changeVienKinh}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext6]},[e._v("Nẹp viền cửa kính")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(359)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeCalant}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext7]},[e._v("Mặt Calant")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(360)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeGuong}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext8]},[e._v("Gương xe")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(361)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeNamCua}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext9]},[e._v("Tay nắm cửa")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(362)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeLogo}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext10]},[e._v("Logo")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(363)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeViencop}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext11]},[e._v("Viền cốp")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(364)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeLazang}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext12]},[e._v("Lazang")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(365)}})])])],1),e._v(" "),r("v-list-item",{on:{click:e.changeAllDiem}},[r("v-list-item-title",[r("p",{class:[e.$style.menutext13]},[e._v("Tất cả điểm")])]),e._v(" "),r("v-list-item-icon",[r("div",{staticStyle:{color:"#fff"}},[r("img",{class:[e.$style.menuimg],staticStyle:{width:"24px",height:"24px"},attrs:{src:n(366)}})])])],1)],1)],1)],1),e._v(" "),r("div",{class:[e.$style.menucolor]},[r("div",{class:[e.$style.divider]}),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:1==e.page,expression:"page == 1"}],class:[e.$style.menuflex]},[r("div",{class:[e.$style.colorselect0],on:{click:function(t){return e.changeColor(0)}}}),e._v(" "),r("div",{class:[e.$style.colorselect1],on:{click:function(t){return e.changeColor(1)}}}),e._v(" "),r("div",{class:[e.$style.colorselect2],on:{click:function(t){return e.changeColor(2)}}}),e._v(" "),r("div",{class:[e.$style.colorselect3],on:{click:function(t){return e.changeColor(3)}}}),e._v(" "),r("v-icon",{attrs:{dark:""},on:{click:function(t){return e.changePage(1)}}},[e._v("mdi-chevron-right")])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:2==e.page,expression:"page == 2"}],class:[e.$style.menuflex]},[r("v-icon",{attrs:{dark:""},on:{click:function(t){return e.changePage(0)}}},[e._v("mdi-chevron-left")]),e._v(" "),r("div",{class:[e.$style.colorselect4],on:{click:function(t){return e.changeColor(4)}}}),e._v(" "),r("div",{class:[e.$style.colorselect5],on:{click:function(t){return e.changeColor(5)}}}),e._v(" "),r("div",{class:[e.$style.colorselect6],on:{click:function(t){return e.changeColor(6)}}}),e._v(" "),r("v-icon",{attrs:{dark:""},on:{click:function(t){return e.changePage(1)}}},[e._v("mdi-chevron-right")])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:3==e.page,expression:"page == 3"}],class:[e.$style.menuflex]},[r("v-icon",{attrs:{dark:""},on:{click:function(t){return e.changePage(0)}}},[e._v("mdi-chevron-left")]),e._v(" "),r("div",{class:[e.$style.colorselect7],on:{click:function(t){return e.changeColor(7)}}}),e._v(" "),r("div",{class:[e.$style.colorselect8],on:{click:function(t){return e.changeColor(8)}}}),e._v(" "),r("div",{class:[e.$style.colorselect9],on:{click:function(t){return e.changeColor(9)}}}),e._v(" "),r("v-icon",{attrs:{dark:""},on:{click:function(t){return e.changePage(1)}}},[e._v("mdi-chevron-right")])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:4==e.page,expression:"page == 4"}],class:[e.$style.menuflex]},[r("v-icon",{attrs:{dark:""},on:{click:function(t){return e.changePage(0)}}},[e._v("mdi-chevron-left")]),e._v(" "),r("div",{class:[e.$style.colorselect10],on:{click:function(t){return e.changeColor(10)}}}),e._v(" "),r("div",{class:[e.$style.colorselect11],on:{click:function(t){return e.changeColor(11)}}}),e._v(" "),r("div",{class:[e.$style.colorselect12],on:{click:function(t){return e.changeColor(12)}}}),e._v(" "),r("div",{class:[e.$style.colorselect13],on:{click:function(t){return e.changeColor(13)}}})],1),e._v(" "),r("div",{class:[e.$style.divider]}),e._v(" "),r("div",{class:[e.$style.colorname]},[e._v(e._s(e.dsnamecolor))])])])}),[],!1,(function(e){this.$style=o.default.locals||o.default}),null,null);t.default=component.exports;h()(component,{VIcon:d.a,VList:f.a,VListGroup:m.a,VListItem:v.a,VListItemIcon:y.a,VListItemTitle:x.a})},452:function(e,t,n){var content=n(512);content.__esModule&&(content=content.default),"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,n(107).default)("1b7833da",content,!0,{sourceMap:!1})},453:function(e,t,n){"use strict";n.r(t);var r={},o=n(380),l=n(72);var component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.loading]},[n("div",{staticStyle:{"margin-bottom":"50px"}},[n("img",{class:[e.$style.img],attrs:{src:"/loading.png"}}),e._v(" "),n("div",{class:[e.$style.progress]},[n("div",{class:[e.$style.progressvalue]})])]),e._v(" "),n("div",{class:[e.$style.text]},[n("a",{attrs:{href:"https://www.facebook.com/trannhatminhgtnd/",target:"_blank",rel:"noopener noreferrer"}},[e._v("CAR")])])])}),[],!1,(function(e){this.$style=o.default.locals||o.default}),null,null);t.default=component.exports},454:function(e,t,n){"use strict";n.r(t);var r={},o=n(382),l=n(72);var component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("div",{class:[e.$style.tutorial]},[n("strong",[e._v(" Click ")]),e._v("để xoay. "),n("strong",[e._v(" Cuộn ")]),e._v("để thu phóng.")])])}),[],!1,(function(e){this.$style=o.default.locals||o.default}),null,null);t.default=component.exports},455:function(e,t,n){"use strict";n.r(t);var r={data:function(){return{fab:!1,snackbar:!1,text:"Đã sao chép",timeout:2e3}},methods:{copyLink:function(){navigator.clipboard.writeText(window.location.href),this.snackbar=!0},openMenu:function(){this.$emit("openMenu")}}},o=n(384),l=n(72),c=n(344),h=n.n(c),d=n(392),f=n(348),m=n(540),v=n(545);var component=Object(l.a)(r,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.position]},[n("v-speed-dial",{attrs:{direction:"top","open-on-hover":!0,transition:"slide-y-reverse-transition"},scopedSlots:e._u([{key:"activator",fn:function(){return[n("v-btn",{attrs:{color:"#039BE5",dark:"",fab:""},model:{value:e.fab,callback:function(t){e.fab=t},expression:"fab"}},[e.fab?n("v-icon",[e._v("mdi-close")]):n("v-icon",[e._v("mdi-car")])],1)]},proxy:!0}]),model:{value:e.fab,callback:function(t){e.fab=t},expression:"fab"}},[e._v(" "),n("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#4CAF50"},on:{click:e.openMenu}},[n("v-icon",[e._v("mdi-pencil")])],1),e._v(" "),n("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#3F51B5"},on:{click:e.copyLink}},[n("v-icon",[e._v("mdi-link")])],1),e._v(" "),n("v-btn",{attrs:{fab:"",dark:"",small:"",color:"#F44336"}},[n("v-icon",[e._v("mdi-cart")])],1)],1),e._v(" "),n("v-snackbar",{attrs:{timeout:e.timeout,right:"",top:"",rounded:""},scopedSlots:e._u([{key:"action",fn:function(t){var r=t.attrs;return[n("v-btn",e._b({attrs:{color:"blue",text:""},on:{click:function(t){e.snackbar=!1}}},"v-btn",r,!1),[n("p",{staticStyle:{"font-size":"14px",color:"#03A9F4"}},[e._v("Đóng")])])]}}]),model:{value:e.snackbar,callback:function(t){e.snackbar=t},expression:"snackbar"}},[n("p",{staticStyle:{"font-size":"14px"}},[e._v(e._s(e.text))])])],1)}),[],!1,(function(e){this.$style=o.default.locals||o.default}),null,null);t.default=component.exports;h()(component,{VBtn:d.a,VIcon:f.a,VSnackbar:m.a,VSpeedDial:v.a})},511:function(e,t,n){"use strict";n(452)},512:function(e,t,n){var r=n(106)(!1);r.push([e.i,"#main-car{width:100%;height:100%;display:block;top:0;left:0}",""]),e.exports=r},542:function(e,t,n){"use strict";n.r(t);n(23),n(55),n(29),n(111),n(67),n(28),n(54),n(64);var r=n(18),o=n(22),l=n(15),c=n(12);function h(object,e){for(;!Object.prototype.hasOwnProperty.call(object,e)&&null!==(object=Object(c.a)(object)););return object}function d(){return d="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,n){var base=h(e,t);if(base){var desc=Object.getOwnPropertyDescriptor(base,t);return desc.get?desc.get.call(arguments.length<3?e:n):desc.value}},d.apply(this,arguments)}var f,m=n(208),v=n(27),y=n(24),x=n(16),_=n(17);n(66),n(230),n(44),n(8),n(76),n(479),n(226),n(398),n(480),n(481),n(46),n(399),n(401),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(411),n(412),n(413),n(414),n(415),n(416),n(417),n(419),n(420),n(421),n(422),n(423),n(424),n(425),n(426),n(427),n(428),n(491),n(429),n(430),n(492),n(431),n(432),n(493),n(37),n(494),n(38),n(495),n(498),n(39),n(233),n(499),n(500),n(88),n(110),n(159),n(41),n(501),n(436),n(437),n(438),n(439),n(440),n(441),n(442),n(443),n(444),n(445),n(446),n(447),n(448),n(449),n(34),n(43),n(505),n(169),n(506),n(450),n(451),n(163),n(135),n(73),n(174),n(53),n(232);function w(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,r=function(){};return{s:r,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,l=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){c=!0,o=e},f:function(){try{l||null==n.return||n.return()}finally{if(c)throw o}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,n=new Array(t);i<t;i++)n[i]=e[i];return n}function S(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=Object(c.a)(e);if(t){var o=Object(c.a)(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return Object(y.a)(this,n)}}var E=0,T=1,C=2,L=0,A=1,R=2,k=3,P=100,O=301,I=302,D=306,N=307,H=1e3,z=1001,F=1002,B=1003,U=1004,j=1005,G=1006,V=1007,W=1008,X=1009,Y=1012,Z=1014,J=1015,$=1016,K=1020,Q=1022,ee=1023,te=1026,ne=1027,ie=2300,re=2301,ae=2302,oe=2400,se=2401,le=2402,ce=2500,ue=2501,he=3e3,de=3001,pe=3007,fe=3002,me=7680,ve=35044,ge=35048,ye="300 es";function xe(){}Object.assign(xe.prototype,{addEventListener:function(e,t){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[e]&&(n[e]=[]),-1===n[e].indexOf(t)&&n[e].push(t)},hasEventListener:function(e,t){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[e]&&-1!==n[e].indexOf(t)},removeEventListener:function(e,t){if(void 0!==this._listeners){var n=this._listeners[e];if(void 0!==n){var r=n.indexOf(t);-1!==r&&n.splice(r,1)}}},dispatchEvent:function(e){if(void 0!==this._listeners){var t=this._listeners[e.type];if(void 0!==t){e.target=this;for(var n=t.slice(0),i=0,r=n.length;i<r;i++)n[i].call(this,e);e.target=null}}}});for(var be=[],_e=0;_e<256;_e++)be[_e]=(_e<16?"0":"")+_e.toString(16);var we=1234567,Me={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){var e=4294967295*Math.random()|0,t=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0;return(be[255&e]+be[e>>8&255]+be[e>>16&255]+be[e>>24&255]+"-"+be[255&t]+be[t>>8&255]+"-"+be[t>>16&15|64]+be[t>>24&255]+"-"+be[63&n|128]+be[n>>8&255]+"-"+be[n>>16&255]+be[n>>24&255]+be[255&r]+be[r>>8&255]+be[r>>16&255]+be[r>>24&255]).toUpperCase()},clamp:function(e,t,n){return Math.max(t,Math.min(n,e))},euclideanModulo:function(e,t){return(e%t+t)%t},mapLinear:function(e,t,n,r,o){return r+(e-t)*(o-r)/(n-t)},inverseLerp:function(e,t,n){return e!==t?(n-e)/(t-e):0},lerp:function(e,t,n){return(1-n)*e+n*t},damp:function(e,t,n,dt){return Me.lerp(e,t,1-Math.exp(-n*dt))},pingpong:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t-Math.abs(Me.euclideanModulo(e,2*t)-t)},smoothstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*(3-2*e)},smootherstep:function(e,t,n){return e<=t?0:e>=n?1:(e=(e-t)/(n-t))*e*e*(e*(6*e-15)+10)},randInt:function(e,t){return e+Math.floor(Math.random()*(t-e+1))},randFloat:function(e,t){return e+Math.random()*(t-e)},randFloatSpread:function(e){return e*(.5-Math.random())},seededRandom:function(s){return void 0!==s&&(we=s%2147483647),((we=16807*we%2147483647)-1)/2147483646},degToRad:function(e){return e*Me.DEG2RAD},radToDeg:function(e){return e*Me.RAD2DEG},isPowerOfTwo:function(e){return 0==(e&e-1)&&0!==e},ceilPowerOfTwo:function(e){return Math.pow(2,Math.ceil(Math.log(e)/Math.LN2))},floorPowerOfTwo:function(e){return Math.pow(2,Math.floor(Math.log(e)/Math.LN2))},setQuaternionFromProperEuler:function(q,a,b,e,t){var n=Math.cos,r=Math.sin,o=n(b/2),l=r(b/2),c=n((a+e)/2),h=r((a+e)/2),d=n((a-e)/2),f=r((a-e)/2),m=n((e-a)/2),v=r((e-a)/2);switch(t){case"XYX":q.set(o*h,l*d,l*f,o*c);break;case"YZY":q.set(l*f,o*h,l*d,o*c);break;case"ZXZ":q.set(l*d,l*f,o*h,o*c);break;case"XZX":q.set(o*h,l*v,l*m,o*c);break;case"YXY":q.set(l*m,o*h,l*v,o*c);break;case"ZYZ":q.set(l*v,l*m,o*h,o*c);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+t)}}},Se=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(x.a)(this,e),this.x=t,this.y=n}return Object(_.a)(e,[{key:"width",get:function(){return this.x},set:function(e){this.x=e}},{key:"height",get:function(){return this.y},set:function(e){this.y=e}},{key:"set",value:function(e,t){return this.x=e,this.y=t,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this)}},{key:"addScalar",value:function(s){return this.x+=s,this.y+=s,this}},{key:"addVectors",value:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this}},{key:"addScaledVector",value:function(e,s){return this.x+=e.x*s,this.y+=e.y*s,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this)}},{key:"subScalar",value:function(s){return this.x-=s,this.y-=s,this}},{key:"subVectors",value:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=e.elements;return this.x=r[0]*t+r[3]*n+r[6],this.y=r[1]*t+r[4]*n+r[7],this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y}},{key:"cross",value:function(e){return this.x*e.y-this.y*e.x}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"angle",value:function(){var e=Math.atan2(-this.y,-this.x)+Math.PI;return e}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y;return t*t+n*n}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this}},{key:"rotateAround",value:function(e,t){var n=Math.cos(t),s=Math.sin(t),r=this.x-e.x,o=this.y-e.y;return this.x=r*n-o*s+e.x,this.y=r*s+o*n+e.y,this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this}}]),e}();Se.prototype.isVector2=!0;var Ee,Te=function(){function e(){Object(x.a)(this,e),this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}return Object(_.a)(e,[{key:"set",value:function(e,t,n,r,o,l,c,h,d){var f=this.elements;return f[0]=e,f[1]=r,f[2]=c,f[3]=t,f[4]=o,f[5]=h,f[6]=n,f[7]=l,f[8]=d,this}},{key:"identity",value:function(){return this.set(1,0,0,0,1,0,0,0,1),this}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrix3Column(this,0),t.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}},{key:"setFromMatrix4",value:function(e){var t=e.elements;return this.set(t[0],t[4],t[8],t[1],t[5],t[9],t[2],t[6],t[10]),this}},{key:"multiply",value:function(e){return this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(a,b){var e=a.elements,t=b.elements,n=this.elements,r=e[0],o=e[3],l=e[6],c=e[1],h=e[4],d=e[7],f=e[2],m=e[5],v=e[8],y=t[0],x=t[3],_=t[6],w=t[1],M=t[4],S=t[7],E=t[2],T=t[5],C=t[8];return n[0]=r*y+o*w+l*E,n[3]=r*x+o*M+l*T,n[6]=r*_+o*S+l*C,n[1]=c*y+h*w+d*E,n[4]=c*x+h*M+d*T,n[7]=c*_+h*S+d*C,n[2]=f*y+m*w+v*E,n[5]=f*x+m*M+v*T,n[8]=f*_+m*S+v*C,this}},{key:"multiplyScalar",value:function(s){var e=this.elements;return e[0]*=s,e[3]*=s,e[6]*=s,e[1]*=s,e[4]*=s,e[7]*=s,e[2]*=s,e[5]*=s,e[8]*=s,this}},{key:"determinant",value:function(){var e=this.elements,a=e[0],b=e[1],t=e[2],n=e[3],r=e[4],o=e[5],g=e[6],l=e[7],i=e[8];return a*r*i-a*o*l-b*n*i+b*o*g+t*n*l-t*r*g}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],c=e[5],h=e[6],d=e[7],f=e[8],m=f*l-c*d,v=c*h-f*o,y=d*o-l*h,x=t*m+n*v+r*y;if(0===x)return this.set(0,0,0,0,0,0,0,0,0);var _=1/x;return e[0]=m*_,e[1]=(r*d-f*n)*_,e[2]=(c*n-r*l)*_,e[3]=v*_,e[4]=(f*t-r*h)*_,e[5]=(r*o-c*t)*_,e[6]=y*_,e[7]=(n*h-d*t)*_,e[8]=(l*t-n*o)*_,this}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[3],t[3]=e,e=t[2],t[2]=t[6],t[6]=e,e=t[5],t[5]=t[7],t[7]=e,this}},{key:"getNormalMatrix",value:function(e){return this.setFromMatrix4(e).invert().transpose()}},{key:"transposeIntoArray",value:function(e){var t=this.elements;return e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8],this}},{key:"setUvTransform",value:function(e,t,n,r,o,l,c){var h=Math.cos(o),s=Math.sin(o);return this.set(n*h,n*s,-n*(h*l+s*c)+l+e,-r*s,r*h,-r*(-s*l+h*c)+c+t,0,0,1),this}},{key:"scale",value:function(e,t){var n=this.elements;return n[0]*=e,n[3]*=e,n[6]*=e,n[1]*=t,n[4]*=t,n[7]*=t,this}},{key:"rotate",value:function(e){var t=Math.cos(e),s=Math.sin(e),n=this.elements,r=n[0],o=n[3],l=n[6],c=n[1],h=n[4],d=n[7];return n[0]=t*r+s*c,n[3]=t*o+s*h,n[6]=t*l+s*d,n[1]=-s*r+t*c,n[4]=-s*o+t*h,n[7]=-s*l+t*d,this}},{key:"translate",value:function(e,t){var n=this.elements;return n[0]+=e*n[2],n[3]+=e*n[5],n[6]+=e*n[8],n[1]+=t*n[2],n[4]+=t*n[5],n[7]+=t*n[8],this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<9;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<9;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e}},{key:"clone",value:function(){return(new this.constructor).fromArray(this.elements)}}]),e}();Te.prototype.isMatrix3=!0;var Ce={getDataURL:function(image){if(/^data:/i.test(image.src))return image.src;if("undefined"==typeof HTMLCanvasElement)return image.src;var canvas;if(image instanceof HTMLCanvasElement)canvas=image;else{void 0===Ee&&(Ee=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),Ee.width=image.width,Ee.height=image.height;var e=Ee.getContext("2d");image instanceof ImageData?e.putImageData(image,0,0):e.drawImage(image,0,0,image.width,image.height),canvas=Ee}return canvas.width>2048||canvas.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",image),canvas.toDataURL("image/jpeg",.6)):canvas.toDataURL("image/png")}},Le=0,Ae=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,image=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.DEFAULT_IMAGE,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.DEFAULT_MAPPING,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:z,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:z,c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:G,h=arguments.length>5&&void 0!==arguments[5]?arguments[5]:W,d=arguments.length>6&&void 0!==arguments[6]?arguments[6]:ee,f=arguments.length>7&&void 0!==arguments[7]?arguments[7]:X,v=arguments.length>8&&void 0!==arguments[8]?arguments[8]:1,y=arguments.length>9&&void 0!==arguments[9]?arguments[9]:he;return Object(x.a)(this,n),e=t.call(this),Object.defineProperty(Object(m.a)(e),"id",{value:Le++}),e.uuid=Me.generateUUID(),e.name="",e.image=image,e.mipmaps=[],e.mapping=r,e.wrapS=o,e.wrapT=l,e.magFilter=c,e.minFilter=h,e.anisotropy=v,e.format=d,e.internalFormat=null,e.type=f,e.offset=new Se(0,0),e.repeat=new Se(1,1),e.center=new Se(0,0),e.rotation=0,e.matrixAutoUpdate=!0,e.matrix=new Te,e.generateMipmaps=!0,e.premultiplyAlpha=!1,e.flipY=!0,e.unpackAlignment=4,e.encoding=y,e.version=0,e.onUpdate=null,e}return Object(_.a)(n,[{key:"updateMatrix",value:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(source){return this.name=source.name,this.image=source.image,this.mipmaps=source.mipmaps.slice(0),this.mapping=source.mapping,this.wrapS=source.wrapS,this.wrapT=source.wrapT,this.magFilter=source.magFilter,this.minFilter=source.minFilter,this.anisotropy=source.anisotropy,this.format=source.format,this.internalFormat=source.internalFormat,this.type=source.type,this.offset.copy(source.offset),this.repeat.copy(source.repeat),this.center.copy(source.center),this.rotation=source.rotation,this.matrixAutoUpdate=source.matrixAutoUpdate,this.matrix.copy(source.matrix),this.generateMipmaps=source.generateMipmaps,this.premultiplyAlpha=source.premultiplyAlpha,this.flipY=source.flipY,this.unpackAlignment=source.unpackAlignment,this.encoding=source.encoding,this}},{key:"toJSON",value:function(meta){var e=void 0===meta||"string"==typeof meta;if(!e&&void 0!==meta.textures[this.uuid])return meta.textures[this.uuid];var output={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(void 0!==this.image){var image=this.image;if(void 0===image.uuid&&(image.uuid=Me.generateUUID()),!e&&void 0===meta.images[image.uuid]){var t;if(Array.isArray(image)){t=[];for(var n=0,r=image.length;n<r;n++)image[n].isDataTexture?t.push(Re(image[n].image)):t.push(Re(image[n]))}else t=Re(image);meta.images[image.uuid]={uuid:image.uuid,url:t}}output.image=image.uuid}return e||(meta.textures[this.uuid]=output),output}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}},{key:"transformUv",value:function(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case H:e.x=e.x-Math.floor(e.x);break;case z:e.x=e.x<0?0:1;break;case F:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case H:e.y=e.y-Math.floor(e.y);break;case z:e.y=e.y<0?0:1;break;case F:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}},{key:"needsUpdate",set:function(e){!0===e&&this.version++}}]),n}(xe);function Re(image){return"undefined"!=typeof HTMLImageElement&&image instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&image instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&image instanceof ImageBitmap?Ce.getDataURL(image):image.data?{data:Array.prototype.slice.call(image.data),width:image.width,height:image.height,type:image.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}Ae.DEFAULT_IMAGE=void 0,Ae.DEFAULT_MAPPING=300,Ae.prototype.isTexture=!0;var ke=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(x.a)(this,e),this.x=t,this.y=n,this.z=r,this.w=o}return Object(_.a)(e,[{key:"width",get:function(){return this.z},set:function(e){this.z=e}},{key:"height",get:function(){return this.w},set:function(e){this.w=e}},{key:"set",value:function(e,t,n,r){return this.x=e,this.y=t,this.z=n,this.w=r,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setW",value:function(e){return this.w=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;case 3:this.w=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z,this.w)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this)}},{key:"addScalar",value:function(s){return this.x+=s,this.y+=s,this.z+=s,this.w+=s,this}},{key:"addVectors",value:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this.w=a.w+b.w,this}},{key:"addScaledVector",value:function(e,s){return this.x+=e.x*s,this.y+=e.y*s,this.z+=e.z*s,this.w+=e.w*s,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this)}},{key:"subScalar",value:function(s){return this.x-=s,this.y-=s,this.z-=s,this.w-=s,this}},{key:"subVectors",value:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this.w=a.w-b.w,this}},{key:"multiply",value:function(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,o=this.w,l=e.elements;return this.x=l[0]*t+l[4]*n+l[8]*r+l[12]*o,this.y=l[1]*t+l[5]*n+l[9]*r+l[13]*o,this.z=l[2]*t+l[6]*n+l[10]*r+l[14]*o,this.w=l[3]*t+l[7]*n+l[11]*r+l[15]*o,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"setAxisAngleFromQuaternion",value:function(q){this.w=2*Math.acos(q.w);var s=Math.sqrt(1-q.w*q.w);return s<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=q.x/s,this.y=q.y/s,this.z=q.z/s),this}},{key:"setAxisAngleFromRotationMatrix",value:function(e){var t,n,r,o,l=.01,c=.1,h=e.elements,d=h[0],f=h[4],m=h[8],v=h[1],y=h[5],x=h[9],_=h[2],w=h[6],M=h[10];if(Math.abs(f-v)<l&&Math.abs(m-_)<l&&Math.abs(x-w)<l){if(Math.abs(f+v)<c&&Math.abs(m+_)<c&&Math.abs(x+w)<c&&Math.abs(d+y+M-3)<c)return this.set(1,0,0,0),this;t=Math.PI;var S=(d+1)/2,E=(y+1)/2,T=(M+1)/2,C=(f+v)/4,L=(m+_)/4,A=(x+w)/4;return S>E&&S>T?S<l?(n=0,r=.707106781,o=.707106781):(r=C/(n=Math.sqrt(S)),o=L/n):E>T?E<l?(n=.707106781,r=0,o=.707106781):(n=C/(r=Math.sqrt(E)),o=A/r):T<l?(n=.707106781,r=.707106781,o=0):(n=L/(o=Math.sqrt(T)),r=A/o),this.set(n,r,o,t),this}var s=Math.sqrt((w-x)*(w-x)+(m-_)*(m-_)+(v-f)*(v-f));return Math.abs(s)<.001&&(s=1),this.x=(w-x)/s,this.y=(m-_)/s,this.z=(v-f)/s,this.w=Math.acos((d+y+M-1)/2),this}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this.w=Math.max(e.w,Math.min(t.w,this.w)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this.w=Math.max(e,Math.min(t,this.w)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this.w+=(e.w-this.w)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this.w=e.w+(t.w-e.w)*n,this}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this.w=e[t+3],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e[t+3]=this.w,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this.w=e.getW(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}}]),e}();ke.prototype.isVector4=!0;var Pe=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o){var l;return Object(x.a)(this,n),(l=t.call(this)).width=e,l.height=r,l.depth=1,l.scissor=new ke(0,0,e,r),l.scissorTest=!1,l.viewport=new ke(0,0,e,r),o=o||{},l.texture=new Ae(void 0,o.mapping,o.wrapS,o.wrapT,o.magFilter,o.minFilter,o.format,o.type,o.anisotropy,o.encoding),l.texture.image={},l.texture.image.width=e,l.texture.image.height=r,l.texture.image.depth=1,l.texture.generateMipmaps=void 0!==o.generateMipmaps&&o.generateMipmaps,l.texture.minFilter=void 0!==o.minFilter?o.minFilter:G,l.depthBuffer=void 0===o.depthBuffer||o.depthBuffer,l.stencilBuffer=void 0!==o.stencilBuffer&&o.stencilBuffer,l.depthTexture=void 0!==o.depthTexture?o.depthTexture:null,l}return Object(_.a)(n,[{key:"setTexture",value:function(e){e.image={width:this.width,height:this.height,depth:this.depth},this.texture=e}},{key:"setSize",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;this.width===e&&this.height===t&&this.depth===n||(this.width=e,this.height=t,this.depth=n,this.texture.image.width=e,this.texture.image.height=t,this.texture.image.depth=n,this.dispose()),this.viewport.set(0,0,e,t),this.scissor.set(0,0,e,t)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(source){return this.width=source.width,this.height=source.height,this.depth=source.depth,this.viewport.copy(source.viewport),this.texture=source.texture.clone(),this.depthBuffer=source.depthBuffer,this.stencilBuffer=source.stencilBuffer,this.depthTexture=source.depthTexture,this}},{key:"dispose",value:function(){this.dispatchEvent({type:"dispose"})}}]),n}(xe);Pe.prototype.isWebGLRenderTarget=!0,function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o){var l;return Object(x.a)(this,n),(l=t.call(this,e,r,o)).samples=4,l}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.samples=source.samples,this}}]),n}(Pe).prototype.isWebGLMultisampleRenderTarget=!0;var Oe=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(x.a)(this,e),this._x=t,this._y=n,this._z=r,this._w=o}return Object(_.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"w",get:function(){return this._w},set:function(e){this._w=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._w=r,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._w)}},{key:"copy",value:function(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}},{key:"setFromEuler",value:function(e,t){if(!e||!e.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=e._x,r=e._y,o=e._z,l=e._order,c=Math.cos,h=Math.sin,d=c(n/2),f=c(r/2),m=c(o/2),v=h(n/2),y=h(r/2),x=h(o/2);switch(l){case"XYZ":this._x=v*f*m+d*y*x,this._y=d*y*m-v*f*x,this._z=d*f*x+v*y*m,this._w=d*f*m-v*y*x;break;case"YXZ":this._x=v*f*m+d*y*x,this._y=d*y*m-v*f*x,this._z=d*f*x-v*y*m,this._w=d*f*m+v*y*x;break;case"ZXY":this._x=v*f*m-d*y*x,this._y=d*y*m+v*f*x,this._z=d*f*x+v*y*m,this._w=d*f*m-v*y*x;break;case"ZYX":this._x=v*f*m-d*y*x,this._y=d*y*m+v*f*x,this._z=d*f*x-v*y*m,this._w=d*f*m+v*y*x;break;case"YZX":this._x=v*f*m+d*y*x,this._y=d*y*m+v*f*x,this._z=d*f*x-v*y*m,this._w=d*f*m-v*y*x;break;case"XZY":this._x=v*f*m-d*y*x,this._y=d*y*m-v*f*x,this._z=d*f*x+v*y*m,this._w=d*f*m+v*y*x;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+l)}return!1!==t&&this._onChangeCallback(),this}},{key:"setFromAxisAngle",value:function(e,t){var n=t/2,s=Math.sin(n);return this._x=e.x*s,this._y=e.y*s,this._z=e.z*s,this._w=Math.cos(n),this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e){var t=e.elements,n=t[0],r=t[4],o=t[8],l=t[1],c=t[5],h=t[9],d=t[2],f=t[6],m=t[10],v=n+c+m;if(v>0){var s=.5/Math.sqrt(v+1);this._w=.25/s,this._x=(f-h)*s,this._y=(o-d)*s,this._z=(l-r)*s}else if(n>c&&n>m){var y=2*Math.sqrt(1+n-c-m);this._w=(f-h)/y,this._x=.25*y,this._y=(r+l)/y,this._z=(o+d)/y}else if(c>m){var x=2*Math.sqrt(1+c-n-m);this._w=(o-d)/x,this._x=(r+l)/x,this._y=.25*x,this._z=(h+f)/x}else{var _=2*Math.sqrt(1+m-n-c);this._w=(l-r)/_,this._x=(o+d)/_,this._y=(h+f)/_,this._z=.25*_}return this._onChangeCallback(),this}},{key:"setFromUnitVectors",value:function(e,t){var n=e.dot(t)+1;return n<Number.EPSILON?(n=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0,this._w=n):(this._x=0,this._y=-e.z,this._z=e.y,this._w=n)):(this._x=e.y*t.z-e.z*t.y,this._y=e.z*t.x-e.x*t.z,this._z=e.x*t.y-e.y*t.x,this._w=n),this.normalize()}},{key:"angleTo",value:function(q){return 2*Math.acos(Math.abs(Me.clamp(this.dot(q),-1,1)))}},{key:"rotateTowards",value:function(q,e){var t=this.angleTo(q);if(0===t)return this;var n=Math.min(1,e/t);return this.slerp(q,n),this}},{key:"identity",value:function(){return this.set(0,0,0,1)}},{key:"invert",value:function(){return this.conjugate()}},{key:"conjugate",value:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}},{key:"dot",value:function(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}},{key:"lengthSq",value:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}},{key:"length",value:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}},{key:"normalize",value:function(){var e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}},{key:"multiply",value:function(q,p){return void 0!==p?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(q,p)):this.multiplyQuaternions(this,q)}},{key:"premultiply",value:function(q){return this.multiplyQuaternions(q,this)}},{key:"multiplyQuaternions",value:function(a,b){var e=a._x,t=a._y,n=a._z,r=a._w,o=b._x,l=b._y,c=b._z,h=b._w;return this._x=e*h+r*o+t*c-n*l,this._y=t*h+r*l+n*o-e*c,this._z=n*h+r*c+e*l-t*o,this._w=r*h-e*o-t*l-n*c,this._onChangeCallback(),this}},{key:"slerp",value:function(e,t){if(0===t)return this;if(1===t)return this.copy(e);var n=this._x,r=this._y,o=this._z,l=this._w,c=l*e._w+n*e._x+r*e._y+o*e._z;if(c<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,c=-c):this.copy(e),c>=1)return this._w=l,this._x=n,this._y=r,this._z=o,this;var h=1-c*c;if(h<=Number.EPSILON){var s=1-t;return this._w=s*l+t*this._w,this._x=s*n+t*this._x,this._y=s*r+t*this._y,this._z=s*o+t*this._z,this.normalize(),this._onChangeCallback(),this}var d=Math.sqrt(h),f=Math.atan2(d,c),m=Math.sin((1-t)*f)/d,v=Math.sin(t*f)/d;return this._w=l*m+this._w*v,this._x=n*m+this._x*v,this._y=r*m+this._y*v,this._z=o*m+this._z*v,this._onChangeCallback(),this}},{key:"slerpQuaternions",value:function(e,t,n){this.copy(e).slerp(t,n)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this._x=e[t],this._y=e[t+1],this._z=e[t+2],this._w=e[t+3],this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._w,e}},{key:"fromBufferAttribute",value:function(e,t){return this._x=e.getX(t),this._y=e.getY(t),this._z=e.getZ(t),this._w=e.getW(t),this}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}],[{key:"slerp",value:function(e,t,n,r){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),n.slerpQuaternions(e,t,r)}},{key:"slerpFlat",value:function(e,t,n,r,o,l,c){var h=n[r+0],d=n[r+1],f=n[r+2],m=n[r+3],v=o[l+0],y=o[l+1],x=o[l+2],_=o[l+3];if(0===c)return e[t+0]=h,e[t+1]=d,e[t+2]=f,void(e[t+3]=m);if(1===c)return e[t+0]=v,e[t+1]=y,e[t+2]=x,void(e[t+3]=_);if(m!==_||h!==v||d!==y||f!==x){var s=1-c,w=h*v+d*y+f*x+m*_,M=w>=0?1:-1,S=1-w*w;if(S>Number.EPSILON){var E=Math.sqrt(S),T=Math.atan2(E,w*M);s=Math.sin(s*T)/E,c=Math.sin(c*T)/E}var C=c*M;if(h=h*s+v*C,d=d*s+y*C,f=f*s+x*C,m=m*s+_*C,s===1-c){var L=1/Math.sqrt(h*h+d*d+f*f+m*m);h*=L,d*=L,f*=L,m*=L}}e[t]=h,e[t+1]=d,e[t+2]=f,e[t+3]=m}},{key:"multiplyQuaternionsFlat",value:function(e,t,n,r,o,l){var c=n[r],h=n[r+1],d=n[r+2],f=n[r+3],m=o[l],v=o[l+1],y=o[l+2],x=o[l+3];return e[t]=c*x+f*m+h*y-d*v,e[t+1]=h*x+f*v+d*m-c*y,e[t+2]=d*x+f*y+c*v-h*m,e[t+3]=f*x-c*m-h*v-d*y,e}}]),e}();Oe.prototype.isQuaternion=!0;var Ie=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;Object(x.a)(this,e),this.x=t,this.y=n,this.z=r}return Object(_.a)(e,[{key:"set",value:function(e,t,n){return void 0===n&&(n=this.z),this.x=e,this.y=t,this.z=n,this}},{key:"setScalar",value:function(e){return this.x=e,this.y=e,this.z=e,this}},{key:"setX",value:function(e){return this.x=e,this}},{key:"setY",value:function(e){return this.y=e,this}},{key:"setZ",value:function(e){return this.z=e,this}},{key:"setComponent",value:function(e,t){switch(e){case 0:this.x=t;break;case 1:this.y=t;break;case 2:this.z=t;break;default:throw new Error("index is out of range: "+e)}return this}},{key:"getComponent",value:function(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+e)}}},{key:"clone",value:function(){return new this.constructor(this.x,this.y,this.z)}},{key:"copy",value:function(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}},{key:"add",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(e,t)):(this.x+=e.x,this.y+=e.y,this.z+=e.z,this)}},{key:"addScalar",value:function(s){return this.x+=s,this.y+=s,this.z+=s,this}},{key:"addVectors",value:function(a,b){return this.x=a.x+b.x,this.y=a.y+b.y,this.z=a.z+b.z,this}},{key:"addScaledVector",value:function(e,s){return this.x+=e.x*s,this.y+=e.y*s,this.z+=e.z*s,this}},{key:"sub",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(e,t)):(this.x-=e.x,this.y-=e.y,this.z-=e.z,this)}},{key:"subScalar",value:function(s){return this.x-=s,this.y-=s,this.z-=s,this}},{key:"subVectors",value:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this.z=a.z-b.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(e,t)):(this.x*=e.x,this.y*=e.y,this.z*=e.z,this)}},{key:"multiplyScalar",value:function(e){return this.x*=e,this.y*=e,this.z*=e,this}},{key:"multiplyVectors",value:function(a,b){return this.x=a.x*b.x,this.y=a.y*b.y,this.z=a.z*b.z,this}},{key:"applyEuler",value:function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ne.setFromEuler(e))}},{key:"applyAxisAngle",value:function(e,t){return this.applyQuaternion(Ne.setFromAxisAngle(e,t))}},{key:"applyMatrix3",value:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[3]*n+o[6]*r,this.y=o[1]*t+o[4]*n+o[7]*r,this.z=o[2]*t+o[5]*n+o[8]*r,this}},{key:"applyNormalMatrix",value:function(e){return this.applyMatrix3(e).normalize()}},{key:"applyMatrix4",value:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements,l=1/(o[3]*t+o[7]*n+o[11]*r+o[15]);return this.x=(o[0]*t+o[4]*n+o[8]*r+o[12])*l,this.y=(o[1]*t+o[5]*n+o[9]*r+o[13])*l,this.z=(o[2]*t+o[6]*n+o[10]*r+o[14])*l,this}},{key:"applyQuaternion",value:function(q){var e=this.x,t=this.y,n=this.z,r=q.x,o=q.y,l=q.z,c=q.w,h=c*e+o*n-l*t,d=c*t+l*e-r*n,f=c*n+r*t-o*e,m=-r*e-o*t-l*n;return this.x=h*c+m*-r+d*-l-f*-o,this.y=d*c+m*-o+f*-r-h*-l,this.z=f*c+m*-l+h*-o-d*-r,this}},{key:"project",value:function(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}},{key:"unproject",value:function(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}},{key:"transformDirection",value:function(e){var t=this.x,n=this.y,r=this.z,o=e.elements;return this.x=o[0]*t+o[4]*n+o[8]*r,this.y=o[1]*t+o[5]*n+o[9]*r,this.z=o[2]*t+o[6]*n+o[10]*r,this.normalize()}},{key:"divide",value:function(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}},{key:"divideScalar",value:function(e){return this.multiplyScalar(1/e)}},{key:"min",value:function(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}},{key:"max",value:function(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}},{key:"clamp",value:function(e,t){return this.x=Math.max(e.x,Math.min(t.x,this.x)),this.y=Math.max(e.y,Math.min(t.y,this.y)),this.z=Math.max(e.z,Math.min(t.z,this.z)),this}},{key:"clampScalar",value:function(e,t){return this.x=Math.max(e,Math.min(t,this.x)),this.y=Math.max(e,Math.min(t,this.y)),this.z=Math.max(e,Math.min(t,this.z)),this}},{key:"clampLength",value:function(e,t){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(e,Math.min(t,n)))}},{key:"floor",value:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}},{key:"ceil",value:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}},{key:"round",value:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}},{key:"roundToZero",value:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}},{key:"negate",value:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}},{key:"dot",value:function(e){return this.x*e.x+this.y*e.y+this.z*e.z}},{key:"lengthSq",value:function(){return this.x*this.x+this.y*this.y+this.z*this.z}},{key:"length",value:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}},{key:"manhattanLength",value:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}},{key:"normalize",value:function(){return this.divideScalar(this.length()||1)}},{key:"setLength",value:function(e){return this.normalize().multiplyScalar(e)}},{key:"lerp",value:function(e,t){return this.x+=(e.x-this.x)*t,this.y+=(e.y-this.y)*t,this.z+=(e.z-this.z)*t,this}},{key:"lerpVectors",value:function(e,t,n){return this.x=e.x+(t.x-e.x)*n,this.y=e.y+(t.y-e.y)*n,this.z=e.z+(t.z-e.z)*n,this}},{key:"cross",value:function(e,t){return void 0!==t?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(e,t)):this.crossVectors(this,e)}},{key:"crossVectors",value:function(a,b){var e=a.x,t=a.y,n=a.z,r=b.x,o=b.y,l=b.z;return this.x=t*l-n*o,this.y=n*r-e*l,this.z=e*o-t*r,this}},{key:"projectOnVector",value:function(e){var t=e.lengthSq();if(0===t)return this.set(0,0,0);var n=e.dot(this)/t;return this.copy(e).multiplyScalar(n)}},{key:"projectOnPlane",value:function(e){return De.copy(this).projectOnVector(e),this.sub(De)}},{key:"reflect",value:function(e){return this.sub(De.copy(e).multiplyScalar(2*this.dot(e)))}},{key:"angleTo",value:function(e){var t=Math.sqrt(this.lengthSq()*e.lengthSq());if(0===t)return Math.PI/2;var n=this.dot(e)/t;return Math.acos(Me.clamp(n,-1,1))}},{key:"distanceTo",value:function(e){return Math.sqrt(this.distanceToSquared(e))}},{key:"distanceToSquared",value:function(e){var t=this.x-e.x,n=this.y-e.y,r=this.z-e.z;return t*t+n*n+r*r}},{key:"manhattanDistanceTo",value:function(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}},{key:"setFromSpherical",value:function(s){return this.setFromSphericalCoords(s.radius,s.phi,s.theta)}},{key:"setFromSphericalCoords",value:function(e,t,n){var r=Math.sin(t)*e;return this.x=r*Math.sin(n),this.y=Math.cos(t)*e,this.z=r*Math.cos(n),this}},{key:"setFromCylindrical",value:function(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}},{key:"setFromCylindricalCoords",value:function(e,t,n){return this.x=e*Math.sin(t),this.y=n,this.z=e*Math.cos(t),this}},{key:"setFromMatrixPosition",value:function(e){var t=e.elements;return this.x=t[12],this.y=t[13],this.z=t[14],this}},{key:"setFromMatrixScale",value:function(e){var t=this.setFromMatrixColumn(e,0).length(),n=this.setFromMatrixColumn(e,1).length(),r=this.setFromMatrixColumn(e,2).length();return this.x=t,this.y=n,this.z=r,this}},{key:"setFromMatrixColumn",value:function(e,t){return this.fromArray(e.elements,4*t)}},{key:"setFromMatrix3Column",value:function(e,t){return this.fromArray(e.elements,3*t)}},{key:"equals",value:function(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.x=e[t],this.y=e[t+1],this.z=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.x,e[t+1]=this.y,e[t+2]=this.z,e}},{key:"fromBufferAttribute",value:function(e,t,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=e.getX(t),this.y=e.getY(t),this.z=e.getZ(t),this}},{key:"random",value:function(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}}]),e}();Ie.prototype.isVector3=!0;var De=new Ie,Ne=new Oe,He=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie(1/0,1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie(-1/0,-1/0,-1/0);Object(x.a)(this,e),this.min=t,this.max=n}return Object(_.a)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromArray",value:function(e){for(var t=1/0,n=1/0,r=1/0,o=-1/0,l=-1/0,c=-1/0,h=0,d=e.length;h<d;h+=3){var f=e[h],m=e[h+1],v=e[h+2];f<t&&(t=f),m<n&&(n=m),v<r&&(r=v),f>o&&(o=f),m>l&&(l=m),v>c&&(c=v)}return this.min.set(t,n,r),this.max.set(o,l,c),this}},{key:"setFromBufferAttribute",value:function(e){for(var t=1/0,n=1/0,r=1/0,o=-1/0,l=-1/0,c=-1/0,h=0,d=e.count;h<d;h++){var f=e.getX(h),m=e.getY(h),v=e.getZ(h);f<t&&(t=f),m<n&&(n=m),v<r&&(r=v),f>o&&(o=f),m>l&&(l=m),v>c&&(c=v)}return this.min.set(t,n,r),this.max.set(o,l,c),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Fe.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"setFromObject",value:function(object){return this.makeEmpty(),this.expandByObject(object)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getCenter() target is now required"),e=new Ie),this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box3: .getSize() target is now required"),e=new Ie),this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"expandByObject",value:function(object){object.updateWorldMatrix(!1,!1);var e=object.geometry;void 0!==e&&(null===e.boundingBox&&e.computeBoundingBox(),Be.copy(e.boundingBox),Be.applyMatrix4(object.matrixWorld),this.union(Be));for(var t=object.children,n=0,r=t.length;n<r;n++)this.expandByObject(t[n]);return this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y||e.z<this.min.z||e.z>this.max.z)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .getParameter() target is now required"),t=new Ie),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y||e.max.z<this.min.z||e.min.z>this.max.z)}},{key:"intersectsSphere",value:function(e){return this.clampPoint(e.center,Fe),Fe.distanceToSquared(e.center)<=e.radius*e.radius}},{key:"intersectsPlane",value:function(e){var t,n;return e.normal.x>0?(t=e.normal.x*this.min.x,n=e.normal.x*this.max.x):(t=e.normal.x*this.max.x,n=e.normal.x*this.min.x),e.normal.y>0?(t+=e.normal.y*this.min.y,n+=e.normal.y*this.max.y):(t+=e.normal.y*this.max.y,n+=e.normal.y*this.min.y),e.normal.z>0?(t+=e.normal.z*this.min.z,n+=e.normal.z*this.max.z):(t+=e.normal.z*this.max.z,n+=e.normal.z*this.min.z),t<=-e.constant&&n>=-e.constant}},{key:"intersectsTriangle",value:function(e){if(this.isEmpty())return!1;this.getCenter(Xe),Ye.subVectors(this.max,Xe),Ue.subVectors(e.a,Xe),je.subVectors(e.b,Xe),Ge.subVectors(e.c,Xe),Ve.subVectors(je,Ue),We.subVectors(Ge,je),qe.subVectors(Ue,Ge);var t=[0,-Ve.z,Ve.y,0,-We.z,We.y,0,-qe.z,qe.y,Ve.z,0,-Ve.x,We.z,0,-We.x,qe.z,0,-qe.x,-Ve.y,Ve.x,0,-We.y,We.x,0,-qe.y,qe.x,0];return!!$e(t,Ue,je,Ge,Ye)&&(!!$e(t=[1,0,0,0,1,0,0,0,1],Ue,je,Ge,Ye)&&(Ze.crossVectors(Ve,We),$e(t=[Ze.x,Ze.y,Ze.z],Ue,je,Ge,Ye)))}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box3: .clampPoint() target is now required"),t=new Ie),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Fe.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"getBoundingSphere",value:function(e){return void 0===e&&console.error("THREE.Box3: .getBoundingSphere() target is now required"),this.getCenter(e.center),e.radius=.5*this.getSize(Fe).length(),e}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"applyMatrix4",value:function(e){return this.isEmpty()||(ze[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),ze[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),ze[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),ze[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),ze[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),ze[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),ze[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),ze[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(ze)),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();He.prototype.isBox3=!0;var ze=[new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie,new Ie],Fe=new Ie,Be=new He,Ue=new Ie,je=new Ie,Ge=new Ie,Ve=new Ie,We=new Ie,qe=new Ie,Xe=new Ie,Ye=new Ie,Ze=new Ie,Je=new Ie;function $e(e,t,n,r,o){for(var l=0,c=e.length-3;l<=c;l+=3){Je.fromArray(e,l);var h=o.x*Math.abs(Je.x)+o.y*Math.abs(Je.y)+o.z*Math.abs(Je.z),d=t.dot(Je),f=n.dot(Je),m=r.dot(Je);if(Math.max(-Math.max(d,f,m),Math.min(d,f,m))>h)return!1}return!0}var Ke=new He,Qe=new Ie,et=new Ie,tt=new Ie,nt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;Object(x.a)(this,e),this.center=t,this.radius=n}return Object(_.a)(e,[{key:"set",value:function(e,t){return this.center.copy(e),this.radius=t,this}},{key:"setFromPoints",value:function(e,t){var n=this.center;void 0!==t?n.copy(t):Ke.setFromPoints(e).getCenter(n);for(var r=0,o=0,l=e.length;o<l;o++)r=Math.max(r,n.distanceToSquared(e[o]));return this.radius=Math.sqrt(r),this}},{key:"copy",value:function(e){return this.center.copy(e.center),this.radius=e.radius,this}},{key:"isEmpty",value:function(){return this.radius<0}},{key:"makeEmpty",value:function(){return this.center.set(0,0,0),this.radius=-1,this}},{key:"containsPoint",value:function(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}},{key:"distanceToPoint",value:function(e){return e.distanceTo(this.center)-this.radius}},{key:"intersectsSphere",value:function(e){var t=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=t*t}},{key:"intersectsBox",value:function(e){return e.intersectsSphere(this)}},{key:"intersectsPlane",value:function(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}},{key:"clampPoint",value:function(e,t){var n=this.center.distanceToSquared(e);return void 0===t&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),t=new Ie),t.copy(e),n>this.radius*this.radius&&(t.sub(this.center).normalize(),t.multiplyScalar(this.radius).add(this.center)),t}},{key:"getBoundingBox",value:function(e){return void 0===e&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),e=new He),this.isEmpty()?(e.makeEmpty(),e):(e.set(this.center,this.center),e.expandByScalar(this.radius),e)}},{key:"applyMatrix4",value:function(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}},{key:"translate",value:function(e){return this.center.add(e),this}},{key:"expandByPoint",value:function(e){tt.subVectors(e,this.center);var t=tt.lengthSq();if(t>this.radius*this.radius){var n=Math.sqrt(t),r=.5*(n-this.radius);this.center.add(tt.multiplyScalar(r/n)),this.radius+=r}return this}},{key:"union",value:function(e){return et.subVectors(e.center,this.center).normalize().multiplyScalar(e.radius),this.expandByPoint(Qe.copy(e.center).add(et)),this.expandByPoint(Qe.copy(e.center).sub(et)),this}},{key:"equals",value:function(e){return e.center.equals(this.center)&&e.radius===this.radius}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),it=new Ie,at=new Ie,ot=new Ie,st=new Ie,lt=new Ie,ct=new Ie,ut=new Ie,ht=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie(0,0,-1);Object(x.a)(this,e),this.origin=t,this.direction=n}return Object(_.a)(e,[{key:"set",value:function(e,t){return this.origin.copy(e),this.direction.copy(t),this}},{key:"copy",value:function(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Ray: .at() target is now required"),t=new Ie),t.copy(this.direction).multiplyScalar(e).add(this.origin)}},{key:"lookAt",value:function(e){return this.direction.copy(e).sub(this.origin).normalize(),this}},{key:"recast",value:function(e){return this.origin.copy(this.at(e,it)),this}},{key:"closestPointToPoint",value:function(e,t){void 0===t&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),t=new Ie),t.subVectors(e,this.origin);var n=t.dot(this.direction);return n<0?t.copy(this.origin):t.copy(this.direction).multiplyScalar(n).add(this.origin)}},{key:"distanceToPoint",value:function(e){return Math.sqrt(this.distanceSqToPoint(e))}},{key:"distanceSqToPoint",value:function(e){var t=it.subVectors(e,this.origin).dot(this.direction);return t<0?this.origin.distanceToSquared(e):(it.copy(this.direction).multiplyScalar(t).add(this.origin),it.distanceToSquared(e))}},{key:"distanceSqToSegment",value:function(e,t,n,r){at.copy(e).add(t).multiplyScalar(.5),ot.copy(t).sub(e).normalize(),st.copy(this.origin).sub(at);var o,l,c,h,d=.5*e.distanceTo(t),f=-this.direction.dot(ot),m=st.dot(this.direction),v=-st.dot(ot),y=st.lengthSq(),x=Math.abs(1-f*f);if(x>0)if(l=f*m-v,h=d*x,(o=f*v-m)>=0)if(l>=-h)if(l<=h){var _=1/x;c=(o*=_)*(o+f*(l*=_)+2*m)+l*(f*o+l+2*v)+y}else l=d,c=-(o=Math.max(0,-(f*l+m)))*o+l*(l+2*v)+y;else l=-d,c=-(o=Math.max(0,-(f*l+m)))*o+l*(l+2*v)+y;else l<=-h?c=-(o=Math.max(0,-(-f*d+m)))*o+(l=o>0?-d:Math.min(Math.max(-d,-v),d))*(l+2*v)+y:l<=h?(o=0,c=(l=Math.min(Math.max(-d,-v),d))*(l+2*v)+y):c=-(o=Math.max(0,-(f*d+m)))*o+(l=o>0?d:Math.min(Math.max(-d,-v),d))*(l+2*v)+y;else l=f>0?-d:d,c=-(o=Math.max(0,-(f*l+m)))*o+l*(l+2*v)+y;return n&&n.copy(this.direction).multiplyScalar(o).add(this.origin),r&&r.copy(ot).multiplyScalar(l).add(at),c}},{key:"intersectSphere",value:function(e,t){it.subVectors(e.center,this.origin);var n=it.dot(this.direction),r=it.dot(it)-n*n,o=e.radius*e.radius;if(r>o)return null;var l=Math.sqrt(o-r),c=n-l,h=n+l;return c<0&&h<0?null:c<0?this.at(h,t):this.at(c,t)}},{key:"intersectsSphere",value:function(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}},{key:"distanceToPlane",value:function(e){var t=e.normal.dot(this.direction);if(0===t)return 0===e.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(e.normal)+e.constant)/t;return n>=0?n:null}},{key:"intersectPlane",value:function(e,t){var n=this.distanceToPlane(e);return null===n?null:this.at(n,t)}},{key:"intersectsPlane",value:function(e){var t=e.distanceToPoint(this.origin);return 0===t||e.normal.dot(this.direction)*t<0}},{key:"intersectBox",value:function(e,t){var n,r,o,l,c,h,d=1/this.direction.x,f=1/this.direction.y,m=1/this.direction.z,v=this.origin;return d>=0?(n=(e.min.x-v.x)*d,r=(e.max.x-v.x)*d):(n=(e.max.x-v.x)*d,r=(e.min.x-v.x)*d),f>=0?(o=(e.min.y-v.y)*f,l=(e.max.y-v.y)*f):(o=(e.max.y-v.y)*f,l=(e.min.y-v.y)*f),n>l||o>r?null:((o>n||n!=n)&&(n=o),(l<r||r!=r)&&(r=l),m>=0?(c=(e.min.z-v.z)*m,h=(e.max.z-v.z)*m):(c=(e.max.z-v.z)*m,h=(e.min.z-v.z)*m),n>h||c>r?null:((c>n||n!=n)&&(n=c),(h<r||r!=r)&&(r=h),r<0?null:this.at(n>=0?n:r,t)))}},{key:"intersectsBox",value:function(e){return null!==this.intersectBox(e,it)}},{key:"intersectTriangle",value:function(a,b,e,t,n){lt.subVectors(b,a),ct.subVectors(e,a),ut.crossVectors(lt,ct);var r,o=this.direction.dot(ut);if(o>0){if(t)return null;r=1}else{if(!(o<0))return null;r=-1,o=-o}st.subVectors(this.origin,a);var l=r*this.direction.dot(ct.crossVectors(st,ct));if(l<0)return null;var c=r*this.direction.dot(lt.cross(st));if(c<0)return null;if(l+c>o)return null;var h=-r*st.dot(ut);return h<0?null:this.at(h/o,n)}},{key:"applyMatrix4",value:function(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}},{key:"equals",value:function(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),pt=function(){function e(){Object(x.a)(this,e),this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}return Object(_.a)(e,[{key:"set",value:function(e,t,n,r,o,l,c,h,d,f,m,v,y,x,_,w){var M=this.elements;return M[0]=e,M[4]=t,M[8]=n,M[12]=r,M[1]=o,M[5]=l,M[9]=c,M[13]=h,M[2]=d,M[6]=f,M[10]=m,M[14]=v,M[3]=y,M[7]=x,M[11]=_,M[15]=w,this}},{key:"identity",value:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}},{key:"clone",value:function(){return(new e).fromArray(this.elements)}},{key:"copy",value:function(e){var t=this.elements,n=e.elements;return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],this}},{key:"copyPosition",value:function(e){var t=this.elements,n=e.elements;return t[12]=n[12],t[13]=n[13],t[14]=n[14],this}},{key:"setFromMatrix3",value:function(e){var t=e.elements;return this.set(t[0],t[3],t[6],0,t[1],t[4],t[7],0,t[2],t[5],t[8],0,0,0,0,1),this}},{key:"extractBasis",value:function(e,t,n){return e.setFromMatrixColumn(this,0),t.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}},{key:"makeBasis",value:function(e,t,n){return this.set(e.x,t.x,n.x,0,e.y,t.y,n.y,0,e.z,t.z,n.z,0,0,0,0,1),this}},{key:"extractRotation",value:function(e){var t=this.elements,n=e.elements,r=1/ft.setFromMatrixColumn(e,0).length(),o=1/ft.setFromMatrixColumn(e,1).length(),l=1/ft.setFromMatrixColumn(e,2).length();return t[0]=n[0]*r,t[1]=n[1]*r,t[2]=n[2]*r,t[3]=0,t[4]=n[4]*o,t[5]=n[5]*o,t[6]=n[6]*o,t[7]=0,t[8]=n[8]*l,t[9]=n[9]*l,t[10]=n[10]*l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromEuler",value:function(e){e&&e.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var t=this.elements,n=e.x,r=e.y,o=e.z,a=Math.cos(n),b=Math.sin(n),l=Math.cos(r),c=Math.sin(r),h=Math.cos(o),d=Math.sin(o);if("XYZ"===e.order){var f=a*h,m=a*d,v=b*h,y=b*d;t[0]=l*h,t[4]=-l*d,t[8]=c,t[1]=m+v*c,t[5]=f-y*c,t[9]=-b*l,t[2]=y-f*c,t[6]=v+m*c,t[10]=a*l}else if("YXZ"===e.order){var x=l*h,_=l*d,w=c*h,M=c*d;t[0]=x+M*b,t[4]=w*b-_,t[8]=a*c,t[1]=a*d,t[5]=a*h,t[9]=-b,t[2]=_*b-w,t[6]=M+x*b,t[10]=a*l}else if("ZXY"===e.order){var S=l*h,E=l*d,T=c*h,C=c*d;t[0]=S-C*b,t[4]=-a*d,t[8]=T+E*b,t[1]=E+T*b,t[5]=a*h,t[9]=C-S*b,t[2]=-a*c,t[6]=b,t[10]=a*l}else if("ZYX"===e.order){var L=a*h,A=a*d,R=b*h,k=b*d;t[0]=l*h,t[4]=R*c-A,t[8]=L*c+k,t[1]=l*d,t[5]=k*c+L,t[9]=A*c-R,t[2]=-c,t[6]=b*l,t[10]=a*l}else if("YZX"===e.order){var P=a*l,O=a*c,I=b*l,D=b*c;t[0]=l*h,t[4]=D-P*d,t[8]=I*d+O,t[1]=d,t[5]=a*h,t[9]=-b*h,t[2]=-c*h,t[6]=O*d+I,t[10]=P-D*d}else if("XZY"===e.order){var N=a*l,H=a*c,z=b*l,F=b*c;t[0]=l*h,t[4]=-d,t[8]=c*h,t[1]=N*d+F,t[5]=a*h,t[9]=H*d-z,t[2]=z*d-H,t[6]=b*h,t[10]=F*d+N}return t[3]=0,t[7]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,this}},{key:"makeRotationFromQuaternion",value:function(q){return this.compose(vt,q,gt)}},{key:"lookAt",value:function(e,t,n){var r=this.elements;return bt.subVectors(e,t),0===bt.lengthSq()&&(bt.z=1),bt.normalize(),yt.crossVectors(n,bt),0===yt.lengthSq()&&(1===Math.abs(n.z)?bt.x+=1e-4:bt.z+=1e-4,bt.normalize(),yt.crossVectors(n,bt)),yt.normalize(),xt.crossVectors(bt,yt),r[0]=yt.x,r[4]=xt.x,r[8]=bt.x,r[1]=yt.y,r[5]=xt.y,r[9]=bt.y,r[2]=yt.z,r[6]=xt.z,r[10]=bt.z,this}},{key:"multiply",value:function(e,t){return void 0!==t?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(e,t)):this.multiplyMatrices(this,e)}},{key:"premultiply",value:function(e){return this.multiplyMatrices(e,this)}},{key:"multiplyMatrices",value:function(a,b){var e=a.elements,t=b.elements,n=this.elements,r=e[0],o=e[4],l=e[8],c=e[12],h=e[1],d=e[5],f=e[9],m=e[13],v=e[2],y=e[6],x=e[10],_=e[14],w=e[3],M=e[7],S=e[11],E=e[15],T=t[0],C=t[4],L=t[8],A=t[12],R=t[1],k=t[5],P=t[9],O=t[13],I=t[2],D=t[6],N=t[10],H=t[14],z=t[3],F=t[7],B=t[11],U=t[15];return n[0]=r*T+o*R+l*I+c*z,n[4]=r*C+o*k+l*D+c*F,n[8]=r*L+o*P+l*N+c*B,n[12]=r*A+o*O+l*H+c*U,n[1]=h*T+d*R+f*I+m*z,n[5]=h*C+d*k+f*D+m*F,n[9]=h*L+d*P+f*N+m*B,n[13]=h*A+d*O+f*H+m*U,n[2]=v*T+y*R+x*I+_*z,n[6]=v*C+y*k+x*D+_*F,n[10]=v*L+y*P+x*N+_*B,n[14]=v*A+y*O+x*H+_*U,n[3]=w*T+M*R+S*I+E*z,n[7]=w*C+M*k+S*D+E*F,n[11]=w*L+M*P+S*N+E*B,n[15]=w*A+M*O+S*H+E*U,this}},{key:"multiplyScalar",value:function(s){var e=this.elements;return e[0]*=s,e[4]*=s,e[8]*=s,e[12]*=s,e[1]*=s,e[5]*=s,e[9]*=s,e[13]*=s,e[2]*=s,e[6]*=s,e[10]*=s,e[14]*=s,e[3]*=s,e[7]*=s,e[11]*=s,e[15]*=s,this}},{key:"determinant",value:function(){var e=this.elements,t=e[0],n=e[4],r=e[8],o=e[12],l=e[1],c=e[5],h=e[9],d=e[13],f=e[2],m=e[6],v=e[10],y=e[14];return e[3]*(+o*h*m-r*d*m-o*c*v+n*d*v+r*c*y-n*h*y)+e[7]*(+t*h*y-t*d*v+o*l*v-r*l*y+r*d*f-o*h*f)+e[11]*(+t*d*m-t*c*y-o*l*m+n*l*y+o*c*f-n*d*f)+e[15]*(-r*c*f-t*h*m+t*c*v+r*l*m-n*l*v+n*h*f)}},{key:"transpose",value:function(){var e,t=this.elements;return e=t[1],t[1]=t[4],t[4]=e,e=t[2],t[2]=t[8],t[8]=e,e=t[6],t[6]=t[9],t[9]=e,e=t[3],t[3]=t[12],t[12]=e,e=t[7],t[7]=t[13],t[13]=e,e=t[11],t[11]=t[14],t[14]=e,this}},{key:"setPosition",value:function(e,t,n){var r=this.elements;return e.isVector3?(r[12]=e.x,r[13]=e.y,r[14]=e.z):(r[12]=e,r[13]=t,r[14]=n),this}},{key:"invert",value:function(){var e=this.elements,t=e[0],n=e[1],r=e[2],o=e[3],l=e[4],c=e[5],h=e[6],d=e[7],f=e[8],m=e[9],v=e[10],y=e[11],x=e[12],_=e[13],w=e[14],M=e[15],S=m*w*d-_*v*d+_*h*y-c*w*y-m*h*M+c*v*M,E=x*v*d-f*w*d-x*h*y+l*w*y+f*h*M-l*v*M,T=f*_*d-x*m*d+x*c*y-l*_*y-f*c*M+l*m*M,C=x*m*h-f*_*h-x*c*v+l*_*v+f*c*w-l*m*w,L=t*S+n*E+r*T+o*C;if(0===L)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);var A=1/L;return e[0]=S*A,e[1]=(_*v*o-m*w*o-_*r*y+n*w*y+m*r*M-n*v*M)*A,e[2]=(c*w*o-_*h*o+_*r*d-n*w*d-c*r*M+n*h*M)*A,e[3]=(m*h*o-c*v*o-m*r*d+n*v*d+c*r*y-n*h*y)*A,e[4]=E*A,e[5]=(f*w*o-x*v*o+x*r*y-t*w*y-f*r*M+t*v*M)*A,e[6]=(x*h*o-l*w*o-x*r*d+t*w*d+l*r*M-t*h*M)*A,e[7]=(l*v*o-f*h*o+f*r*d-t*v*d-l*r*y+t*h*y)*A,e[8]=T*A,e[9]=(x*m*o-f*_*o-x*n*y+t*_*y+f*n*M-t*m*M)*A,e[10]=(l*_*o-x*c*o+x*n*d-t*_*d-l*n*M+t*c*M)*A,e[11]=(f*c*o-l*m*o-f*n*d+t*m*d+l*n*y-t*c*y)*A,e[12]=C*A,e[13]=(f*_*r-x*m*r+x*n*v-t*_*v-f*n*w+t*m*w)*A,e[14]=(x*c*r-l*_*r-x*n*h+t*_*h+l*n*w-t*c*w)*A,e[15]=(l*m*r-f*c*r+f*n*h-t*m*h-l*n*v+t*c*v)*A,this}},{key:"scale",value:function(e){var t=this.elements,n=e.x,r=e.y,o=e.z;return t[0]*=n,t[4]*=r,t[8]*=o,t[1]*=n,t[5]*=r,t[9]*=o,t[2]*=n,t[6]*=r,t[10]*=o,t[3]*=n,t[7]*=r,t[11]*=o,this}},{key:"getMaxScaleOnAxis",value:function(){var e=this.elements,t=e[0]*e[0]+e[1]*e[1]+e[2]*e[2],n=e[4]*e[4]+e[5]*e[5]+e[6]*e[6],r=e[8]*e[8]+e[9]*e[9]+e[10]*e[10];return Math.sqrt(Math.max(t,n,r))}},{key:"makeTranslation",value:function(e,t,n){return this.set(1,0,0,e,0,1,0,t,0,0,1,n,0,0,0,1),this}},{key:"makeRotationX",value:function(e){var t=Math.cos(e),s=Math.sin(e);return this.set(1,0,0,0,0,t,-s,0,0,s,t,0,0,0,0,1),this}},{key:"makeRotationY",value:function(e){var t=Math.cos(e),s=Math.sin(e);return this.set(t,0,s,0,0,1,0,0,-s,0,t,0,0,0,0,1),this}},{key:"makeRotationZ",value:function(e){var t=Math.cos(e),s=Math.sin(e);return this.set(t,-s,0,0,s,t,0,0,0,0,1,0,0,0,0,1),this}},{key:"makeRotationAxis",value:function(e,t){var n=Math.cos(t),s=Math.sin(t),r=1-n,o=e.x,l=e.y,c=e.z,h=r*o,d=r*l;return this.set(h*o+n,h*l-s*c,h*c+s*l,0,h*l+s*c,d*l+n,d*c-s*o,0,h*c-s*l,d*c+s*o,r*c*c+n,0,0,0,0,1),this}},{key:"makeScale",value:function(e,t,n){return this.set(e,0,0,0,0,t,0,0,0,0,n,0,0,0,0,1),this}},{key:"makeShear",value:function(e,t,n){return this.set(1,t,n,0,e,1,n,0,e,t,1,0,0,0,0,1),this}},{key:"compose",value:function(e,t,n){var r=this.elements,o=t._x,l=t._y,c=t._z,h=t._w,d=o+o,f=l+l,m=c+c,v=o*d,y=o*f,x=o*m,_=l*f,w=l*m,M=c*m,S=h*d,E=h*f,T=h*m,C=n.x,L=n.y,A=n.z;return r[0]=(1-(_+M))*C,r[1]=(y+T)*C,r[2]=(x-E)*C,r[3]=0,r[4]=(y-T)*L,r[5]=(1-(v+M))*L,r[6]=(w+S)*L,r[7]=0,r[8]=(x+E)*A,r[9]=(w-S)*A,r[10]=(1-(v+_))*A,r[11]=0,r[12]=e.x,r[13]=e.y,r[14]=e.z,r[15]=1,this}},{key:"decompose",value:function(e,t,n){var r=this.elements,o=ft.set(r[0],r[1],r[2]).length(),l=ft.set(r[4],r[5],r[6]).length(),c=ft.set(r[8],r[9],r[10]).length();this.determinant()<0&&(o=-o),e.x=r[12],e.y=r[13],e.z=r[14],mt.copy(this);var h=1/o,d=1/l,f=1/c;return mt.elements[0]*=h,mt.elements[1]*=h,mt.elements[2]*=h,mt.elements[4]*=d,mt.elements[5]*=d,mt.elements[6]*=d,mt.elements[8]*=f,mt.elements[9]*=f,mt.elements[10]*=f,t.setFromRotationMatrix(mt),n.x=o,n.y=l,n.z=c,this}},{key:"makePerspective",value:function(e,t,n,r,o,l){void 0===l&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var c=this.elements,h=2*o/(t-e),d=2*o/(n-r),a=(t+e)/(t-e),b=(n+r)/(n-r),f=-(l+o)/(l-o),m=-2*l*o/(l-o);return c[0]=h,c[4]=0,c[8]=a,c[12]=0,c[1]=0,c[5]=d,c[9]=b,c[13]=0,c[2]=0,c[6]=0,c[10]=f,c[14]=m,c[3]=0,c[7]=0,c[11]=-1,c[15]=0,this}},{key:"makeOrthographic",value:function(e,t,n,r,o,l){var c=this.elements,h=1/(t-e),d=1/(n-r),p=1/(l-o),f=(t+e)*h,m=(n+r)*d,v=(l+o)*p;return c[0]=2*h,c[4]=0,c[8]=0,c[12]=-f,c[1]=0,c[5]=2*d,c[9]=0,c[13]=-m,c[2]=0,c[6]=0,c[10]=-2*p,c[14]=-v,c[3]=0,c[7]=0,c[11]=0,c[15]=1,this}},{key:"equals",value:function(e){for(var t=this.elements,n=e.elements,r=0;r<16;r++)if(t[r]!==n[r])return!1;return!0}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=0;n<16;n++)this.elements[n]=e[n+t];return this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return e[t]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=n[3],e[t+4]=n[4],e[t+5]=n[5],e[t+6]=n[6],e[t+7]=n[7],e[t+8]=n[8],e[t+9]=n[9],e[t+10]=n[10],e[t+11]=n[11],e[t+12]=n[12],e[t+13]=n[13],e[t+14]=n[14],e[t+15]=n[15],e}}]),e}();pt.prototype.isMatrix4=!0;var ft=new Ie,mt=new pt,vt=new Ie(0,0,0),gt=new Ie(1,1,1),yt=new Ie,xt=new Ie,bt=new Ie,_t=new pt,wt=new Oe,Mt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.DefaultOrder;Object(x.a)(this,e),this._x=t,this._y=n,this._z=r,this._order=o}return Object(_.a)(e,[{key:"x",get:function(){return this._x},set:function(e){this._x=e,this._onChangeCallback()}},{key:"y",get:function(){return this._y},set:function(e){this._y=e,this._onChangeCallback()}},{key:"z",get:function(){return this._z},set:function(e){this._z=e,this._onChangeCallback()}},{key:"order",get:function(){return this._order},set:function(e){this._order=e,this._onChangeCallback()}},{key:"set",value:function(e,t,n,r){return this._x=e,this._y=t,this._z=n,this._order=r||this._order,this._onChangeCallback(),this}},{key:"clone",value:function(){return new this.constructor(this._x,this._y,this._z,this._order)}},{key:"copy",value:function(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}},{key:"setFromRotationMatrix",value:function(e,t,n){var r=Me.clamp,o=e.elements,l=o[0],c=o[4],h=o[8],d=o[1],f=o[5],m=o[9],v=o[2],y=o[6],x=o[10];switch(t=t||this._order){case"XYZ":this._y=Math.asin(r(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-m,x),this._z=Math.atan2(-c,l)):(this._x=Math.atan2(y,f),this._z=0);break;case"YXZ":this._x=Math.asin(-r(m,-1,1)),Math.abs(m)<.9999999?(this._y=Math.atan2(h,x),this._z=Math.atan2(d,f)):(this._y=Math.atan2(-v,l),this._z=0);break;case"ZXY":this._x=Math.asin(r(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-v,x),this._z=Math.atan2(-c,f)):(this._y=0,this._z=Math.atan2(d,l));break;case"ZYX":this._y=Math.asin(-r(v,-1,1)),Math.abs(v)<.9999999?(this._x=Math.atan2(y,x),this._z=Math.atan2(d,l)):(this._x=0,this._z=Math.atan2(-c,f));break;case"YZX":this._z=Math.asin(r(d,-1,1)),Math.abs(d)<.9999999?(this._x=Math.atan2(-m,f),this._y=Math.atan2(-v,l)):(this._x=0,this._y=Math.atan2(h,x));break;case"XZY":this._z=Math.asin(-r(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,f),this._y=Math.atan2(h,l)):(this._x=Math.atan2(-m,x),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+t)}return this._order=t,!1!==n&&this._onChangeCallback(),this}},{key:"setFromQuaternion",value:function(q,e,t){return _t.makeRotationFromQuaternion(q),this.setFromRotationMatrix(_t,e,t)}},{key:"setFromVector3",value:function(e,t){return this.set(e.x,e.y,e.z,t||this._order)}},{key:"reorder",value:function(e){return wt.setFromEuler(this),this.setFromQuaternion(wt,e)}},{key:"equals",value:function(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}},{key:"fromArray",value:function(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this._x,e[t+1]=this._y,e[t+2]=this._z,e[t+3]=this._order,e}},{key:"toVector3",value:function(e){return e?e.set(this._x,this._y,this._z):new Ie(this._x,this._y,this._z)}},{key:"_onChange",value:function(e){return this._onChangeCallback=e,this}},{key:"_onChangeCallback",value:function(){}}]),e}();Mt.prototype.isEuler=!0,Mt.DefaultOrder="XYZ",Mt.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];var St=function(){function e(){Object(x.a)(this,e),this.mask=1}return Object(_.a)(e,[{key:"set",value:function(e){this.mask=1<<e|0}},{key:"enable",value:function(e){this.mask|=1<<e|0}},{key:"enableAll",value:function(){this.mask=-1}},{key:"toggle",value:function(e){this.mask^=1<<e|0}},{key:"disable",value:function(e){this.mask&=~(1<<e|0)}},{key:"disableAll",value:function(){this.mask=0}},{key:"test",value:function(e){return 0!=(this.mask&e.mask)}}]),e}(),Et=0,Tt=new Ie,Ct=new Oe,Lt=new pt,At=new Ie,Rt=new Ie,kt=new Ie,Pt=new Oe,Ot=new Ie(1,0,0),It=new Ie(0,1,0),Dt=new Ie(0,0,1),Nt={type:"added"},Ht={type:"removed"};function zt(){Object.defineProperty(this,"id",{value:Et++}),this.uuid=Me.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=zt.DefaultUp.clone();var e=new Ie,t=new Mt,n=new Oe,r=new Ie(1,1,1);t._onChange((function(){n.setFromEuler(t,!1)})),n._onChange((function(){t.setFromQuaternion(n,void 0,!1)})),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:e},rotation:{configurable:!0,enumerable:!0,value:t},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:r},modelViewMatrix:{value:new pt},normalMatrix:{value:new Te}}),this.matrix=new pt,this.matrixWorld=new pt,this.matrixAutoUpdate=zt.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new St,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}zt.DefaultUp=new Ie(0,1,0),zt.DefaultMatrixAutoUpdate=!0,zt.prototype=Object.assign(Object.create(xe.prototype),{constructor:zt,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix4:function(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(q){return this.quaternion.premultiply(q),this},setRotationFromAxisAngle:function(e,t){this.quaternion.setFromAxisAngle(e,t)},setRotationFromEuler:function(e){this.quaternion.setFromEuler(e,!0)},setRotationFromMatrix:function(e){this.quaternion.setFromRotationMatrix(e)},setRotationFromQuaternion:function(q){this.quaternion.copy(q)},rotateOnAxis:function(e,t){return Ct.setFromAxisAngle(e,t),this.quaternion.multiply(Ct),this},rotateOnWorldAxis:function(e,t){return Ct.setFromAxisAngle(e,t),this.quaternion.premultiply(Ct),this},rotateX:function(e){return this.rotateOnAxis(Ot,e)},rotateY:function(e){return this.rotateOnAxis(It,e)},rotateZ:function(e){return this.rotateOnAxis(Dt,e)},translateOnAxis:function(e,t){return Tt.copy(e).applyQuaternion(this.quaternion),this.position.add(Tt.multiplyScalar(t)),this},translateX:function(e){return this.translateOnAxis(Ot,e)},translateY:function(e){return this.translateOnAxis(It,e)},translateZ:function(e){return this.translateOnAxis(Dt,e)},localToWorld:function(e){return e.applyMatrix4(this.matrixWorld)},worldToLocal:function(e){return e.applyMatrix4(Lt.copy(this.matrixWorld).invert())},lookAt:function(e,t,n){e.isVector3?At.copy(e):At.set(e,t,n);var r=this.parent;this.updateWorldMatrix(!0,!1),Rt.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Lt.lookAt(Rt,At,this.up):Lt.lookAt(At,Rt,this.up),this.quaternion.setFromRotationMatrix(Lt),r&&(Lt.extractRotation(r.matrixWorld),Ct.setFromRotationMatrix(Lt),this.quaternion.premultiply(Ct.invert()))},add:function(object){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return object===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",object),this):(object&&object.isObject3D?(null!==object.parent&&object.parent.remove(object),object.parent=this,this.children.push(object),object.dispatchEvent(Nt)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",object),this)},remove:function(object){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var t=this.children.indexOf(object);return-1!==t&&(object.parent=null,this.children.splice(t,1),object.dispatchEvent(Ht)),this},clear:function(){for(var e=0;e<this.children.length;e++){var object=this.children[e];object.parent=null,object.dispatchEvent(Ht)}return this.children.length=0,this},attach:function(object){return this.updateWorldMatrix(!0,!1),Lt.copy(this.matrixWorld).invert(),null!==object.parent&&(object.parent.updateWorldMatrix(!0,!1),Lt.multiply(object.parent.matrixWorld)),object.applyMatrix4(Lt),this.add(object),object.updateWorldMatrix(!1,!0),this},getObjectById:function(e){return this.getObjectByProperty("id",e)},getObjectByName:function(e){return this.getObjectByProperty("name",e)},getObjectByProperty:function(e,t){if(this[e]===t)return this;for(var n=0,r=this.children.length;n<r;n++){var object=this.children[n].getObjectByProperty(e,t);if(void 0!==object)return object}},getWorldPosition:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),e=new Ie),this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),e=new Oe),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rt,e,kt),e},getWorldScale:function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),e=new Ie),this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Rt,Pt,e),e},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new Ie),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(t[8],t[9],t[10]).normalize()},raycast:function(){},traverse:function(e){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverse(e)},traverseVisible:function(e){if(!1!==this.visible){e(this);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].traverseVisible(e)}},traverseAncestors:function(e){var t=this.parent;null!==t&&(e(t),t.traverseAncestors(e))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,e=!0);for(var t=this.children,n=0,r=t.length;n<r;n++)t[n].updateMatrixWorld(e)},updateWorldMatrix:function(e,t){var n=this.parent;if(!0===e&&null!==n&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),!0===t)for(var r=this.children,o=0,l=r.length;o<l;o++)r[o].updateWorldMatrix(!1,!0)},toJSON:function(meta){var e=void 0===meta||"string"==typeof meta,output={};e&&(meta={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},output.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var object={};function t(e,element){return void 0===e[element.uuid]&&(e[element.uuid]=element.toJSON(meta)),element.uuid}if(object.uuid=this.uuid,object.type=this.type,""!==this.name&&(object.name=this.name),!0===this.castShadow&&(object.castShadow=!0),!0===this.receiveShadow&&(object.receiveShadow=!0),!1===this.visible&&(object.visible=!1),!1===this.frustumCulled&&(object.frustumCulled=!1),0!==this.renderOrder&&(object.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(object.userData=this.userData),object.layers=this.layers.mask,object.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(object.matrixAutoUpdate=!1),this.isInstancedMesh&&(object.type="InstancedMesh",object.count=this.count,object.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(object.instanceColor=this.instanceColor.toJSON())),this.isMesh||this.isLine||this.isPoints){object.geometry=t(meta.geometries,this.geometry);var n=this.geometry.parameters;if(void 0!==n&&void 0!==n.shapes){var r=n.shapes;if(Array.isArray(r))for(var o=0,l=r.length;o<l;o++){var c=r[o];t(meta.shapes,c)}else t(meta.shapes,r)}}if(this.isSkinnedMesh&&(object.bindMode=this.bindMode,object.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(t(meta.skeletons,this.skeleton),object.skeleton=this.skeleton.uuid)),void 0!==this.material)if(Array.isArray(this.material)){for(var h=[],d=0,f=this.material.length;d<f;d++)h.push(t(meta.materials,this.material[d]));object.material=h}else object.material=t(meta.materials,this.material);if(this.children.length>0){object.children=[];for(var m=0;m<this.children.length;m++)object.children.push(this.children[m].toJSON(meta).object)}if(this.animations.length>0){object.animations=[];for(var v=0;v<this.animations.length;v++){var y=this.animations[v];object.animations.push(t(meta.animations,y))}}if(e){var x=C(meta.geometries),_=C(meta.materials),w=C(meta.textures),M=C(meta.images),S=C(meta.shapes),E=C(meta.skeletons),T=C(meta.animations);x.length>0&&(output.geometries=x),_.length>0&&(output.materials=_),w.length>0&&(output.textures=w),M.length>0&&(output.images=M),S.length>0&&(output.shapes=S),E.length>0&&(output.skeletons=E),T.length>0&&(output.animations=T)}return output.object=object,output;function C(e){var t=[];for(var n in e){var data=e[n];delete data.metadata,t.push(data)}return t}},clone:function(e){return(new this.constructor).copy(this,e)},copy:function(source){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.name=source.name,this.up.copy(source.up),this.position.copy(source.position),this.rotation.order=source.rotation.order,this.quaternion.copy(source.quaternion),this.scale.copy(source.scale),this.matrix.copy(source.matrix),this.matrixWorld.copy(source.matrixWorld),this.matrixAutoUpdate=source.matrixAutoUpdate,this.matrixWorldNeedsUpdate=source.matrixWorldNeedsUpdate,this.layers.mask=source.layers.mask,this.visible=source.visible,this.castShadow=source.castShadow,this.receiveShadow=source.receiveShadow,this.frustumCulled=source.frustumCulled,this.renderOrder=source.renderOrder,this.userData=JSON.parse(JSON.stringify(source.userData)),!0===e)for(var t=0;t<source.children.length;t++){var n=source.children[t];this.add(n.clone())}return this}});var Ft=new Ie,Bt=new Ie,Ut=new Te,jt=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie(1,0,0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;Object(x.a)(this,e),this.normal=t,this.constant=n}return Object(_.a)(e,[{key:"set",value:function(e,t){return this.normal.copy(e),this.constant=t,this}},{key:"setComponents",value:function(e,t,n,r){return this.normal.set(e,t,n),this.constant=r,this}},{key:"setFromNormalAndCoplanarPoint",value:function(e,t){return this.normal.copy(e),this.constant=-t.dot(this.normal),this}},{key:"setFromCoplanarPoints",value:function(a,b,e){var t=Ft.subVectors(e,b).cross(Bt.subVectors(a,b)).normalize();return this.setFromNormalAndCoplanarPoint(t,a),this}},{key:"copy",value:function(e){return this.normal.copy(e.normal),this.constant=e.constant,this}},{key:"normalize",value:function(){var e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}},{key:"negate",value:function(){return this.constant*=-1,this.normal.negate(),this}},{key:"distanceToPoint",value:function(e){return this.normal.dot(e)+this.constant}},{key:"distanceToSphere",value:function(e){return this.distanceToPoint(e.center)-e.radius}},{key:"projectPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Plane: .projectPoint() target is now required"),t=new Ie),t.copy(this.normal).multiplyScalar(-this.distanceToPoint(e)).add(e)}},{key:"intersectLine",value:function(line,e){void 0===e&&(console.warn("THREE.Plane: .intersectLine() target is now required"),e=new Ie);var t=line.delta(Ft),n=this.normal.dot(t);if(0===n)return 0===this.distanceToPoint(line.start)?e.copy(line.start):null;var r=-(line.start.dot(this.normal)+this.constant)/n;return r<0||r>1?null:e.copy(t).multiplyScalar(r).add(line.start)}},{key:"intersectsLine",value:function(line){var e=this.distanceToPoint(line.start),t=this.distanceToPoint(line.end);return e<0&&t>0||t<0&&e>0}},{key:"intersectsBox",value:function(e){return e.intersectsPlane(this)}},{key:"intersectsSphere",value:function(e){return e.intersectsPlane(this)}},{key:"coplanarPoint",value:function(e){return void 0===e&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),e=new Ie),e.copy(this.normal).multiplyScalar(-this.constant)}},{key:"applyMatrix4",value:function(e,t){var n=t||Ut.getNormalMatrix(e),r=this.coplanarPoint(Ft).applyMatrix4(e),o=this.normal.applyMatrix3(n).normalize();return this.constant=-r.dot(o),this}},{key:"translate",value:function(e){return this.constant-=e.dot(this.normal),this}},{key:"equals",value:function(e){return e.normal.equals(this.normal)&&e.constant===this.constant}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();jt.prototype.isPlane=!0;var Gt=new Ie,Vt=new Ie,Wt=new Ie,qt=new Ie,Xt=new Ie,Yt=new Ie,Zt=new Ie,Jt=new Ie,$t=new Ie,Kt=new Ie,Qt=function(){function e(){var a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,b=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ie;Object(x.a)(this,e),this.a=a,this.b=b,this.c=t}return Object(_.a)(e,[{key:"set",value:function(a,b,e){return this.a.copy(a),this.b.copy(b),this.c.copy(e),this}},{key:"setFromPointsAndIndices",value:function(e,t,n,r){return this.a.copy(e[t]),this.b.copy(e[n]),this.c.copy(e[r]),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}},{key:"getArea",value:function(){return Gt.subVectors(this.c,this.b),Vt.subVectors(this.a,this.b),.5*Gt.cross(Vt).length()}},{key:"getMidpoint",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),e=new Ie),e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}},{key:"getNormal",value:function(t){return e.getNormal(this.a,this.b,this.c,t)}},{key:"getPlane",value:function(e){return void 0===e&&(console.warn("THREE.Triangle: .getPlane() target is now required"),e=new jt),e.setFromCoplanarPoints(this.a,this.b,this.c)}},{key:"getBarycoord",value:function(t,n){return e.getBarycoord(t,this.a,this.b,this.c,n)}},{key:"getUV",value:function(t,n,r,o,l){return e.getUV(t,this.a,this.b,this.c,n,r,o,l)}},{key:"containsPoint",value:function(t){return e.containsPoint(t,this.a,this.b,this.c)}},{key:"isFrontFacing",value:function(t){return e.isFrontFacing(this.a,this.b,this.c,t)}},{key:"intersectsBox",value:function(e){return e.intersectsTriangle(this)}},{key:"closestPointToPoint",value:function(p,e){void 0===e&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),e=new Ie);var t,n,a=this.a,b=this.b,r=this.c;Xt.subVectors(b,a),Yt.subVectors(r,a),Jt.subVectors(p,a);var o=Xt.dot(Jt),l=Yt.dot(Jt);if(o<=0&&l<=0)return e.copy(a);$t.subVectors(p,b);var c=Xt.dot($t),h=Yt.dot($t);if(c>=0&&h<=c)return e.copy(b);var d=o*h-c*l;if(d<=0&&o>=0&&c<=0)return t=o/(o-c),e.copy(a).addScaledVector(Xt,t);Kt.subVectors(p,r);var f=Xt.dot(Kt),m=Yt.dot(Kt);if(m>=0&&f<=m)return e.copy(r);var v=f*l-o*m;if(v<=0&&l>=0&&m<=0)return n=l/(l-m),e.copy(a).addScaledVector(Yt,n);var y=c*m-f*h;if(y<=0&&h-c>=0&&f-m>=0)return Zt.subVectors(r,b),n=(h-c)/(h-c+(f-m)),e.copy(b).addScaledVector(Zt,n);var x=1/(y+v+d);return t=v*x,n=d*x,e.copy(a).addScaledVector(Xt,t).addScaledVector(Yt,n)}},{key:"equals",value:function(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}}],[{key:"getNormal",value:function(a,b,e,t){void 0===t&&(console.warn("THREE.Triangle: .getNormal() target is now required"),t=new Ie),t.subVectors(e,b),Gt.subVectors(a,b),t.cross(Gt);var n=t.lengthSq();return n>0?t.multiplyScalar(1/Math.sqrt(n)):t.set(0,0,0)}},{key:"getBarycoord",value:function(e,a,b,t,n){Gt.subVectors(t,a),Vt.subVectors(b,a),Wt.subVectors(e,a);var r=Gt.dot(Gt),o=Gt.dot(Vt),l=Gt.dot(Wt),c=Vt.dot(Vt),h=Vt.dot(Wt),d=r*c-o*o;if(void 0===n&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),n=new Ie),0===d)return n.set(-2,-1,-1);var f=1/d,u=(c*l-o*h)*f,m=(r*h-o*l)*f;return n.set(1-u-m,m,u)}},{key:"containsPoint",value:function(e,a,b,t){return this.getBarycoord(e,a,b,t,qt),qt.x>=0&&qt.y>=0&&qt.x+qt.y<=1}},{key:"getUV",value:function(e,t,n,r,o,l,c,h){return this.getBarycoord(e,t,n,r,qt),h.set(0,0),h.addScaledVector(o,qt.x),h.addScaledVector(l,qt.y),h.addScaledVector(c,qt.z),h}},{key:"isFrontFacing",value:function(a,b,e,t){return Gt.subVectors(e,b),Vt.subVectors(a,b),Gt.cross(Vt).dot(t)<0}}]),e}(),en=0;function tn(){Object.defineProperty(this,"id",{value:en++}),this.uuid=Me.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=P,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=me,this.stencilZFail=me,this.stencilZPass=me,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0}tn.prototype=Object.assign(Object.create(xe.prototype),{constructor:tn,isMaterial:!0,onBeforeCompile:function(){},customProgramCacheKey:function(){return this.onBeforeCompile.toString()},setValues:function(e){if(void 0!==e)for(var t in e){var n=e[t];if(void 0!==n)if("shading"!==t){var r=this[t];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[t]=n:console.warn("THREE."+this.type+": '"+t+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===n;else console.warn("THREE.Material: '"+t+"' parameter is undefined.")}},toJSON:function(meta){var e=void 0===meta||"string"==typeof meta;e&&(meta={textures:{},images:{}});var data={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};function t(e){var t=[];for(var n in e){var r=e[n];delete r.metadata,t.push(r)}return t}if(data.uuid=this.uuid,data.type=this.type,""!==this.name&&(data.name=this.name),this.color&&this.color.isColor&&(data.color=this.color.getHex()),void 0!==this.roughness&&(data.roughness=this.roughness),void 0!==this.metalness&&(data.metalness=this.metalness),this.sheen&&this.sheen.isColor&&(data.sheen=this.sheen.getHex()),this.emissive&&this.emissive.isColor&&(data.emissive=this.emissive.getHex()),this.emissiveIntensity&&1!==this.emissiveIntensity&&(data.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(data.specular=this.specular.getHex()),void 0!==this.shininess&&(data.shininess=this.shininess),void 0!==this.clearcoat&&(data.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(data.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(data.clearcoatMap=this.clearcoatMap.toJSON(meta).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(data.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(meta).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(data.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(meta).uuid,data.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(data.map=this.map.toJSON(meta).uuid),this.matcap&&this.matcap.isTexture&&(data.matcap=this.matcap.toJSON(meta).uuid),this.alphaMap&&this.alphaMap.isTexture&&(data.alphaMap=this.alphaMap.toJSON(meta).uuid),this.lightMap&&this.lightMap.isTexture&&(data.lightMap=this.lightMap.toJSON(meta).uuid,data.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(data.aoMap=this.aoMap.toJSON(meta).uuid,data.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(data.bumpMap=this.bumpMap.toJSON(meta).uuid,data.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(data.normalMap=this.normalMap.toJSON(meta).uuid,data.normalMapType=this.normalMapType,data.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(data.displacementMap=this.displacementMap.toJSON(meta).uuid,data.displacementScale=this.displacementScale,data.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(data.roughnessMap=this.roughnessMap.toJSON(meta).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(data.metalnessMap=this.metalnessMap.toJSON(meta).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(data.emissiveMap=this.emissiveMap.toJSON(meta).uuid),this.specularMap&&this.specularMap.isTexture&&(data.specularMap=this.specularMap.toJSON(meta).uuid),this.envMap&&this.envMap.isTexture&&(data.envMap=this.envMap.toJSON(meta).uuid,data.reflectivity=this.reflectivity,data.refractionRatio=this.refractionRatio,void 0!==this.combine&&(data.combine=this.combine),void 0!==this.envMapIntensity&&(data.envMapIntensity=this.envMapIntensity)),this.gradientMap&&this.gradientMap.isTexture&&(data.gradientMap=this.gradientMap.toJSON(meta).uuid),void 0!==this.size&&(data.size=this.size),null!==this.shadowSide&&(data.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(data.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(data.blending=this.blending),0!==this.side&&(data.side=this.side),this.vertexColors&&(data.vertexColors=!0),this.opacity<1&&(data.opacity=this.opacity),!0===this.transparent&&(data.transparent=this.transparent),data.depthFunc=this.depthFunc,data.depthTest=this.depthTest,data.depthWrite=this.depthWrite,data.colorWrite=this.colorWrite,data.stencilWrite=this.stencilWrite,data.stencilWriteMask=this.stencilWriteMask,data.stencilFunc=this.stencilFunc,data.stencilRef=this.stencilRef,data.stencilFuncMask=this.stencilFuncMask,data.stencilFail=this.stencilFail,data.stencilZFail=this.stencilZFail,data.stencilZPass=this.stencilZPass,this.rotation&&0!==this.rotation&&(data.rotation=this.rotation),!0===this.polygonOffset&&(data.polygonOffset=!0),0!==this.polygonOffsetFactor&&(data.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(data.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&1!==this.linewidth&&(data.linewidth=this.linewidth),void 0!==this.dashSize&&(data.dashSize=this.dashSize),void 0!==this.gapSize&&(data.gapSize=this.gapSize),void 0!==this.scale&&(data.scale=this.scale),!0===this.dithering&&(data.dithering=!0),this.alphaTest>0&&(data.alphaTest=this.alphaTest),!0===this.alphaToCoverage&&(data.alphaToCoverage=this.alphaToCoverage),!0===this.premultipliedAlpha&&(data.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(data.wireframe=this.wireframe),this.wireframeLinewidth>1&&(data.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(data.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(data.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(data.morphTargets=!0),!0===this.morphNormals&&(data.morphNormals=!0),!0===this.skinning&&(data.skinning=!0),!0===this.flatShading&&(data.flatShading=this.flatShading),!1===this.visible&&(data.visible=!1),!1===this.toneMapped&&(data.toneMapped=!1),"{}"!==JSON.stringify(this.userData)&&(data.userData=this.userData),e){var n=t(meta.textures),r=t(meta.images);n.length>0&&(data.textures=n),r.length>0&&(data.images=r)}return data},clone:function(){return(new this.constructor).copy(this)},copy:function(source){this.name=source.name,this.fog=source.fog,this.blending=source.blending,this.side=source.side,this.vertexColors=source.vertexColors,this.opacity=source.opacity,this.transparent=source.transparent,this.blendSrc=source.blendSrc,this.blendDst=source.blendDst,this.blendEquation=source.blendEquation,this.blendSrcAlpha=source.blendSrcAlpha,this.blendDstAlpha=source.blendDstAlpha,this.blendEquationAlpha=source.blendEquationAlpha,this.depthFunc=source.depthFunc,this.depthTest=source.depthTest,this.depthWrite=source.depthWrite,this.stencilWriteMask=source.stencilWriteMask,this.stencilFunc=source.stencilFunc,this.stencilRef=source.stencilRef,this.stencilFuncMask=source.stencilFuncMask,this.stencilFail=source.stencilFail,this.stencilZFail=source.stencilZFail,this.stencilZPass=source.stencilZPass,this.stencilWrite=source.stencilWrite;var e=source.clippingPlanes,t=null;if(null!==e){var n=e.length;t=new Array(n);for(var r=0;r!==n;++r)t[r]=e[r].clone()}return this.clippingPlanes=t,this.clipIntersection=source.clipIntersection,this.clipShadows=source.clipShadows,this.shadowSide=source.shadowSide,this.colorWrite=source.colorWrite,this.precision=source.precision,this.polygonOffset=source.polygonOffset,this.polygonOffsetFactor=source.polygonOffsetFactor,this.polygonOffsetUnits=source.polygonOffsetUnits,this.dithering=source.dithering,this.alphaTest=source.alphaTest,this.alphaToCoverage=source.alphaToCoverage,this.premultipliedAlpha=source.premultipliedAlpha,this.visible=source.visible,this.toneMapped=source.toneMapped,this.userData=JSON.parse(JSON.stringify(source.userData)),this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(tn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}});var nn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},rn={h:0,s:0,l:0},an={h:0,s:0,l:0};function on(p,q,e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?p+6*(q-p)*e:e<.5?q:e<2/3?p+6*(q-p)*(2/3-e):p}function sn(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function ln(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var cn=function(){function e(t,g,b){return Object(x.a)(this,e),void 0===g&&void 0===b?this.set(t):this.setRGB(t,g,b)}return Object(_.a)(e,[{key:"set",value:function(e){return e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e),this}},{key:"setScalar",value:function(e){return this.r=e,this.g=e,this.b=e,this}},{key:"setHex",value:function(e){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,this}},{key:"setRGB",value:function(e,g,b){return this.r=e,this.g=g,this.b=b,this}},{key:"setHSL",value:function(e,s,t){if(e=Me.euclideanModulo(e,1),s=Me.clamp(s,0,1),t=Me.clamp(t,0,1),0===s)this.r=this.g=this.b=t;else{var p=t<=.5?t*(1+s):t+s-t*s,q=2*t-p;this.r=on(q,p,e+1/3),this.g=on(q,p,e),this.b=on(q,p,e-1/3)}return this}},{key:"setStyle",value:function(style){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+style+" will be ignored.")}var t;if(t=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(style)){var n,r=t[1],o=t[2];switch(r){case"rgb":case"rgba":if(n=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(n[1],10))/255,this.g=Math.min(255,parseInt(n[2],10))/255,this.b=Math.min(255,parseInt(n[3],10))/255,e(n[4]),this;if(n=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(n[1],10))/100,this.g=Math.min(100,parseInt(n[2],10))/100,this.b=Math.min(100,parseInt(n[3],10))/100,e(n[4]),this;break;case"hsl":case"hsla":if(n=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o)){var l=parseFloat(n[1])/360,s=parseInt(n[2],10)/100,c=parseInt(n[3],10)/100;return e(n[4]),this.setHSL(l,s,c)}}}else if(t=/^\#([A-Fa-f\d]+)$/.exec(style)){var h=t[1],d=h.length;if(3===d)return this.r=parseInt(h.charAt(0)+h.charAt(0),16)/255,this.g=parseInt(h.charAt(1)+h.charAt(1),16)/255,this.b=parseInt(h.charAt(2)+h.charAt(2),16)/255,this;if(6===d)return this.r=parseInt(h.charAt(0)+h.charAt(1),16)/255,this.g=parseInt(h.charAt(2)+h.charAt(3),16)/255,this.b=parseInt(h.charAt(4)+h.charAt(5),16)/255,this}return style&&style.length>0?this.setColorName(style):this}},{key:"setColorName",value:function(style){var e=nn[style];return void 0!==e?this.setHex(e):console.warn("THREE.Color: Unknown color "+style),this}},{key:"clone",value:function(){return new this.constructor(this.r,this.g,this.b)}},{key:"copy",value:function(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}},{key:"copyGammaToLinear",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return this.r=Math.pow(e.r,t),this.g=Math.pow(e.g,t),this.b=Math.pow(e.b,t),this}},{key:"copyLinearToGamma",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2,n=t>0?1/t:1;return this.r=Math.pow(e.r,n),this.g=Math.pow(e.g,n),this.b=Math.pow(e.b,n),this}},{key:"convertGammaToLinear",value:function(e){return this.copyGammaToLinear(this,e),this}},{key:"convertLinearToGamma",value:function(e){return this.copyLinearToGamma(this,e),this}},{key:"copySRGBToLinear",value:function(e){return this.r=sn(e.r),this.g=sn(e.g),this.b=sn(e.b),this}},{key:"copyLinearToSRGB",value:function(e){return this.r=ln(e.r),this.g=ln(e.g),this.b=ln(e.b),this}},{key:"convertSRGBToLinear",value:function(){return this.copySRGBToLinear(this),this}},{key:"convertLinearToSRGB",value:function(){return this.copyLinearToSRGB(this),this}},{key:"getHex",value:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0}},{key:"getHexString",value:function(){return("000000"+this.getHex().toString(16)).slice(-6)}},{key:"getHSL",value:function(e){void 0===e&&(console.warn("THREE.Color: .getHSL() target is now required"),e={h:0,s:0,l:0});var t,n,r=this.r,g=this.g,b=this.b,o=Math.max(r,g,b),l=Math.min(r,g,b),c=(l+o)/2;if(l===o)t=0,n=0;else{var h=o-l;switch(n=c<=.5?h/(o+l):h/(2-o-l),o){case r:t=(g-b)/h+(g<b?6:0);break;case g:t=(b-r)/h+2;break;case b:t=(r-g)/h+4}t/=6}return e.h=t,e.s=n,e.l=c,e}},{key:"getStyle",value:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"}},{key:"offsetHSL",value:function(e,s,t){return this.getHSL(rn),rn.h+=e,rn.s+=s,rn.l+=t,this.setHSL(rn.h,rn.s,rn.l),this}},{key:"add",value:function(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}},{key:"addColors",value:function(e,t){return this.r=e.r+t.r,this.g=e.g+t.g,this.b=e.b+t.b,this}},{key:"addScalar",value:function(s){return this.r+=s,this.g+=s,this.b+=s,this}},{key:"sub",value:function(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}},{key:"multiply",value:function(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}},{key:"multiplyScalar",value:function(s){return this.r*=s,this.g*=s,this.b*=s,this}},{key:"lerp",value:function(e,t){return this.r+=(e.r-this.r)*t,this.g+=(e.g-this.g)*t,this.b+=(e.b-this.b)*t,this}},{key:"lerpColors",value:function(e,t,n){return this.r=e.r+(t.r-e.r)*n,this.g=e.g+(t.g-e.g)*n,this.b=e.b+(t.b-e.b)*n,this}},{key:"lerpHSL",value:function(e,t){this.getHSL(rn),e.getHSL(an);var n=Me.lerp(rn.h,an.h,t),s=Me.lerp(rn.s,an.s,t),r=Me.lerp(rn.l,an.l,t);return this.setHSL(n,s,r),this}},{key:"equals",value:function(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}},{key:"fromArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.r=e[t],this.g=e[t+1],this.b=e[t+2],this}},{key:"toArray",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return e[t]=this.r,e[t+1]=this.g,e[t+2]=this.b,e}},{key:"fromBufferAttribute",value:function(e,t){return this.r=e.getX(t),this.g=e.getY(t),this.b=e.getZ(t),!0===e.normalized&&(this.r/=255,this.g/=255,this.b/=255),this}},{key:"toJSON",value:function(){return this.getHex()}}]),e}();cn.NAMES=nn,cn.prototype.isColor=!0,cn.prototype.r=1,cn.prototype.g=1,cn.prototype.b=1;var un=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="MeshBasicMaterial",r.color=new cn(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.map=source.map,this.lightMap=source.lightMap,this.lightMapIntensity=source.lightMapIntensity,this.aoMap=source.aoMap,this.aoMapIntensity=source.aoMapIntensity,this.specularMap=source.specularMap,this.alphaMap=source.alphaMap,this.envMap=source.envMap,this.combine=source.combine,this.reflectivity=source.reflectivity,this.refractionRatio=source.refractionRatio,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.wireframeLinecap=source.wireframeLinecap,this.wireframeLinejoin=source.wireframeLinejoin,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this}}]),n}(tn);un.prototype.isMeshBasicMaterial=!0;var hn=new Ie,dn=new Se;function pn(e,t,n){if(Array.isArray(e))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=e,this.itemSize=t,this.count=void 0!==e?e.length/t:0,this.normalized=!0===n,this.usage=ve,this.updateRange={offset:0,count:-1},this.version=0}function fn(e,t,n){pn.call(this,new Int8Array(e),t,n)}function mn(e,t,n){pn.call(this,new Uint8Array(e),t,n)}function vn(e,t,n){pn.call(this,new Uint8ClampedArray(e),t,n)}function gn(e,t,n){pn.call(this,new Int16Array(e),t,n)}function yn(e,t,n){pn.call(this,new Uint16Array(e),t,n)}function xn(e,t,n){pn.call(this,new Int32Array(e),t,n)}function bn(e,t,n){pn.call(this,new Uint32Array(e),t,n)}function _n(e,t,n){pn.call(this,new Uint16Array(e),t,n)}function wn(e,t,n){pn.call(this,new Float32Array(e),t,n)}function Mn(e,t,n){pn.call(this,new Float64Array(e),t,n)}function Sn(e){if(0===e.length)return-1/0;for(var t=e[0],n=1,r=e.length;n<r;++n)e[n]>t&&(t=e[n]);return t}Object.defineProperty(pn.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(pn.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(source){return this.name=source.name,this.array=new source.array.constructor(source.array),this.itemSize=source.itemSize,this.count=source.count,this.normalized=source.normalized,this.usage=source.usage,this},copyAt:function(e,t,n){e*=this.itemSize,n*=t.itemSize;for(var r=0,o=this.itemSize;r<o;r++)this.array[e+r]=t.array[n+r];return this},copyArray:function(e){return this.array.set(e),this},copyColorsArray:function(e){for(var t=this.array,n=0,r=0,o=e.length;r<o;r++){var l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),l=new cn),t[n++]=l.r,t[n++]=l.g,t[n++]=l.b}return this},copyVector2sArray:function(e){for(var t=this.array,n=0,r=0,o=e.length;r<o;r++){var l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),l=new Se),t[n++]=l.x,t[n++]=l.y}return this},copyVector3sArray:function(e){for(var t=this.array,n=0,r=0,o=e.length;r<o;r++){var l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),l=new Ie),t[n++]=l.x,t[n++]=l.y,t[n++]=l.z}return this},copyVector4sArray:function(e){for(var t=this.array,n=0,r=0,o=e.length;r<o;r++){var l=e[r];void 0===l&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),l=new ke),t[n++]=l.x,t[n++]=l.y,t[n++]=l.z,t[n++]=l.w}return this},applyMatrix3:function(e){if(2===this.itemSize)for(var t=0,n=this.count;t<n;t++)dn.fromBufferAttribute(this,t),dn.applyMatrix3(e),this.setXY(t,dn.x,dn.y);else if(3===this.itemSize)for(var r=0,o=this.count;r<o;r++)hn.fromBufferAttribute(this,r),hn.applyMatrix3(e),this.setXYZ(r,hn.x,hn.y,hn.z);return this},applyMatrix4:function(e){for(var t=0,n=this.count;t<n;t++)hn.x=this.getX(t),hn.y=this.getY(t),hn.z=this.getZ(t),hn.applyMatrix4(e),this.setXYZ(t,hn.x,hn.y,hn.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)hn.x=this.getX(t),hn.y=this.getY(t),hn.z=this.getZ(t),hn.applyNormalMatrix(e),this.setXYZ(t,hn.x,hn.y,hn.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)hn.x=this.getX(t),hn.y=this.getY(t),hn.z=this.getZ(t),hn.transformDirection(e),this.setXYZ(t,hn.x,hn.y,hn.z);return this},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this},getX:function(e){return this.array[e*this.itemSize]},setX:function(e,t){return this.array[e*this.itemSize]=t,this},getY:function(e){return this.array[e*this.itemSize+1]},setY:function(e,t){return this.array[e*this.itemSize+1]=t,this},getZ:function(e){return this.array[e*this.itemSize+2]},setZ:function(e,t){return this.array[e*this.itemSize+2]=t,this},getW:function(e){return this.array[e*this.itemSize+3]},setW:function(e,t){return this.array[e*this.itemSize+3]=t,this},setXY:function(e,t,n){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this},setXYZW:function(e,t,n,r,o){return e*=this.itemSize,this.array[e+0]=t,this.array[e+1]=n,this.array[e+2]=r,this.array[e+3]=o,this},onUpload:function(e){return this.onUploadCallback=e,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)},toJSON:function(){var data={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return""!==this.name&&(data.name=this.name),this.usage!==ve&&(data.usage=this.usage),0===this.updateRange.offset&&-1===this.updateRange.count||(data.updateRange=this.updateRange),data}}),fn.prototype=Object.create(pn.prototype),fn.prototype.constructor=fn,mn.prototype=Object.create(pn.prototype),mn.prototype.constructor=mn,vn.prototype=Object.create(pn.prototype),vn.prototype.constructor=vn,gn.prototype=Object.create(pn.prototype),gn.prototype.constructor=gn,yn.prototype=Object.create(pn.prototype),yn.prototype.constructor=yn,xn.prototype=Object.create(pn.prototype),xn.prototype.constructor=xn,bn.prototype=Object.create(pn.prototype),bn.prototype.constructor=bn,_n.prototype=Object.create(pn.prototype),_n.prototype.constructor=_n,_n.prototype.isFloat16BufferAttribute=!0,wn.prototype=Object.create(pn.prototype),wn.prototype.constructor=wn,Mn.prototype=Object.create(pn.prototype),Mn.prototype.constructor=Mn;Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array;var En=0,Tn=new pt,Cn=new zt,Ln=new Ie,An=new He,Rn=new He,kn=new Ie;function Pn(){Object.defineProperty(this,"id",{value:En++}),this.uuid=Me.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}Pn.prototype=Object.assign(Object.create(xe.prototype),{constructor:Pn,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(e){return Array.isArray(e)?this.index=new(Sn(e)>65535?bn:yn)(e,1):this.index=e,this},getAttribute:function(e){return this.attributes[e]},setAttribute:function(e,t){return this.attributes[e]=t,this},deleteAttribute:function(e){return delete this.attributes[e],this},hasAttribute:function(e){return void 0!==this.attributes[e]},addGroup:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.groups.push({start:e,count:t,materialIndex:n})},clearGroups:function(){this.groups=[]},setDrawRange:function(e,t){this.drawRange.start=e,this.drawRange.count=t},applyMatrix4:function(e){var t=this.attributes.position;void 0!==t&&(t.applyMatrix4(e),t.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){var r=(new Te).getNormalMatrix(e);n.applyNormalMatrix(r),n.needsUpdate=!0}var o=this.attributes.tangent;return void 0!==o&&(o.transformDirection(e),o.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(e){return Tn.makeRotationX(e),this.applyMatrix4(Tn),this},rotateY:function(e){return Tn.makeRotationY(e),this.applyMatrix4(Tn),this},rotateZ:function(e){return Tn.makeRotationZ(e),this.applyMatrix4(Tn),this},translate:function(e,t,n){return Tn.makeTranslation(e,t,n),this.applyMatrix4(Tn),this},scale:function(e,t,n){return Tn.makeScale(e,t,n),this.applyMatrix4(Tn),this},lookAt:function(e){return Cn.lookAt(e),Cn.updateMatrix(),this.applyMatrix4(Cn.matrix),this},center:function(){return this.computeBoundingBox(),this.boundingBox.getCenter(Ln).negate(),this.translate(Ln.x,Ln.y,Ln.z),this},setFromPoints:function(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n];t.push(o.x,o.y,o.z||0)}return this.setAttribute("position",new wn(t,3)),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new He);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingBox.set(new Ie(-1/0,-1/0,-1/0),new Ie(1/0,1/0,1/0));if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),t)for(var n=0,r=t.length;n<r;n++){var o=t[n];An.setFromBufferAttribute(o),this.morphTargetsRelative?(kn.addVectors(this.boundingBox.min,An.min),this.boundingBox.expandByPoint(kn),kn.addVectors(this.boundingBox.max,An.max),this.boundingBox.expandByPoint(kn)):(this.boundingBox.expandByPoint(An.min),this.boundingBox.expandByPoint(An.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new nt);var e=this.attributes.position,t=this.morphAttributes.position;if(e&&e.isGLBufferAttribute)return console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),void this.boundingSphere.set(new Ie,1/0);if(e){var n=this.boundingSphere.center;if(An.setFromBufferAttribute(e),t)for(var r=0,o=t.length;r<o;r++){var l=t[r];Rn.setFromBufferAttribute(l),this.morphTargetsRelative?(kn.addVectors(An.min,Rn.min),An.expandByPoint(kn),kn.addVectors(An.max,Rn.max),An.expandByPoint(kn)):(An.expandByPoint(Rn.min),An.expandByPoint(Rn.max))}An.getCenter(n);for(var c=0,h=0,d=e.count;h<d;h++)kn.fromBufferAttribute(e,h),c=Math.max(c,n.distanceToSquared(kn));if(t)for(var f=0,m=t.length;f<m;f++)for(var v=t[f],y=this.morphTargetsRelative,x=0,_=v.count;x<_;x++)kn.fromBufferAttribute(v,x),y&&(Ln.fromBufferAttribute(e,x),kn.add(Ln)),c=Math.max(c,n.distanceToSquared(kn));this.boundingSphere.radius=Math.sqrt(c),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}},computeFaceNormals:function(){},computeTangents:function(){var e=this.index,t=this.attributes;if(null!==e&&void 0!==t.position&&void 0!==t.normal&&void 0!==t.uv){var n=e.array,r=t.position.array,o=t.normal.array,l=t.uv.array,c=r.length/3;void 0===t.tangent&&this.setAttribute("tangent",new pn(new Float32Array(4*c),4));for(var h=t.tangent.array,d=[],f=[],m=0;m<c;m++)d[m]=new Ie,f[m]=new Ie;var v=new Ie,y=new Ie,x=new Ie,_=new Se,w=new Se,M=new Se,S=new Ie,E=new Ie,T=this.groups;0===T.length&&(T=[{start:0,count:n.length}]);for(var C=0,L=T.length;C<L;++C)for(var A=T[C],R=A.start,k=R,P=R+A.count;k<P;k+=3)G(n[k+0],n[k+1],n[k+2]);for(var O=new Ie,I=new Ie,D=new Ie,N=new Ie,H=0,z=T.length;H<z;++H)for(var F=T[H],B=F.start,U=B,j=B+F.count;U<j;U+=3)V(n[U+0]),V(n[U+1]),V(n[U+2])}else console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");function G(a,b,e){v.fromArray(r,3*a),y.fromArray(r,3*b),x.fromArray(r,3*e),_.fromArray(l,2*a),w.fromArray(l,2*b),M.fromArray(l,2*e),y.sub(v),x.sub(v),w.sub(_),M.sub(_);var t=1/(w.x*M.y-M.x*w.y);isFinite(t)&&(S.copy(y).multiplyScalar(M.y).addScaledVector(x,-w.y).multiplyScalar(t),E.copy(x).multiplyScalar(w.x).addScaledVector(y,-M.x).multiplyScalar(t),d[a].add(S),d[b].add(S),d[e].add(S),f[a].add(E),f[b].add(E),f[e].add(E))}function V(e){D.fromArray(o,3*e),N.copy(D);var t=d[e];O.copy(t),O.sub(D.multiplyScalar(D.dot(t))).normalize(),I.crossVectors(N,t);var n=I.dot(f[e])<0?-1:1;h[4*e]=O.x,h[4*e+1]=O.y,h[4*e+2]=O.z,h[4*e+3]=n}},computeVertexNormals:function(){var e=this.index,t=this.getAttribute("position");if(void 0!==t){var n=this.getAttribute("normal");if(void 0===n)n=new pn(new Float32Array(3*t.count),3),this.setAttribute("normal",n);else for(var r=0,o=n.count;r<o;r++)n.setXYZ(r,0,0,0);var l=new Ie,c=new Ie,h=new Ie,d=new Ie,f=new Ie,m=new Ie,v=new Ie,y=new Ie;if(e)for(var x=0,_=e.count;x<_;x+=3){var w=e.getX(x+0),M=e.getX(x+1),S=e.getX(x+2);l.fromBufferAttribute(t,w),c.fromBufferAttribute(t,M),h.fromBufferAttribute(t,S),v.subVectors(h,c),y.subVectors(l,c),v.cross(y),d.fromBufferAttribute(n,w),f.fromBufferAttribute(n,M),m.fromBufferAttribute(n,S),d.add(v),f.add(v),m.add(v),n.setXYZ(w,d.x,d.y,d.z),n.setXYZ(M,f.x,f.y,f.z),n.setXYZ(S,m.x,m.y,m.z)}else for(var E=0,T=t.count;E<T;E+=3)l.fromBufferAttribute(t,E+0),c.fromBufferAttribute(t,E+1),h.fromBufferAttribute(t,E+2),v.subVectors(h,c),y.subVectors(l,c),v.cross(y),n.setXYZ(E+0,v.x,v.y,v.z),n.setXYZ(E+1,v.x,v.y,v.z),n.setXYZ(E+2,v.x,v.y,v.z);this.normalizeNormals(),n.needsUpdate=!0}},merge:function(e,t){if(e&&e.isBufferGeometry){void 0===t&&(t=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==e.attributes[r])for(var o=n[r].array,l=e.attributes[r],c=l.array,h=l.itemSize*t,d=Math.min(c.length,o.length-h),f=0,m=h;f<d;f++,m++)o[m]=c[f];return this}console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",e)},normalizeNormals:function(){for(var e=this.attributes.normal,t=0,n=e.count;t<n;t++)kn.fromBufferAttribute(e,t),kn.normalize(),e.setXYZ(t,kn.x,kn.y,kn.z)},toNonIndexed:function(){function e(e,t){for(var n=e.array,r=e.itemSize,o=e.normalized,l=new n.constructor(t.length*r),c=0,h=0,d=0,f=t.length;d<f;d++){c=t[d]*r;for(var m=0;m<r;m++)l[h++]=n[c++]}return new pn(l,r,o)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;var t=new Pn,n=this.index.array,r=this.attributes;for(var o in r){var l=e(r[o],n);t.setAttribute(o,l)}var c=this.morphAttributes;for(var h in c){for(var d=[],f=c[h],m=0,v=f.length;m<v;m++){var y=e(f[m],n);d.push(y)}t.morphAttributes[h]=d}t.morphTargetsRelative=this.morphTargetsRelative;for(var x=this.groups,_=0,w=x.length;_<w;_++){var M=x[_];t.addGroup(M.start,M.count,M.materialIndex)}return t},toJSON:function(){var data={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(data.uuid=this.uuid,data.type=this.type,""!==this.name&&(data.name=this.name),Object.keys(this.userData).length>0&&(data.userData=this.userData),void 0!==this.parameters){var e=this.parameters;for(var t in e)void 0!==e[t]&&(data[t]=e[t]);return data}data.data={attributes:{}};var n=this.index;null!==n&&(data.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});var r=this.attributes;for(var o in r){var l=r[o];data.data.attributes[o]=l.toJSON(data.data)}var c={},h=!1;for(var d in this.morphAttributes){for(var f=this.morphAttributes[d],m=[],v=0,y=f.length;v<y;v++){var x=f[v];m.push(x.toJSON(data.data))}m.length>0&&(c[d]=m,h=!0)}h&&(data.data.morphAttributes=c,data.data.morphTargetsRelative=this.morphTargetsRelative);var _=this.groups;_.length>0&&(data.data.groups=JSON.parse(JSON.stringify(_)));var w=this.boundingSphere;return null!==w&&(data.data.boundingSphere={center:w.center.toArray(),radius:w.radius}),data},clone:function(){return(new Pn).copy(this)},copy:function(source){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;var data={};this.name=source.name;var e=source.index;null!==e&&this.setIndex(e.clone(data));var t=source.attributes;for(var n in t){var r=t[n];this.setAttribute(n,r.clone(data))}var o=source.morphAttributes;for(var l in o){for(var c=[],h=o[l],d=0,f=h.length;d<f;d++)c.push(h[d].clone(data));this.morphAttributes[l]=c}this.morphTargetsRelative=source.morphTargetsRelative;for(var m=source.groups,v=0,y=m.length;v<y;v++){var x=m[v];this.addGroup(x.start,x.count,x.materialIndex)}var _=source.boundingBox;null!==_&&(this.boundingBox=_.clone());var w=source.boundingSphere;return null!==w&&(this.boundingSphere=w.clone()),this.drawRange.start=source.drawRange.start,this.drawRange.count=source.drawRange.count,this.userData=source.userData,this},dispose:function(){this.dispatchEvent({type:"dispose"})}});var On=new pt,In=new ht,Dn=new nt,Nn=new Ie,Hn=new Ie,zn=new Ie,Fn=new Ie,Bn=new Ie,Un=new Ie,jn=new Ie,Gn=new Ie,Vn=new Ie,Wn=new Se,qn=new Se,Xn=new Se,Yn=new Ie,Zn=new Ie;function Jn(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new un;zt.call(this),this.type="Mesh",this.geometry=e,this.material=t,this.updateMorphTargets()}function $n(object,e,t,n,r,o,l,c,h,a,b,d){Nn.fromBufferAttribute(r,a),Hn.fromBufferAttribute(r,b),zn.fromBufferAttribute(r,d);var f=object.morphTargetInfluences;if(e.morphTargets&&o&&f){jn.set(0,0,0),Gn.set(0,0,0),Vn.set(0,0,0);for(var m=0,v=o.length;m<v;m++){var y=f[m],x=o[m];0!==y&&(Fn.fromBufferAttribute(x,a),Bn.fromBufferAttribute(x,b),Un.fromBufferAttribute(x,d),l?(jn.addScaledVector(Fn,y),Gn.addScaledVector(Bn,y),Vn.addScaledVector(Un,y)):(jn.addScaledVector(Fn.sub(Nn),y),Gn.addScaledVector(Bn.sub(Hn),y),Vn.addScaledVector(Un.sub(zn),y)))}Nn.add(jn),Hn.add(Gn),zn.add(Vn)}object.isSkinnedMesh&&e.skinning&&(object.boneTransform(a,Nn),object.boneTransform(b,Hn),object.boneTransform(d,zn));var _=function(object,e,t,n,r,o,l,c){if(null===(1===e.side?n.intersectTriangle(l,o,r,!0,c):n.intersectTriangle(r,o,l,2!==e.side,c)))return null;Zn.copy(c),Zn.applyMatrix4(object.matrixWorld);var h=t.ray.origin.distanceTo(Zn);return h<t.near||h>t.far?null:{distance:h,point:Zn.clone(),object:object}}(object,e,t,n,Nn,Hn,zn,Yn);if(_){c&&(Wn.fromBufferAttribute(c,a),qn.fromBufferAttribute(c,b),Xn.fromBufferAttribute(c,d),_.uv=Qt.getUV(Yn,Nn,Hn,zn,Wn,qn,Xn,new Se)),h&&(Wn.fromBufferAttribute(h,a),qn.fromBufferAttribute(h,b),Xn.fromBufferAttribute(h,d),_.uv2=Qt.getUV(Yn,Nn,Hn,zn,Wn,qn,Xn,new Se));var w={a:a,b:b,c:d,normal:new Ie,materialIndex:0};Qt.getNormal(Nn,Hn,zn,w.normal),_.face=w}return _}Jn.prototype=Object.assign(Object.create(zt.prototype),{constructor:Jn,isMesh:!0,copy:function(source){return zt.prototype.copy.call(this,source),void 0!==source.morphTargetInfluences&&(this.morphTargetInfluences=source.morphTargetInfluences.slice()),void 0!==source.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},source.morphTargetDictionary)),this.material=source.material,this.geometry=source.geometry,this},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,l=r.length;o<l;o++){var c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}else{var h=e.morphTargets;void 0!==h&&h.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},raycast:function(e,t){var n,r=this.geometry,o=this.material,l=this.matrixWorld;if(void 0!==o&&(null===r.boundingSphere&&r.computeBoundingSphere(),Dn.copy(r.boundingSphere),Dn.applyMatrix4(l),!1!==e.ray.intersectsSphere(Dn)&&(On.copy(l).invert(),In.copy(e.ray).applyMatrix4(On),null===r.boundingBox||!1!==In.intersectsBox(r.boundingBox))))if(r.isBufferGeometry){var c=r.index,h=r.attributes.position,d=r.morphAttributes.position,f=r.morphTargetsRelative,m=r.attributes.uv,v=r.attributes.uv2,y=r.groups,x=r.drawRange;if(null!==c)if(Array.isArray(o))for(var _=0,w=y.length;_<w;_++)for(var M=y[_],S=o[M.materialIndex],E=Math.max(M.start,x.start),T=Math.min(M.start+M.count,x.start+x.count);E<T;E+=3){var a=c.getX(E),b=c.getX(E+1),C=c.getX(E+2);(n=$n(this,S,e,In,h,d,f,m,v,a,b,C))&&(n.faceIndex=Math.floor(E/3),n.face.materialIndex=M.materialIndex,t.push(n))}else for(var L=Math.max(0,x.start),A=Math.min(c.count,x.start+x.count);L<A;L+=3){var R=c.getX(L),k=c.getX(L+1),P=c.getX(L+2);(n=$n(this,o,e,In,h,d,f,m,v,R,k,P))&&(n.faceIndex=Math.floor(L/3),t.push(n))}else if(void 0!==h)if(Array.isArray(o))for(var O=0,I=y.length;O<I;O++)for(var D=y[O],N=o[D.materialIndex],H=Math.max(D.start,x.start),z=Math.min(D.start+D.count,x.start+x.count);H<z;H+=3){(n=$n(this,N,e,In,h,d,f,m,v,H,H+1,H+2))&&(n.faceIndex=Math.floor(H/3),n.face.materialIndex=D.materialIndex,t.push(n))}else for(var F=Math.max(0,x.start),B=Math.min(h.count,x.start+x.count);F<B;F+=3){(n=$n(this,o,e,In,h,d,f,m,v,F,F+1,F+2))&&(n.faceIndex=Math.floor(F/3),t.push(n))}}else r.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}});var Kn=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;Object(x.a)(this,n),(e=t.call(this)).type="BoxGeometry",e.parameters={width:r,height:o,depth:l,widthSegments:c,heightSegments:h,depthSegments:d};var f=Object(m.a)(e);c=Math.floor(c),h=Math.floor(h),d=Math.floor(d);var v=[],y=[],_=[],w=[],M=0,S=0;function E(u,e,t,n,r,o,l,c,h,d,m){for(var x=o/h,E=l/d,T=o/2,C=l/2,L=c/2,A=h+1,R=d+1,k=0,P=0,O=new Ie,I=0;I<R;I++)for(var D=I*E-C,N=0;N<A;N++){var H=N*x-T;O[u]=H*n,O[e]=D*r,O[t]=L,y.push(O.x,O.y,O.z),O[u]=0,O[e]=0,O[t]=c>0?1:-1,_.push(O.x,O.y,O.z),w.push(N/h),w.push(1-I/d),k+=1}for(var z=0;z<d;z++)for(var F=0;F<h;F++){var a=M+F+A*z,b=M+F+A*(z+1),B=M+(F+1)+A*(z+1),U=M+(F+1)+A*z;v.push(a,b,U),v.push(b,B,U),P+=6}f.addGroup(S,P,m),S+=P,M+=k}return E("z","y","x",-1,-1,l,o,r,d,h,0),E("z","y","x",1,-1,l,o,-r,d,h,1),E("x","z","y",1,1,r,l,o,c,d,2),E("x","z","y",1,-1,r,l,-o,c,d,3),E("x","y","z",1,-1,r,o,l,c,h,4),E("x","y","z",-1,-1,r,o,-l,c,h,5),e.setIndex(v),e.setAttribute("position",new wn(y,3)),e.setAttribute("normal",new wn(_,3)),e.setAttribute("uv",new wn(w,2)),e}return Object(_.a)(n)}(Pn);function Qn(e){var t={};for(var u in e)for(var p in t[u]={},e[u]){var n=e[u][p];n&&(n.isColor||n.isMatrix3||n.isMatrix4||n.isVector2||n.isVector3||n.isVector4||n.isTexture||n.isQuaternion)?t[u][p]=n.clone():Array.isArray(n)?t[u][p]=n.slice():t[u][p]=n}return t}function ei(e){for(var t={},u=0;u<e.length;u++){var n=Qn(e[u]);for(var p in n)t[p]=n[p]}return t}var ti={clone:Qn,merge:ei};function ni(e){tn.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,void 0!==e&&(void 0!==e.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(e))}function ii(){zt.call(this),this.type="Camera",this.matrixWorldInverse=new pt,this.projectionMatrix=new pt,this.projectionMatrixInverse=new pt}function ri(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2e3;ii.call(this),this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=n,this.far=r,this.focus=10,this.aspect=t,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}ni.prototype=Object.create(tn.prototype),ni.prototype.constructor=ni,ni.prototype.isShaderMaterial=!0,ni.prototype.copy=function(source){return tn.prototype.copy.call(this,source),this.fragmentShader=source.fragmentShader,this.vertexShader=source.vertexShader,this.uniforms=Qn(source.uniforms),this.defines=Object.assign({},source.defines),this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.lights=source.lights,this.clipping=source.clipping,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this.extensions=Object.assign({},source.extensions),this.glslVersion=source.glslVersion,this},ni.prototype.toJSON=function(meta){var data=tn.prototype.toJSON.call(this,meta);for(var e in data.glslVersion=this.glslVersion,data.uniforms={},this.uniforms){var t=this.uniforms[e].value;t&&t.isTexture?data.uniforms[e]={type:"t",value:t.toJSON(meta).uuid}:t&&t.isColor?data.uniforms[e]={type:"c",value:t.getHex()}:t&&t.isVector2?data.uniforms[e]={type:"v2",value:t.toArray()}:t&&t.isVector3?data.uniforms[e]={type:"v3",value:t.toArray()}:t&&t.isVector4?data.uniforms[e]={type:"v4",value:t.toArray()}:t&&t.isMatrix3?data.uniforms[e]={type:"m3",value:t.toArray()}:t&&t.isMatrix4?data.uniforms[e]={type:"m4",value:t.toArray()}:data.uniforms[e]={value:t}}Object.keys(this.defines).length>0&&(data.defines=this.defines),data.vertexShader=this.vertexShader,data.fragmentShader=this.fragmentShader;var n={};for(var r in this.extensions)!0===this.extensions[r]&&(n[r]=!0);return Object.keys(n).length>0&&(data.extensions=n),data},ii.prototype=Object.assign(Object.create(zt.prototype),{constructor:ii,isCamera:!0,copy:function(source,e){return zt.prototype.copy.call(this,source,e),this.matrixWorldInverse.copy(source.matrixWorldInverse),this.projectionMatrix.copy(source.projectionMatrix),this.projectionMatrixInverse.copy(source.projectionMatrixInverse),this},getWorldDirection:function(e){void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new Ie),this.updateWorldMatrix(!0,!1);var t=this.matrixWorld.elements;return e.set(-t[8],-t[9],-t[10]).normalize()},updateMatrixWorld:function(e){zt.prototype.updateMatrixWorld.call(this,e),this.matrixWorldInverse.copy(this.matrixWorld).invert()},updateWorldMatrix:function(e,t){zt.prototype.updateWorldMatrix.call(this,e,t),this.matrixWorldInverse.copy(this.matrixWorld).invert()},clone:function(){return(new this.constructor).copy(this)}}),ri.prototype=Object.assign(Object.create(ii.prototype),{constructor:ri,isPerspectiveCamera:!0,copy:function(source,e){return ii.prototype.copy.call(this,source,e),this.fov=source.fov,this.zoom=source.zoom,this.near=source.near,this.far=source.far,this.focus=source.focus,this.aspect=source.aspect,this.view=null===source.view?null:Object.assign({},source.view),this.filmGauge=source.filmGauge,this.filmOffset=source.filmOffset,this},setFocalLength:function(e){var t=.5*this.getFilmHeight()/e;this.fov=2*Me.RAD2DEG*Math.atan(t),this.updateProjectionMatrix()},getFocalLength:function(){var e=Math.tan(.5*Me.DEG2RAD*this.fov);return.5*this.getFilmHeight()/e},getEffectiveFOV:function(){return 2*Me.RAD2DEG*Math.atan(Math.tan(.5*Me.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(e,t,n,r,o,l){this.aspect=e/t,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var e=this.near,t=e*Math.tan(.5*Me.DEG2RAD*this.fov)/this.zoom,n=2*t,r=this.aspect*n,o=-.5*r,view=this.view;if(null!==this.view&&this.view.enabled){var l=view.fullWidth,c=view.fullHeight;o+=view.offsetX*r/l,t-=view.offsetY*n/c,r*=view.width/l,n*=view.height/c}var h=this.filmOffset;0!==h&&(o+=e*h/this.getFilmWidth()),this.projectionMatrix.makePerspective(o,o+r,t,t-n,e,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()},toJSON:function(meta){var data=zt.prototype.toJSON.call(this,meta);return data.object.fov=this.fov,data.object.zoom=this.zoom,data.object.near=this.near,data.object.far=this.far,data.object.focus=this.focus,data.object.aspect=this.aspect,null!==this.view&&(data.object.view=Object.assign({},this.view)),data.object.filmGauge=this.filmGauge,data.object.filmOffset=this.filmOffset,data}});var ai=90,oi=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o){var l;if(Object(x.a)(this,n),(l=t.call(this)).type="CubeCamera",!0!==o.isWebGLCubeRenderTarget)return console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter."),Object(y.a)(l);l.renderTarget=o;var c=new ri(ai,1,e,r);c.layers=l.layers,c.up.set(0,-1,0),c.lookAt(new Ie(1,0,0)),l.add(c);var h=new ri(ai,1,e,r);h.layers=l.layers,h.up.set(0,-1,0),h.lookAt(new Ie(-1,0,0)),l.add(h);var d=new ri(ai,1,e,r);d.layers=l.layers,d.up.set(0,0,1),d.lookAt(new Ie(0,1,0)),l.add(d);var f=new ri(ai,1,e,r);f.layers=l.layers,f.up.set(0,0,-1),f.lookAt(new Ie(0,-1,0)),l.add(f);var m=new ri(ai,1,e,r);m.layers=l.layers,m.up.set(0,-1,0),m.lookAt(new Ie(0,0,1)),l.add(m);var v=new ri(ai,1,e,r);return v.layers=l.layers,v.up.set(0,-1,0),v.lookAt(new Ie(0,0,-1)),l.add(v),l}return Object(_.a)(n,[{key:"update",value:function(e,t){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,r=Object(l.a)(this.children,6),o=r[0],c=r[1],h=r[2],d=r[3],f=r[4],m=r[5],v=e.xr.enabled,y=e.getRenderTarget();e.xr.enabled=!1;var x=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,e.setRenderTarget(n,0),e.render(t,o),e.setRenderTarget(n,1),e.render(t,c),e.setRenderTarget(n,2),e.render(t,h),e.setRenderTarget(n,3),e.render(t,d),e.setRenderTarget(n,4),e.render(t,f),n.texture.generateMipmaps=x,e.setRenderTarget(n,5),e.render(t,m),e.setRenderTarget(y),e.xr.enabled=v}}]),n}(zt),si=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o,l,c,h,d,f,m,v){var y;return Object(x.a)(this,n),e=void 0!==e?e:[],r=void 0!==r?r:O,d=void 0!==d?d:Q,(y=t.call(this,e,r,o,l,c,h,d,f,m,v))._needsFlipEnvMap=!0,y.flipY=!1,y}return Object(_.a)(n,[{key:"images",get:function(){return this.image},set:function(e){this.image=e}}]),n}(Ae);si.prototype.isCubeTexture=!0;var ci=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o){var l;return Object(x.a)(this,n),Number.isInteger(r)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),r=o),l=t.call(this,e,e,r),r=r||{},l.texture=new si(void 0,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.encoding),l.texture.generateMipmaps=void 0!==r.generateMipmaps&&r.generateMipmaps,l.texture.minFilter=void 0!==r.minFilter?r.minFilter:G,l.texture._needsFlipEnvMap=!1,l}return Object(_.a)(n,[{key:"fromEquirectangularTexture",value:function(e,t){this.texture.type=t.type,this.texture.format=ee,this.texture.encoding=t.encoding,this.texture.generateMipmaps=t.generateMipmaps,this.texture.minFilter=t.minFilter,this.texture.magFilter=t.magFilter;var n={tEquirect:{value:null}},r="\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\tvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\n\t\t\t\t\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n\n\t\t\t\t}\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvWorldDirection = transformDirection( position, modelMatrix );\n\n\t\t\t\t\t#include <begin_vertex>\n\t\t\t\t\t#include <project_vertex>\n\n\t\t\t\t}\n\t\t\t",o="\n\n\t\t\t\tuniform sampler2D tEquirect;\n\n\t\t\t\tvarying vec3 vWorldDirection;\n\n\t\t\t\t#include <common>\n\n\t\t\t\tvoid main() {\n\n\t\t\t\t\tvec3 direction = normalize( vWorldDirection );\n\n\t\t\t\t\tvec2 sampleUV = equirectUv( direction );\n\n\t\t\t\t\tgl_FragColor = texture2D( tEquirect, sampleUV );\n\n\t\t\t\t}\n\t\t\t",l=new Kn(5,5,5),c=new ni({name:"CubemapFromEquirect",uniforms:Qn(n),vertexShader:r,fragmentShader:o,side:1,blending:0});c.uniforms.tEquirect.value=t;var h=new Jn(l,c),d=t.minFilter;return t.minFilter===W&&(t.minFilter=G),new oi(1,10,this).update(e,h),t.minFilter=d,h.geometry.dispose(),h.material.dispose(),this}},{key:"clear",value:function(e,t,n,r){for(var o=e.getRenderTarget(),l=0;l<6;l++)e.setRenderTarget(this,l),e.clear(t,n,r);e.setRenderTarget(o)}}]),n}(Pe);ci.prototype.isWebGLCubeRenderTarget=!0;var ui=function(e){Object(v.a)(n,e);var t=S(n);function n(data,e,r,o,l,c,h,d,f,m,v,y){var _;return Object(x.a)(this,n),(_=t.call(this,null,c,h,d,f,m,o,l,v,y)).image={data:data||null,width:e||1,height:r||1},_.magFilter=void 0!==f?f:B,_.minFilter=void 0!==m?m:B,_.generateMipmaps=!1,_.flipY=!1,_.unpackAlignment=1,_.needsUpdate=!0,_}return Object(_.a)(n)}(Ae);ui.prototype.isDataTexture=!0;var hi=new nt,di=new Ie,pi=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new jt,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new jt,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new jt,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new jt,l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:new jt,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:new jt;Object(x.a)(this,e),this.planes=[t,n,r,o,l,c]}return Object(_.a)(e,[{key:"set",value:function(e,t,n,r,o,l){var c=this.planes;return c[0].copy(e),c[1].copy(t),c[2].copy(n),c[3].copy(r),c[4].copy(o),c[5].copy(l),this}},{key:"copy",value:function(e){for(var t=this.planes,n=0;n<6;n++)t[n].copy(e.planes[n]);return this}},{key:"setFromProjectionMatrix",value:function(e){var t=this.planes,n=e.elements,r=n[0],o=n[1],l=n[2],c=n[3],h=n[4],d=n[5],f=n[6],m=n[7],v=n[8],y=n[9],x=n[10],_=n[11],w=n[12],M=n[13],S=n[14],E=n[15];return t[0].setComponents(c-r,m-h,_-v,E-w).normalize(),t[1].setComponents(c+r,m+h,_+v,E+w).normalize(),t[2].setComponents(c+o,m+d,_+y,E+M).normalize(),t[3].setComponents(c-o,m-d,_-y,E-M).normalize(),t[4].setComponents(c-l,m-f,_-x,E-S).normalize(),t[5].setComponents(c+l,m+f,_+x,E+S).normalize(),this}},{key:"intersectsObject",value:function(object){var e=object.geometry;return null===e.boundingSphere&&e.computeBoundingSphere(),hi.copy(e.boundingSphere).applyMatrix4(object.matrixWorld),this.intersectsSphere(hi)}},{key:"intersectsSprite",value:function(e){return hi.center.set(0,0,0),hi.radius=.7071067811865476,hi.applyMatrix4(e.matrixWorld),this.intersectsSphere(hi)}},{key:"intersectsSphere",value:function(e){for(var t=this.planes,n=e.center,r=-e.radius,o=0;o<6;o++){if(t[o].distanceToPoint(n)<r)return!1}return!0}},{key:"intersectsBox",value:function(e){for(var t=this.planes,n=0;n<6;n++){var r=t[n];if(di.x=r.normal.x>0?e.max.x:e.min.x,di.y=r.normal.y>0?e.max.y:e.min.y,di.z=r.normal.z>0?e.max.z:e.min.z,r.distanceToPoint(di)<0)return!1}return!0}},{key:"containsPoint",value:function(e){for(var t=this.planes,n=0;n<6;n++)if(t[n].distanceToPoint(e)<0)return!1;return!0}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function fi(){var e=null,t=!1,n=null,r=null;function o(time,t){n(time,t),r=e.requestAnimationFrame(o)}return{start:function(){!0!==t&&null!==n&&(r=e.requestAnimationFrame(o),t=!0)},stop:function(){e.cancelAnimationFrame(r),t=!1},setAnimationLoop:function(e){n=e},setContext:function(t){e=t}}}function mi(e,t){var n=t.isWebGL2,r=new WeakMap;return{get:function(e){return e.isInterleavedBufferAttribute&&(e=e.data),r.get(e)},remove:function(t){t.isInterleavedBufferAttribute&&(t=t.data);var data=r.get(t);data&&(e.deleteBuffer(data.buffer),r.delete(t))},update:function(t,o){if(t.isGLBufferAttribute){var l=r.get(t);(!l||l.version<t.version)&&r.set(t,{buffer:t.buffer,type:t.type,bytesPerElement:t.elementSize,version:t.version})}else{t.isInterleavedBufferAttribute&&(t=t.data);var data=r.get(t);void 0===data?r.set(t,function(t,r){var o=t.array,l=t.usage,c=e.createBuffer();e.bindBuffer(r,c),e.bufferData(r,o,l),t.onUploadCallback();var h=5126;return o instanceof Float32Array?h=5126:o instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):o instanceof Uint16Array?t.isFloat16BufferAttribute?n?h=5131:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):h=5123:o instanceof Int16Array?h=5122:o instanceof Uint32Array?h=5125:o instanceof Int32Array?h=5124:o instanceof Int8Array?h=5120:o instanceof Uint8Array&&(h=5121),{buffer:c,type:h,bytesPerElement:o.BYTES_PER_ELEMENT,version:t.version}}(t,o)):data.version<t.version&&(!function(t,r,o){var l=r.array,c=r.updateRange;e.bindBuffer(o,t),-1===c.count?e.bufferSubData(o,0,l):(n?e.bufferSubData(o,c.offset*l.BYTES_PER_ELEMENT,l,c.offset,c.count):e.bufferSubData(o,c.offset*l.BYTES_PER_ELEMENT,l.subarray(c.offset,c.offset+c.count)),c.count=-1)}(data.buffer,t,o),data.version=t.version)}}}}var vi=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;Object(x.a)(this,n),(e=t.call(this)).type="PlaneGeometry",e.parameters={width:r,height:o,widthSegments:l,heightSegments:c};for(var h=r/2,d=o/2,f=Math.floor(l),m=Math.floor(c),v=f+1,y=m+1,_=r/f,w=o/m,M=[],S=[],E=[],T=[],C=0;C<y;C++)for(var L=C*w-d,A=0;A<v;A++){var R=A*_-h;S.push(R,-L,0),E.push(0,0,1),T.push(A/f),T.push(1-C/m)}for(var k=0;k<m;k++)for(var P=0;P<f;P++){var a=P+v*k,b=P+v*(k+1),O=P+1+v*(k+1),I=P+1+v*k;M.push(a,b,I),M.push(b,O,I)}return e.setIndex(M),e.setAttribute("position",new wn(S,3)),e.setAttribute("normal",new wn(E,3)),e.setAttribute("uv",new wn(T,2)),e}return Object(_.a)(n)}(Pn),gi={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( STANDARD )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"vec3 transformed = vec3( position );",beginnormal_vertex:"vec3 objectNormal = vec3( normal );\n#ifdef USE_TANGENT\n\tvec3 objectTangent = vec3( tangent.xyz );\n#endif",bsdfs:"vec2 integrateSpecularBRDF( const in float dotNV, const in float roughness ) {\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\treturn vec2( -1.04, 1.04 ) * a004 + r.zw;\n}\nfloat punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\tif( cutoffDistance > 0.0 ) {\n\t\tdistanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t}\n\treturn distanceFalloff;\n#else\n\tif( cutoffDistance > 0.0 && decayExponent > 0.0 ) {\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n\t}\n\treturn 1.0;\n#endif\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nvec3 F_Schlick_RoughnessDependent( const in vec3 F0, const in float dotNV, const in float roughness ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotNV - 6.98316 ) * dotNV );\n\tvec3 Fr = max( vec3( 1.0 - roughness ), F0 ) - F0;\n\treturn Fr * fresnel + F0;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + viewDir );\n\tfloat dotNL = saturate( dot( normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tfloat dotNH = saturate( dot( normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( normal, viewDir ) );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\treturn specularColor * brdf.x + brdf.y;\n}\nvoid BRDF_Specular_Multiscattering_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tvec3 F = F_Schlick_RoughnessDependent( specularColor, dotNV, roughness );\n\tvec2 brdf = integrateSpecularBRDF( dotNV, roughness );\n\tvec3 FssEss = F * brdf.x + brdf.y;\n\tfloat Ess = brdf.x + brdf.y;\n\tfloat Ems = 1.0 - Ess;\n\tvec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;\tvec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );\n\tsingleScatter += FssEss;\n\tmultiScatter += Fms * Ems;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n#if defined( USE_SHEEN )\nfloat D_Charlie(float roughness, float NoH) {\n\tfloat invAlpha = 1.0 / roughness;\n\tfloat cos2h = NoH * NoH;\n\tfloat sin2h = max(1.0 - cos2h, 0.0078125);\treturn (2.0 + invAlpha) * pow(sin2h, invAlpha * 0.5) / (2.0 * PI);\n}\nfloat V_Neubelt(float NoV, float NoL) {\n\treturn saturate(1.0 / (4.0 * (NoL + NoV - NoL * NoV)));\n}\nvec3 BRDF_Specular_Sheen( const in float roughness, const in vec3 L, const in GeometricContext geometry, vec3 specularColor ) {\n\tvec3 N = geometry.normal;\n\tvec3 V = geometry.viewDir;\n\tvec3 H = normalize( V + L );\n\tfloat dotNH = saturate( dot( N, H ) );\n\treturn specularColor * D_Charlie( roughness, dotNH ) * V_Neubelt( dot(N, V), dot(N, L) );\n}\n#endif",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 ) * faceDirection;\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#pragma unroll_loop_end\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\t#pragma unroll_loop_end\n\t\tif ( clipped ) discard;\n\t#endif\n#endif",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvarying vec3 vClipPosition;\n#endif",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0\n\tvClipPosition = - mvPosition.xyz;\n#endif",color_fragment:"#if defined( USE_COLOR_ALPHA )\n\tdiffuseColor *= vColor;\n#elif defined( USE_COLOR )\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR )\n\tvarying vec3 vColor;\n#endif",color_pars_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvarying vec4 vColor;\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvarying vec3 vColor;\n#endif",color_vertex:"#if defined( USE_COLOR_ALPHA )\n\tvColor = vec4( 1.0 );\n#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )\n\tvColor = vec3( 1.0 );\n#endif\n#ifdef USE_COLOR\n\tvColor *= color;\n#endif\n#ifdef USE_INSTANCING_COLOR\n\tvColor.xyz *= instanceColor.xyz;\n#endif",common:"#define PI 3.141592653589793\n#define PI2 6.283185307179586\n#define PI_HALF 1.5707963267948966\n#define RECIPROCAL_PI 0.3183098861837907\n#define RECIPROCAL_PI2 0.15915494309189535\n#define EPSILON 1e-6\n#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\n#define whiteComplement(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\n#ifdef HIGH_PRECISION\n\tfloat precisionSafeLength( vec3 v ) { return length( v ); }\n#else\n\tfloat max3( vec3 v ) { return max( max( v.x, v.y ), v.z ); }\n\tfloat precisionSafeLength( vec3 v ) {\n\t\tfloat maxComponent = max3( abs( v ) );\n\t\treturn length( v / maxComponent ) * maxComponent;\n\t}\n#endif\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n#ifdef CLEARCOAT\n\tvec3 clearcoatNormal;\n#endif\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\nbool isPerspectiveMatrix( mat4 m ) {\n\treturn m[ 2 ][ 3 ] == - 1.0;\n}\nvec2 equirectUv( in vec3 dir ) {\n\tfloat u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;\n\tfloat v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\treturn vec2( u, v );\n}",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n\t#define cubeUV_maxMipLevel 8.0\n\t#define cubeUV_minMipLevel 4.0\n\t#define cubeUV_maxTileSize 256.0\n\t#define cubeUV_minTileSize 16.0\n\tfloat getFace( vec3 direction ) {\n\t\tvec3 absDirection = abs( direction );\n\t\tfloat face = - 1.0;\n\t\tif ( absDirection.x > absDirection.z ) {\n\t\t\tif ( absDirection.x > absDirection.y )\n\t\t\t\tface = direction.x > 0.0 ? 0.0 : 3.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t} else {\n\t\t\tif ( absDirection.z > absDirection.y )\n\t\t\t\tface = direction.z > 0.0 ? 2.0 : 5.0;\n\t\t\telse\n\t\t\t\tface = direction.y > 0.0 ? 1.0 : 4.0;\n\t\t}\n\t\treturn face;\n\t}\n\tvec2 getUV( vec3 direction, float face ) {\n\t\tvec2 uv;\n\t\tif ( face == 0.0 ) {\n\t\t\tuv = vec2( direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 1.0 ) {\n\t\t\tuv = vec2( - direction.x, - direction.z ) / abs( direction.y );\n\t\t} else if ( face == 2.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.y ) / abs( direction.z );\n\t\t} else if ( face == 3.0 ) {\n\t\t\tuv = vec2( - direction.z, direction.y ) / abs( direction.x );\n\t\t} else if ( face == 4.0 ) {\n\t\t\tuv = vec2( - direction.x, direction.z ) / abs( direction.y );\n\t\t} else {\n\t\t\tuv = vec2( direction.x, direction.y ) / abs( direction.z );\n\t\t}\n\t\treturn 0.5 * ( uv + 1.0 );\n\t}\n\tvec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {\n\t\tfloat face = getFace( direction );\n\t\tfloat filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );\n\t\tmipInt = max( mipInt, cubeUV_minMipLevel );\n\t\tfloat faceSize = exp2( mipInt );\n\t\tfloat texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );\n\t\tvec2 uv = getUV( direction, face ) * ( faceSize - 1.0 );\n\t\tvec2 f = fract( uv );\n\t\tuv += 0.5 - f;\n\t\tif ( face > 2.0 ) {\n\t\t\tuv.y += faceSize;\n\t\t\tface -= 3.0;\n\t\t}\n\t\tuv.x += face * faceSize;\n\t\tif ( mipInt < cubeUV_maxMipLevel ) {\n\t\t\tuv.y += 2.0 * cubeUV_maxTileSize;\n\t\t}\n\t\tuv.y += filterInt * 2.0 * cubeUV_minTileSize;\n\t\tuv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );\n\t\tuv *= texelSize;\n\t\tvec3 tl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x += texelSize;\n\t\tvec3 tr = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.y += texelSize;\n\t\tvec3 br = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tuv.x -= texelSize;\n\t\tvec3 bl = envMapTexelToLinear( texture2D( envMap, uv ) ).rgb;\n\t\tvec3 tm = mix( tl, tr, f.x );\n\t\tvec3 bm = mix( bl, br, f.x );\n\t\treturn mix( tm, bm, f.y );\n\t}\n\t#define r0 1.0\n\t#define v0 0.339\n\t#define m0 - 2.0\n\t#define r1 0.8\n\t#define v1 0.276\n\t#define m1 - 1.0\n\t#define r4 0.4\n\t#define v4 0.046\n\t#define m4 2.0\n\t#define r5 0.305\n\t#define v5 0.016\n\t#define m5 3.0\n\t#define r6 0.21\n\t#define v6 0.0038\n\t#define m6 4.0\n\tfloat roughnessToMip( float roughness ) {\n\t\tfloat mip = 0.0;\n\t\tif ( roughness >= r1 ) {\n\t\t\tmip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;\n\t\t} else if ( roughness >= r4 ) {\n\t\t\tmip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;\n\t\t} else if ( roughness >= r5 ) {\n\t\t\tmip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;\n\t\t} else if ( roughness >= r6 ) {\n\t\t\tmip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;\n\t\t} else {\n\t\t\tmip = - 2.0 * log2( 1.16 * roughness );\t\t}\n\t\treturn mip;\n\t}\n\tvec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {\n\t\tfloat mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );\n\t\tfloat mipF = fract( mip );\n\t\tfloat mipInt = floor( mip );\n\t\tvec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );\n\t\tif ( mipF == 0.0 ) {\n\t\t\treturn vec4( color0, 1.0 );\n\t\t} else {\n\t\t\tvec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );\n\t\t\treturn vec4( mix( color0, color1, mipF ), 1.0 );\n\t\t}\n\t}\n#endif",defaultnormal_vertex:"vec3 transformedNormal = objectNormal;\n#ifdef USE_INSTANCING\n\tmat3 m = mat3( instanceMatrix );\n\ttransformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );\n\ttransformedNormal = m * transformedNormal;\n#endif\ntransformedNormal = normalMatrix * transformedNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n#ifdef USE_TANGENT\n\tvec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#ifdef FLIP_SIDED\n\t\ttransformedTangent = - transformedTangent;\n\t#endif\n#endif",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );\n#endif",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif",encodings_fragment:"gl_FragColor = linearToOutputTexel( gl_FragColor );",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( gammaFactor ) ), value.a );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.rgb, vec3( 1.0 / gammaFactor ) ), value.a );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * value.a * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat M = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.r, max( value.g, value.b ) );\n\tfloat D = max( maxRange / maxRGB, 1.0 );\n\tD = clamp( floor( D ) / 255.0, 0.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value ) {\n\tvec3 Xp_Y_XYZp = cLogLuvM * value.rgb;\n\tXp_Y_XYZp = max( Xp_Y_XYZp, vec3( 1e-6, 1e-6, 1e-6 ) );\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract( Le );\n\tvResult.z = ( Le - ( floor( vResult.w * 255.0 ) ) / 255.0 ) / 255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2( ( Le - 127.0 ) / 2.0 );\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = cLogLuvInverseM * Xp_Y_XYZp.rgb;\n\treturn vec4( max( vRGB, 0.0 ), 1.0 );\n}",envmap_fragment:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvec3 cameraToFrag;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToFrag = normalize( vWorldPosition - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToFrag, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\tvec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\t#ifndef ENVMAP_TYPE_CUBE_UV\n\t\tenvColor = envMapTexelToLinear( envColor );\n\t#endif\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif",envmap_common_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float envMapIntensity;\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\t\n#endif",envmap_pars_fragment:"#ifdef USE_ENVMAP\n\tuniform float reflectivity;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\tvarying vec3 vWorldPosition;\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )\n\t\t#define ENV_WORLDPOS\n\t#endif\n\t#ifdef ENV_WORLDPOS\n\t\t\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif",envmap_physical_pars_fragment:"#if defined( USE_ENVMAP )\n\t#ifdef ENVMAP_MODE_REFRACTION\n\t\tuniform float refractionRatio;\n\t#endif\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float roughness, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat sigma = PI * roughness * roughness / ( 1.0 + roughness );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + log2( sigma );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -viewDir, normal );\n\t\t\treflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -viewDir, normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( roughness, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif",envmap_vertex:"#ifdef USE_ENVMAP\n\t#ifdef ENV_WORLDPOS\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex;\n\t\tif ( isOrthographic ) {\n\t\t\tcameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );\n\t\t} else {\n\t\t\tcameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\t}\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif",fog_vertex:"#ifdef USE_FOG\n\tfogDepth = - mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n\tvarying float fogDepth;\n#endif",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = 1.0 - exp( - fogDensity * fogDensity * fogDepth * fogDepth );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif",gradientmap_pars_fragment:"#ifdef USE_GRADIENTMAP\n\tuniform sampler2D gradientMap;\n#endif\nvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\tfloat dotNL = dot( normal, lightDirection );\n\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t#ifdef USE_GRADIENTMAP\n\t\treturn texture2D( gradientMap, coord ).rgb;\n\t#else\n\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t#endif\n}",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\treflectedLight.indirectDiffuse += PI * lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n#endif",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\nvIndirectFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n\tvIndirectBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\nvIndirectFront += getAmbientLightIrradiance( ambientLightColor );\nvIndirectFront += getLightProbeIrradiance( lightProbe, geometry );\n#ifdef DOUBLE_SIDED\n\tvIndirectBack += getAmbientLightIrradiance( ambientLightColor );\n\tvIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry );\n#endif\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n\t#pragma unroll_loop_end\n#endif",lights_pars_begin:"uniform bool receiveShadow;\nuniform vec3 ambientLightColor;\nuniform vec3 lightProbe[ 9 ];\nvec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {\n\tfloat x = normal.x, y = normal.y, z = normal.z;\n\tvec3 result = shCoefficients[ 0 ] * 0.886227;\n\tresult += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;\n\tresult += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;\n\tresult += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;\n\tresult += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;\n\tresult += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;\n\tresult += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );\n\tresult += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;\n\tresult += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );\n\treturn result;\n}\nvec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in GeometricContext geometry ) {\n\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\tvec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );\n\treturn irradiance;\n}\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif",lights_toon_fragment:"ToonMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;",lights_toon_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct ToonMaterial {\n\tvec3 diffuseColor;\n};\nvoid RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_Toon\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Toon\n#define Material_LightProbeLOD( material )\t(0)",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3 diffuseColor;\n\tvec3 specularColor;\n\tfloat specularShininess;\n\tfloat specularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nvec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );\nfloat geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );\nmaterial.specularRoughness = max( roughnessFactor, 0.0525 );material.specularRoughness += geometryRoughness;\nmaterial.specularRoughness = min( material.specularRoughness, 1.0 );\n#ifdef REFLECTIVITY\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#endif\n#ifdef CLEARCOAT\n\tmaterial.clearcoat = clearcoat;\n\tmaterial.clearcoatRoughness = clearcoatRoughness;\n\t#ifdef USE_CLEARCOATMAP\n\t\tmaterial.clearcoat *= texture2D( clearcoatMap, vUv ).x;\n\t#endif\n\t#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\t\tmaterial.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;\n\t#endif\n\tmaterial.clearcoat = saturate( material.clearcoat );\tmaterial.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );\n\tmaterial.clearcoatRoughness += geometryRoughness;\n\tmaterial.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );\n#endif\n#ifdef USE_SHEEN\n\tmaterial.sheenColor = sheen;\n#endif",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3 diffuseColor;\n\tfloat specularRoughness;\n\tvec3 specularColor;\n#ifdef CLEARCOAT\n\tfloat clearcoat;\n\tfloat clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tvec3 sheenColor;\n#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearcoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos + halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos - halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos - halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos + halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNL = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );\n\t\tvec3 ccIrradiance = ccDotNL * directLight.color;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tccIrradiance *= PI;\n\t\t#endif\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t\treflectedLight.directSpecular += ccIrradiance * material.clearcoat * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\t#ifdef USE_SHEEN\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_Sheen(\n\t\t\tmaterial.specularRoughness,\n\t\t\tdirectLight.direction,\n\t\t\tgeometry,\n\t\t\tmaterial.sheenColor\n\t\t);\n\t#else\n\t\treflectedLight.directSpecular += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry.viewDir, geometry.normal, material.specularColor, material.specularRoughness);\n\t#endif\n\treflectedLight.directDiffuse += ( 1.0 - clearcoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {\n\t#ifdef CLEARCOAT\n\t\tfloat ccDotNV = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular += clearcoatRadiance * material.clearcoat * BRDF_Specular_GGX_Environment( geometry.viewDir, geometry.clearcoatNormal, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearcoatRoughness );\n\t\tfloat ccDotNL = ccDotNV;\n\t\tfloat clearcoatDHR = material.clearcoat * clearcoatDHRApprox( material.clearcoatRoughness, ccDotNL );\n\t#else\n\t\tfloat clearcoatDHR = 0.0;\n\t#endif\n\tfloat clearcoatInv = 1.0 - clearcoatDHR;\n\tvec3 singleScattering = vec3( 0.0 );\n\tvec3 multiScattering = vec3( 0.0 );\n\tvec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;\n\tBRDF_Specular_Multiscattering_Environment( geometry, material.specularColor, material.specularRoughness, singleScattering, multiScattering );\n\tvec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );\n\treflectedLight.indirectSpecular += clearcoatInv * radiance * singleScattering;\n\treflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;\n\treflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );\n#ifdef CLEARCOAT\n\tgeometry.clearcoatNormal = clearcoatNormal;\n#endif\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )\n\t\tpointLightShadow = pointLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )\n\t\tspotLightShadow = spotLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLightShadow;\n\t#endif\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )\n\t\tdirectionalLightShadow = directionalLightShadows[ i ];\n\t\tdirectLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n\t#pragma unroll_loop_end\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 iblIrradiance = vec3( 0.0 );\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\tirradiance += getLightProbeIrradiance( lightProbe, geometry );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop_start\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t\t#pragma unroll_loop_end\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearcoatRadiance = vec3( 0.0 );\n#endif",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\tvec3 lightMapIrradiance = lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tiblIrradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.normal, material.specularRoughness, maxMipLevel );\n\t#ifdef CLEARCOAT\n\t\tclearcoatRadiance += getLightProbeIndirectRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness, maxMipLevel );\n\t#endif\n#endif",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );\n#endif",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tuniform float logDepthBufFC;\n\tvarying float vFragDepth;\n\tvarying float vIsPerspective;\n#endif",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t\tvarying float vIsPerspective;\n\t#else\n\t\tuniform float logDepthBufFC;\n\t#endif\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t\tvIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );\n\t#else\n\t\tif ( isPerspectiveMatrix( projectionMatrix ) ) {\n\t\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\t\tgl_Position.z *= gl_Position.w;\n\t\t}\n\t#endif\n#endif",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif",map_particle_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n#endif\n#ifdef USE_MAP\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, uv ).g;\n#endif",map_particle_pars_fragment:"#if defined( USE_MAP ) || defined( USE_ALPHAMAP )\n\tuniform mat3 uvTransform;\n#endif\n#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal *= morphTargetBaseInfluence;\n\tobjectNormal += morphNormal0 * morphTargetInfluences[ 0 ];\n\tobjectNormal += morphNormal1 * morphTargetInfluences[ 1 ];\n\tobjectNormal += morphNormal2 * morphTargetInfluences[ 2 ];\n\tobjectNormal += morphNormal3 * morphTargetInfluences[ 3 ];\n#endif",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\tuniform float morphTargetBaseInfluence;\n\t#ifndef USE_MORPHNORMALS\n\t\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\t\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed *= morphTargetBaseInfluence;\n\ttransformed += morphTarget0 * morphTargetInfluences[ 0 ];\n\ttransformed += morphTarget1 * morphTargetInfluences[ 1 ];\n\ttransformed += morphTarget2 * morphTargetInfluences[ 2 ];\n\ttransformed += morphTarget3 * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\t\ttransformed += morphTarget4 * morphTargetInfluences[ 4 ];\n\t\ttransformed += morphTarget5 * morphTargetInfluences[ 5 ];\n\t\ttransformed += morphTarget6 * morphTargetInfluences[ 6 ];\n\t\ttransformed += morphTarget7 * morphTargetInfluences[ 7 ];\n\t#endif\n#endif",normal_fragment_begin:"float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;\n#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\t#ifdef USE_TANGENT\n\t\tvec3 tangent = normalize( vTangent );\n\t\tvec3 bitangent = normalize( vBitangent );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\ttangent = tangent * faceDirection;\n\t\t\tbitangent = bitangent * faceDirection;\n\t\t#endif\n\t\t#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )\n\t\t\tmat3 vTBN = mat3( tangent, bitangent, normal );\n\t\t#endif\n\t#endif\n#endif\nvec3 geometryNormal = normal;",normal_fragment_maps:"#ifdef OBJECTSPACE_NORMALMAP\n\tnormal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t#ifdef FLIP_SIDED\n\t\tnormal = - normal;\n\t#endif\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * faceDirection;\n\t#endif\n\tnormal = normalize( normalMatrix * normal );\n#elif defined( TANGENTSPACE_NORMALMAP )\n\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\tmapN.xy *= normalScale;\n\t#ifdef USE_TANGENT\n\t\tnormal = normalize( vTBN * mapN );\n\t#else\n\t\tnormal = perturbNormal2Arb( -vViewPosition, normal, mapN, faceDirection );\n\t#endif\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd(), faceDirection );\n#endif",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n#endif\n#ifdef OBJECTSPACE_NORMALMAP\n\tuniform mat3 normalMatrix;\n#endif\n#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tvec3 N = surf_norm;\n\t\tvec3 q1perp = cross( q1, N );\n\t\tvec3 q0perp = cross( N, q0 );\n\t\tvec3 T = q1perp * st0.x + q0perp * st1.x;\n\t\tvec3 B = q1perp * st0.y + q0perp * st1.y;\n\t\tfloat det = max( dot( T, T ), dot( B, B ) );\n\t\tfloat scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );\n\t\treturn normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );\n\t}\n#endif",clearcoat_normal_fragment_begin:"#ifdef CLEARCOAT\n\tvec3 clearcoatNormal = geometryNormal;\n#endif",clearcoat_normal_fragment_maps:"#ifdef USE_CLEARCOAT_NORMALMAP\n\tvec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;\n\tclearcoatMapN.xy *= clearcoatNormalScale;\n\t#ifdef USE_TANGENT\n\t\tclearcoatNormal = normalize( vTBN * clearcoatMapN );\n\t#else\n\t\tclearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );\n\t#endif\n#endif",clearcoat_pars_fragment:"#ifdef USE_CLEARCOATMAP\n\tuniform sampler2D clearcoatMap;\n#endif\n#ifdef USE_CLEARCOAT_ROUGHNESSMAP\n\tuniform sampler2D clearcoatRoughnessMap;\n#endif\n#ifdef USE_CLEARCOAT_NORMALMAP\n\tuniform sampler2D clearcoatNormalMap;\n\tuniform vec2 clearcoatNormalScale;\n#endif",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nvec4 pack2HalfToRGBA( vec2 v ) {\n\tvec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ));\n\treturn vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w);\n}\nvec2 unpackRGBATo2Half( vec4 v ) {\n\treturn vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif",project_vertex:"vec4 mvPosition = vec4( transformed, 1.0 );\n#ifdef USE_INSTANCING\n\tmvPosition = instanceMatrix * mvPosition;\n#endif\nmvPosition = modelViewMatrix * mvPosition;\ngl_Position = projectionMatrix * mvPosition;",dithering_fragment:"#ifdef DITHERING\n\tgl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif",dithering_pars_fragment:"#ifdef DITHERING\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tvec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {\n\t\treturn unpackRGBATo2Half( texture2D( shadow, uv ) );\n\t}\n\tfloat VSMShadow (sampler2D shadow, vec2 uv, float compare ){\n\t\tfloat occlusion = 1.0;\n\t\tvec2 distribution = texture2DDistribution( shadow, uv );\n\t\tfloat hard_shadow = step( compare , distribution.x );\n\t\tif (hard_shadow != 1.0 ) {\n\t\t\tfloat distance = compare - distribution.x ;\n\t\t\tfloat variance = max( 0.00000, distribution.y * distribution.y );\n\t\t\tfloat softness_probability = variance / (variance + distance * distance );\t\t\tsoftness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );\t\t\tocclusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );\n\t\t}\n\t\treturn occlusion;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tfloat dx2 = dx0 / 2.0;\n\t\t\tfloat dy2 = dy0 / 2.0;\n\t\t\tfloat dx3 = dx1 / 2.0;\n\t\t\tfloat dy3 = dy1 / 2.0;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 17.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx = texelSize.x;\n\t\t\tfloat dy = texelSize.y;\n\t\t\tvec2 uv = shadowCoord.xy;\n\t\t\tvec2 f = fract( uv * shadowMapSize + 0.5 );\n\t\t\tuv -= f * texelSize;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, uv, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),\n\t\t\t\t\t f.x ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t f.y ) +\n\t\t\t\tmix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), \n\t\t\t\t\t\t  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),\n\t\t\t\t\t\t  f.x ),\n\t\t\t\t\t f.y )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_VSM )\n\t\t\tshadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];\n\t\tstruct DirectionalLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];\n\t\tstruct SpotLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t};\n\t\tuniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];\n\t\tstruct PointLightShadow {\n\t\t\tfloat shadowBias;\n\t\t\tfloat shadowNormalBias;\n\t\t\tfloat shadowRadius;\n\t\t\tvec2 shadowMapSize;\n\t\t\tfloat shadowCameraNear;\n\t\t\tfloat shadowCameraFar;\n\t\t};\n\t\tuniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];\n\t#endif\n#endif",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0\n\t\tvec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\tvec4 shadowWorldPosition;\n\t#endif\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tshadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n#endif",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHT_SHADOWS > 0\n\tDirectionalLightShadow directionalLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {\n\t\tdirectionalLight = directionalLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_SPOT_LIGHT_SHADOWS > 0\n\tSpotLightShadow spotLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {\n\t\tspotLight = spotLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#if NUM_POINT_LIGHT_SHADOWS > 0\n\tPointLightShadow pointLight;\n\t#pragma unroll_loop_start\n\tfor ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {\n\t\tpointLight = pointLightShadows[ i ];\n\t\tshadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#pragma unroll_loop_end\n\t#endif\n\t#endif\n\treturn shadow;\n}",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform highp sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n\t#ifdef USE_TANGENT\n\t\tobjectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;\n\t#endif\n#endif",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n\tgl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif",tonemapping_pars_fragment:"#ifndef saturate\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\nvec3 RRTAndODTFit( vec3 v ) {\n\tvec3 a = v * ( v + 0.0245786 ) - 0.000090537;\n\tvec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;\n\treturn a / b;\n}\nvec3 ACESFilmicToneMapping( vec3 color ) {\n\tconst mat3 ACESInputMat = mat3(\n\t\tvec3( 0.59719, 0.07600, 0.02840 ),\t\tvec3( 0.35458, 0.90834, 0.13383 ),\n\t\tvec3( 0.04823, 0.01566, 0.83777 )\n\t);\n\tconst mat3 ACESOutputMat = mat3(\n\t\tvec3(  1.60475, -0.10208, -0.00327 ),\t\tvec3( -0.53108,  1.10813, -0.07276 ),\n\t\tvec3( -0.07367, -0.00605,  1.07602 )\n\t);\n\tcolor *= toneMappingExposure / 0.6;\n\tcolor = ACESInputMat * color;\n\tcolor = RRTAndODTFit( color );\n\tcolor = ACESOutputMat * color;\n\treturn saturate( color );\n}\nvec3 CustomToneMapping( vec3 color ) { return color; }",transmissionmap_fragment:"#ifdef USE_TRANSMISSIONMAP\n\ttotalTransmission *= texture2D( transmissionMap, vUv ).r;\n#endif",transmissionmap_pars_fragment:"#ifdef USE_TRANSMISSIONMAP\n\tuniform sampler2D transmissionMap;\n#endif",uv_pars_fragment:"#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#ifdef USE_UV\n\t#ifdef UVS_VERTEX_ONLY\n\t\tvec2 vUv;\n\t#else\n\t\tvarying vec2 vUv;\n\t#endif\n\tuniform mat3 uvTransform;\n#endif",uv_vertex:"#ifdef USE_UV\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n\tuniform mat3 uv2Transform;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = vec4( transformed, 1.0 );\n\t#ifdef USE_INSTANCING\n\t\tworldPosition = instanceMatrix * worldPosition;\n\t#endif\n\tworldPosition = modelMatrix * worldPosition;\n#endif",background_frag:"uniform sampler2D t2D;\nvarying vec2 vUv;\nvoid main() {\n\tvec4 texColor = texture2D( t2D, vUv );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",background_vert:"varying vec2 vUv;\nuniform mat3 uvTransform;\nvoid main() {\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n\tgl_Position = vec4( position.xy, 1.0, 1.0 );\n}",cube_frag:"#include <envmap_common_pars_fragment>\nuniform float opacity;\nvarying vec3 vWorldDirection;\n#include <cube_uv_reflection_fragment>\nvoid main() {\n\tvec3 vReflect = vWorldDirection;\n\t#include <envmap_fragment>\n\tgl_FragColor = envColor;\n\tgl_FragColor.a *= opacity;\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",cube_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\tfloat fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( fragCoordZ );\n\t#endif\n}",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvarying vec2 vHighPrecisionZW;\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvHighPrecisionZW = gl_Position.zw;\n}",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldDirection );\n\tvec2 sampleUV = equirectUv( direction );\n\tvec4 texColor = texture2D( tEquirect, sampleUV );\n\tgl_FragColor = mapTexelToLinear( texColor );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n}",equirect_vert:"varying vec3 vWorldDirection;\n#include <common>\nvoid main() {\n\tvWorldDirection = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\tvLineDistance = scale * lineDistance;\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\n\t\tvec4 lightMapTexel= texture2D( lightMap, vUv2 );\n\t\treflectedLight.indirectDiffuse += lightMapTexelToLinear( lightMapTexel ).rgb * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;\n\t#else\n\t\treflectedLight.indirectDiffuse += vIndirectFront;\n\t#endif\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\nvarying vec3 vIndirectFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n\tvarying vec3 vIndirectBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshmatcap_frag:"#define MATCAP\nuniform vec3 diffuse;\nuniform float opacity;\nuniform sampler2D matcap;\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tvec3 viewDir = normalize( vViewPosition );\n\tvec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );\n\tvec3 y = cross( viewDir, x );\n\tvec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;\n\t#ifdef USE_MATCAP\n\t\tvec4 matcapColor = texture2D( matcap, uv );\n\t\tmatcapColor = matcapTexelToLinear( matcapColor );\n\t#else\n\t\tvec4 matcapColor = vec4( 1.0 );\n\t#endif\n\tvec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshmatcap_vert:"#define MATCAP\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <color_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#ifndef FLAT_SHADED\n\t\tvNormal = normalize( transformedNormal );\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n\tvViewPosition = - mvPosition.xyz;\n}",meshtoon_frag:"#define TOON\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_toon_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_toon_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshtoon_vert:"#define TOON\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",meshphysical_frag:"#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <transmissionmap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#ifdef TRANSMISSION\n\t\tdiffuseColor.a *= mix( saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) ), 1.0, metalness );\n\t#endif\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",meshphysical_vert:"#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n}",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <project_vertex>\n\tgl_PointSize = size;\n\t#ifdef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <fog_vertex>\n}",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",shadow_vert:"#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",sprite_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",sprite_vert:"uniform float rotation;\nuniform vec2 center;\n#include <common>\n#include <uv_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\tvec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );\n\tvec2 scale;\n\tscale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );\n\tscale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );\n\t#ifndef USE_SIZEATTENUATION\n\t\tbool isPerspective = isPerspectiveMatrix( projectionMatrix );\n\t\tif ( isPerspective ) scale *= - mvPosition.z;\n\t#endif\n\tvec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;\n\tvec2 rotatedPosition;\n\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;\n\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;\n\tmvPosition.xy += rotatedPosition;\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}"},yi={common:{diffuse:{value:new cn(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new Te},uv2Transform:{value:new Te},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new Se(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new cn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new cn(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Te}},sprite:{diffuse:{value:new cn(15658734)},opacity:{value:1},center:{value:new Se(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},uvTransform:{value:new Te}}},xi={basic:{uniforms:ei([yi.common,yi.specularmap,yi.envmap,yi.aomap,yi.lightmap,yi.fog]),vertexShader:gi.meshbasic_vert,fragmentShader:gi.meshbasic_frag},lambert:{uniforms:ei([yi.common,yi.specularmap,yi.envmap,yi.aomap,yi.lightmap,yi.emissivemap,yi.fog,yi.lights,{emissive:{value:new cn(0)}}]),vertexShader:gi.meshlambert_vert,fragmentShader:gi.meshlambert_frag},phong:{uniforms:ei([yi.common,yi.specularmap,yi.envmap,yi.aomap,yi.lightmap,yi.emissivemap,yi.bumpmap,yi.normalmap,yi.displacementmap,yi.fog,yi.lights,{emissive:{value:new cn(0)},specular:{value:new cn(1118481)},shininess:{value:30}}]),vertexShader:gi.meshphong_vert,fragmentShader:gi.meshphong_frag},standard:{uniforms:ei([yi.common,yi.envmap,yi.aomap,yi.lightmap,yi.emissivemap,yi.bumpmap,yi.normalmap,yi.displacementmap,yi.roughnessmap,yi.metalnessmap,yi.fog,yi.lights,{emissive:{value:new cn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:gi.meshphysical_vert,fragmentShader:gi.meshphysical_frag},toon:{uniforms:ei([yi.common,yi.aomap,yi.lightmap,yi.emissivemap,yi.bumpmap,yi.normalmap,yi.displacementmap,yi.gradientmap,yi.fog,yi.lights,{emissive:{value:new cn(0)}}]),vertexShader:gi.meshtoon_vert,fragmentShader:gi.meshtoon_frag},matcap:{uniforms:ei([yi.common,yi.bumpmap,yi.normalmap,yi.displacementmap,yi.fog,{matcap:{value:null}}]),vertexShader:gi.meshmatcap_vert,fragmentShader:gi.meshmatcap_frag},points:{uniforms:ei([yi.points,yi.fog]),vertexShader:gi.points_vert,fragmentShader:gi.points_frag},dashed:{uniforms:ei([yi.common,yi.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:gi.linedashed_vert,fragmentShader:gi.linedashed_frag},depth:{uniforms:ei([yi.common,yi.displacementmap]),vertexShader:gi.depth_vert,fragmentShader:gi.depth_frag},normal:{uniforms:ei([yi.common,yi.bumpmap,yi.normalmap,yi.displacementmap,{opacity:{value:1}}]),vertexShader:gi.normal_vert,fragmentShader:gi.normal_frag},sprite:{uniforms:ei([yi.sprite,yi.fog]),vertexShader:gi.sprite_vert,fragmentShader:gi.sprite_frag},background:{uniforms:{uvTransform:{value:new Te},t2D:{value:null}},vertexShader:gi.background_vert,fragmentShader:gi.background_frag},cube:{uniforms:ei([yi.envmap,{opacity:{value:1}}]),vertexShader:gi.cube_vert,fragmentShader:gi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:gi.equirect_vert,fragmentShader:gi.equirect_frag},distanceRGBA:{uniforms:ei([yi.common,yi.displacementmap,{referencePosition:{value:new Ie},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:gi.distanceRGBA_vert,fragmentShader:gi.distanceRGBA_frag},shadow:{uniforms:ei([yi.lights,yi.fog,{color:{value:new cn(0)},opacity:{value:1}}]),vertexShader:gi.shadow_vert,fragmentShader:gi.shadow_frag}};function bi(e,t,n,r,o){var l,c,h=new cn(0),d=0,f=null,m=0,v=null;function y(e,t){n.buffers.color.setClear(e.r,e.g,e.b,t,o)}return{getClearColor:function(){return h},setClearColor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;h.set(e),y(h,d=t)},getClearAlpha:function(){return d},setClearAlpha:function(e){y(h,d=e)},render:function(n,o,x,_){var w=!0===o.isScene?o.background:null;w&&w.isTexture&&(w=t.get(w));var M=e.xr,S=M.getSession&&M.getSession();S&&"additive"===S.environmentBlendMode&&(w=null),null===w?y(h,d):w&&w.isColor&&(y(w,1),_=!0),(e.autoClear||_)&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),w&&(w.isCubeTexture||w.mapping===D)?(void 0===c&&((c=new Jn(new Kn(1,1,1),new ni({name:"BackgroundCubeMaterial",uniforms:Qn(xi.cube.uniforms),vertexShader:xi.cube.vertexShader,fragmentShader:xi.cube.fragmentShader,side:1,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),c.geometry.deleteAttribute("uv"),c.onBeforeRender=function(e,t,n){this.matrixWorld.copyPosition(n.matrixWorld)},Object.defineProperty(c.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),r.update(c)),c.material.uniforms.envMap.value=w,c.material.uniforms.flipEnvMap.value=w.isCubeTexture&&w._needsFlipEnvMap?-1:1,f===w&&m===w.version&&v===e.toneMapping||(c.material.needsUpdate=!0,f=w,m=w.version,v=e.toneMapping),n.unshift(c,c.geometry,c.material,0,0,null)):w&&w.isTexture&&(void 0===l&&((l=new Jn(new vi(2,2),new ni({name:"BackgroundMaterial",uniforms:Qn(xi.background.uniforms),vertexShader:xi.background.vertexShader,fragmentShader:xi.background.fragmentShader,side:0,depthTest:!1,depthWrite:!1,fog:!1}))).geometry.deleteAttribute("normal"),Object.defineProperty(l.material,"map",{get:function(){return this.uniforms.t2D.value}}),r.update(l)),l.material.uniforms.t2D.value=w,!0===w.matrixAutoUpdate&&w.updateMatrix(),l.material.uniforms.uvTransform.value.copy(w.matrix),f===w&&m===w.version&&v===e.toneMapping||(l.material.needsUpdate=!0,f=w,m=w.version,v=e.toneMapping),n.unshift(l,l.geometry,l.material,0,0,null))}}}function _i(e,t,n,r){var o=e.getParameter(34921),l=r.isWebGL2?null:t.get("OES_vertex_array_object"),c=r.isWebGL2||null!==l,h={},d=y(null),f=d;function m(t){return r.isWebGL2?e.bindVertexArray(t):l.bindVertexArrayOES(t)}function v(t){return r.isWebGL2?e.deleteVertexArray(t):l.deleteVertexArrayOES(t)}function y(e){for(var t=[],n=[],r=[],l=0;l<o;l++)t[l]=0,n[l]=0,r[l]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:t,enabledAttributes:n,attributeDivisors:r,object:e,attributes:{},index:null}}function x(){for(var e=f.newAttributes,t=0,n=e.length;t<n;t++)e[t]=0}function _(e){w(e,0)}function w(n,o){var l=f.newAttributes,c=f.enabledAttributes,h=f.attributeDivisors;(l[n]=1,0===c[n]&&(e.enableVertexAttribArray(n),c[n]=1),h[n]!==o)&&((r.isWebGL2?e:t.get("ANGLE_instanced_arrays"))[r.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](n,o),h[n]=o)}function M(){for(var t=f.newAttributes,n=f.enabledAttributes,r=0,o=n.length;r<o;r++)n[r]!==t[r]&&(e.disableVertexAttribArray(r),n[r]=0)}function S(t,n,o,l,c,h){!0!==r.isWebGL2||5124!==o&&5125!==o?e.vertexAttribPointer(t,n,o,l,c,h):e.vertexAttribIPointer(t,n,o,c,h)}function E(){T(),f!==d&&m((f=d).object)}function T(){d.geometry=null,d.program=null,d.wireframe=!1}return{setup:function(object,o,d,v,E){var T=!1;if(c){var C=function(t,n,o){var c=!0===o.wireframe,d=h[t.id];void 0===d&&(d={},h[t.id]=d);var f=d[n.id];void 0===f&&(f={},d[n.id]=f);var m=f[c];void 0===m&&(m=y(r.isWebGL2?e.createVertexArray():l.createVertexArrayOES()),f[c]=m);return m}(v,d,o);f!==C&&m((f=C).object),T=function(e,t){var n=f.attributes,r=e.attributes,o=0;for(var l in r){var c=n[l],h=r[l];if(void 0===c)return!0;if(c.attribute!==h)return!0;if(c.data!==h.data)return!0;o++}return f.attributesNum!==o||f.index!==t}(v,E),T&&function(e,t){var n={},r=e.attributes,o=0;for(var l in r){var c=r[l],data={};data.attribute=c,c.data&&(data.data=c.data),n[l]=data,o++}f.attributes=n,f.attributesNum=o,f.index=t}(v,E)}else{var L=!0===o.wireframe;f.geometry===v.id&&f.program===d.id&&f.wireframe===L||(f.geometry=v.id,f.program=d.id,f.wireframe=L,T=!0)}!0===object.isInstancedMesh&&(T=!0),null!==E&&n.update(E,34963),T&&(!function(object,o,l,c){if(!1===r.isWebGL2&&(object.isInstancedMesh||c.isInstancedBufferGeometry)&&null===t.get("ANGLE_instanced_arrays"))return;x();var h=c.attributes,d=l.getAttributes(),f=o.defaultAttributeValues;for(var m in d){var v=d[m];if(v>=0){var y=h[m];if(void 0!==y){var E=y.normalized,T=y.itemSize,C=n.get(y);if(void 0===C)continue;var L=C.buffer,A=C.type,R=C.bytesPerElement;if(y.isInterleavedBufferAttribute){var data=y.data,k=data.stride,P=y.offset;data&&data.isInstancedInterleavedBuffer?(w(v,data.meshPerAttribute),void 0===c._maxInstanceCount&&(c._maxInstanceCount=data.meshPerAttribute*data.count)):_(v),e.bindBuffer(34962,L),S(v,T,A,E,k*R,P*R)}else y.isInstancedBufferAttribute?(w(v,y.meshPerAttribute),void 0===c._maxInstanceCount&&(c._maxInstanceCount=y.meshPerAttribute*y.count)):_(v),e.bindBuffer(34962,L),S(v,T,A,E,0,0)}else if("instanceMatrix"===m){var O=n.get(object.instanceMatrix);if(void 0===O)continue;var I=O.buffer,D=O.type;w(v+0,1),w(v+1,1),w(v+2,1),w(v+3,1),e.bindBuffer(34962,I),e.vertexAttribPointer(v+0,4,D,!1,64,0),e.vertexAttribPointer(v+1,4,D,!1,64,16),e.vertexAttribPointer(v+2,4,D,!1,64,32),e.vertexAttribPointer(v+3,4,D,!1,64,48)}else if("instanceColor"===m){var N=n.get(object.instanceColor);if(void 0===N)continue;var H=N.buffer,z=N.type;w(v,1),e.bindBuffer(34962,H),e.vertexAttribPointer(v,3,z,!1,12,0)}else if(void 0!==f){var F=f[m];if(void 0!==F)switch(F.length){case 2:e.vertexAttrib2fv(v,F);break;case 3:e.vertexAttrib3fv(v,F);break;case 4:e.vertexAttrib4fv(v,F);break;default:e.vertexAttrib1fv(v,F)}}}}M()}(object,o,d,v),null!==E&&e.bindBuffer(34963,n.get(E).buffer))},reset:E,resetDefaultState:T,dispose:function(){for(var e in E(),h){var t=h[e];for(var n in t){var r=t[n];for(var o in r)v(r[o].object),delete r[o];delete t[n]}delete h[e]}},releaseStatesOfGeometry:function(e){if(void 0!==h[e.id]){var t=h[e.id];for(var n in t){var r=t[n];for(var o in r)v(r[o].object),delete r[o];delete t[n]}delete h[e.id]}},releaseStatesOfProgram:function(e){for(var t in h){var n=h[t];if(void 0!==n[e.id]){var r=n[e.id];for(var o in r)v(r[o].object),delete r[o];delete n[e.id]}}},initAttributes:x,enableAttribute:_,disableUnusedAttributes:M}}function wi(e,t,n,r){var o,l=r.isWebGL2;this.setMode=function(e){o=e},this.render=function(t,r){e.drawArrays(o,t,r),n.update(r,o,1)},this.renderInstances=function(r,c,h){if(0!==h){var d,f;if(l)d=e,f="drawArraysInstanced";else if(f="drawArraysInstancedANGLE",null===(d=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");d[f](o,r,c,h),n.update(c,o,h)}}}function Mi(e,t,n){var r;function o(t){if("highp"===t){if(e.getShaderPrecisionFormat(35633,36338).precision>0&&e.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";t="mediump"}return"mediump"===t&&e.getShaderPrecisionFormat(35633,36337).precision>0&&e.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}var l="undefined"!=typeof WebGL2RenderingContext&&e instanceof WebGL2RenderingContext||"undefined"!=typeof WebGL2ComputeRenderingContext&&e instanceof WebGL2ComputeRenderingContext,c=void 0!==n.precision?n.precision:"highp",h=o(c);h!==c&&(console.warn("THREE.WebGLRenderer:",c,"not supported, using",h,"instead."),c=h);var d=!0===n.logarithmicDepthBuffer,f=e.getParameter(34930),m=e.getParameter(35660),v=e.getParameter(3379),y=e.getParameter(34076),x=e.getParameter(34921),_=e.getParameter(36347),w=e.getParameter(36348),M=e.getParameter(36349),S=m>0,E=l||t.has("OES_texture_float");return{isWebGL2:l,getMaxAnisotropy:function(){if(void 0!==r)return r;if(!0===t.has("EXT_texture_filter_anisotropic")){var n=t.get("EXT_texture_filter_anisotropic");r=e.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else r=0;return r},getMaxPrecision:o,precision:c,logarithmicDepthBuffer:d,maxTextures:f,maxVertexTextures:m,maxTextureSize:v,maxCubemapSize:y,maxAttributes:x,maxVertexUniforms:_,maxVaryings:w,maxFragmentUniforms:M,vertexTextures:S,floatFragmentTextures:E,floatVertexTextures:S&&E,maxSamples:l?e.getParameter(36183):0}}function Si(e){var t=this,n=null,r=0,o=!1,l=!1,c=new jt,h=new Te,d={value:null,needsUpdate:!1};function f(){d.value!==n&&(d.value=n,d.needsUpdate=r>0),t.numPlanes=r,t.numIntersection=0}function m(e,n,r,o){var l=null!==e?e.length:0,f=null;if(0!==l){if(f=d.value,!0!==o||null===f){var m=r+4*l,v=n.matrixWorldInverse;h.getNormalMatrix(v),(null===f||f.length<m)&&(f=new Float32Array(m));for(var y=0,x=r;y!==l;++y,x+=4)c.copy(e[y]).applyMatrix4(v,h),c.normal.toArray(f,x),f[x+3]=c.constant}d.value=f,d.needsUpdate=!0}return t.numPlanes=l,t.numIntersection=0,f}this.uniform=d,this.numPlanes=0,this.numIntersection=0,this.init=function(e,t,l){var c=0!==e.length||t||0!==r||o;return o=t,n=m(e,l,0),r=e.length,c},this.beginShadows=function(){l=!0,m(null)},this.endShadows=function(){l=!1,f()},this.setState=function(t,c,h){var v=t.clippingPlanes,y=t.clipIntersection,x=t.clipShadows,_=e.get(t);if(!o||null===v||0===v.length||l&&!x)l?m(null):f();else{var w=l?0:r,M=4*w,S=_.clippingState||null;d.value=S,S=m(v,c,M,h);for(var E=0;E!==M;++E)S[E]=n[E];_.clippingState=S,this.numIntersection=y?this.numPlanes:0,this.numPlanes+=w}}}function Ei(e){var t=new WeakMap;function n(e,t){return 303===t?e.mapping=O:304===t&&(e.mapping=I),e}function r(e){var n=e.target;n.removeEventListener("dispose",r);var o=t.get(n);void 0!==o&&(t.delete(n),o.dispose())}return{get:function(o){if(o&&o.isTexture){var l=o.mapping;if(303===l||304===l){if(t.has(o))return n(t.get(o).texture,o.mapping);var image=o.image;if(image&&image.height>0){var c=e.getRenderTarget(),h=new ci(image.height/2);return h.fromEquirectangularTexture(e,o),t.set(o,h),e.setRenderTarget(c),o.addEventListener("dispose",r),n(h.texture,o.mapping)}return null}}return o},dispose:function(){t=new WeakMap}}}function Ti(e){var t={};function n(n){if(void 0!==t[n])return t[n];var r;switch(n){case"WEBGL_depth_texture":r=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=e.getExtension(n)}return t[n]=r,r}return{has:function(e){return null!==n(e)},init:function(e){e.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float")},get:function(e){var t=n(e);return null===t&&console.warn("THREE.WebGLRenderer: "+e+" extension not supported."),t}}}function Ci(e,t,n,r){var o={},l=new WeakMap;function c(e){var h=e.target;for(var d in null!==h.index&&t.remove(h.index),h.attributes)t.remove(h.attributes[d]);h.removeEventListener("dispose",c),delete o[h.id];var f=l.get(h);f&&(t.remove(f),l.delete(h)),r.releaseStatesOfGeometry(h),!0===h.isInstancedBufferGeometry&&delete h._maxInstanceCount,n.memory.geometries--}function h(e){var n=[],r=e.index,o=e.attributes.position,c=0;if(null!==r){var h=r.array;c=r.version;for(var d=0,f=h.length;d<f;d+=3){var a=h[d+0],b=h[d+1],m=h[d+2];n.push(a,b,b,m,m,a)}}else{var v=o.array;c=o.version;for(var y=0,x=v.length/3-1;y<x;y+=3){var _=y+0,w=y+1,M=y+2;n.push(_,w,w,M,M,_)}}var S=new(Sn(n)>65535?bn:yn)(n,1);S.version=c;var E=l.get(e);E&&t.remove(E),l.set(e,S)}return{get:function(object,e){return!0===o[e.id]||(e.addEventListener("dispose",c),o[e.id]=!0,n.memory.geometries++),e},update:function(e){var n=e.attributes;for(var r in n)t.update(n[r],34962);var o=e.morphAttributes;for(var l in o)for(var c=o[l],h=0,d=c.length;h<d;h++)t.update(c[h],34962)},getWireframeAttribute:function(e){var t=l.get(e);if(t){var n=e.index;null!==n&&t.version<n.version&&h(e)}else h(e);return l.get(e)}}}function Li(e,t,n,r){var o,l,c,h=r.isWebGL2;this.setMode=function(e){o=e},this.setIndex=function(e){l=e.type,c=e.bytesPerElement},this.render=function(t,r){e.drawElements(o,r,l,t*c),n.update(r,o,1)},this.renderInstances=function(r,d,f){if(0!==f){var m,v;if(h)m=e,v="drawElementsInstanced";else if(v="drawElementsInstancedANGLE",null===(m=t.get("ANGLE_instanced_arrays")))return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");m[v](o,d,l,r*c,f),n.update(d,o,f)}}}function Ai(e){var t={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:t,programs:null,autoReset:!0,reset:function(){t.frame++,t.calls=0,t.triangles=0,t.points=0,t.lines=0},update:function(e,n,r){switch(t.calls++,n){case 4:t.triangles+=r*(e/3);break;case 1:t.lines+=r*(e/2);break;case 3:t.lines+=r*(e-1);break;case 2:t.lines+=r*e;break;case 0:t.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}}}function Ri(a,b){return a[0]-b[0]}function ki(a,b){return Math.abs(b[1])-Math.abs(a[1])}function Pi(e){for(var t={},n=new Float32Array(8),r=[],o=0;o<8;o++)r[o]=[o,0];return{update:function(object,o,l,c){var h=object.morphTargetInfluences,d=void 0===h?0:h.length,f=t[o.id];if(void 0===f){f=[];for(var m=0;m<d;m++)f[m]=[m,0];t[o.id]=f}for(var v=0;v<d;v++){var y=f[v];y[0]=v,y[1]=h[v]}f.sort(ki);for(var x=0;x<8;x++)x<d&&f[x][1]?(r[x][0]=f[x][0],r[x][1]=f[x][1]):(r[x][0]=Number.MAX_SAFE_INTEGER,r[x][1]=0);r.sort(Ri);for(var _=l.morphTargets&&o.morphAttributes.position,w=l.morphNormals&&o.morphAttributes.normal,M=0,S=0;S<8;S++){var E=r[S],T=E[0],C=E[1];T!==Number.MAX_SAFE_INTEGER&&C?(_&&o.getAttribute("morphTarget"+S)!==_[T]&&o.setAttribute("morphTarget"+S,_[T]),w&&o.getAttribute("morphNormal"+S)!==w[T]&&o.setAttribute("morphNormal"+S,w[T]),n[S]=C,M+=C):(_&&!0===o.hasAttribute("morphTarget"+S)&&o.deleteAttribute("morphTarget"+S),w&&!0===o.hasAttribute("morphNormal"+S)&&o.deleteAttribute("morphNormal"+S),n[S]=0)}var L=o.morphTargetsRelative?1:1-M;c.getUniforms().setValue(e,"morphTargetBaseInfluence",L),c.getUniforms().setValue(e,"morphTargetInfluences",n)}}}function Oi(e,t,n,r){var o=new WeakMap;function l(e){var t=e.target;t.removeEventListener("dispose",l),n.remove(t.instanceMatrix),null!==t.instanceColor&&n.remove(t.instanceColor)}return{update:function(object){var e=r.render.frame,c=object.geometry,h=t.get(object,c);return o.get(h)!==e&&(t.update(h),o.set(h,e)),object.isInstancedMesh&&(!1===object.hasEventListener("dispose",l)&&object.addEventListener("dispose",l),n.update(object.instanceMatrix,34962),null!==object.instanceColor&&n.update(object.instanceColor,34962)),h},dispose:function(){o=new WeakMap}}}xi.physical={uniforms:ei([xi.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new Se(1,1)},clearcoatNormalMap:{value:null},sheen:{value:new cn(0)},transmission:{value:0},transmissionMap:{value:null}}]),vertexShader:gi.meshphysical_vert,fragmentShader:gi.meshphysical_frag};var Ii=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(x.a)(this,n),(e=t.call(this,null)).image={data:data,width:r,height:o,depth:l},e.magFilter=B,e.minFilter=B,e.wrapR=z,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return Object(_.a)(n)}(Ae);Ii.prototype.isDataTexture2DArray=!0;var Di=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,data=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,l=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(x.a)(this,n),(e=t.call(this,null)).image={data:data,width:r,height:o,depth:l},e.magFilter=B,e.minFilter=B,e.wrapR=z,e.generateMipmaps=!1,e.flipY=!1,e.needsUpdate=!0,e}return Object(_.a)(n)}(Ae);Di.prototype.isDataTexture3D=!0;var Ni=new Ae,Hi=new Ii,zi=new Di,Fi=new si,Bi=[],Ui=[],ji=new Float32Array(16),Gi=new Float32Array(9),Vi=new Float32Array(4);function Wi(e,t,n){var r=e[0];if(r<=0||r>0)return e;var o=t*n,l=Bi[o];if(void 0===l&&(l=new Float32Array(o),Bi[o]=l),0!==t){r.toArray(l,0);for(var c=1,h=0;c!==t;++c)h+=n,e[c].toArray(l,h)}return l}function qi(a,b){if(a.length!==b.length)return!1;for(var e=0,t=a.length;e<t;e++)if(a[e]!==b[e])return!1;return!0}function Xi(a,b){for(var e=0,t=b.length;e<t;e++)a[e]=b[e]}function Yi(e,t){var n=Ui[t];void 0===n&&(n=new Int32Array(t),Ui[t]=n);for(var r=0;r!==t;++r)n[r]=e.allocateTextureUnit();return n}function Zi(e,t){var n=this.cache;n[0]!==t&&(e.uniform1f(this.addr,t),n[0]=t)}function Ji(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y||(e.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(qi(n,t))return;e.uniform2fv(this.addr,t),Xi(n,t)}}function $i(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z||(e.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(void 0!==t.r)n[0]===t.r&&n[1]===t.g&&n[2]===t.b||(e.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(qi(n,t))return;e.uniform3fv(this.addr,t),Xi(n,t)}}function Ki(e,t){var n=this.cache;if(void 0!==t.x)n[0]===t.x&&n[1]===t.y&&n[2]===t.z&&n[3]===t.w||(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(qi(n,t))return;e.uniform4fv(this.addr,t),Xi(n,t)}}function Qi(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(qi(n,t))return;e.uniformMatrix2fv(this.addr,!1,t),Xi(n,t)}else{if(qi(n,r))return;Vi.set(r),e.uniformMatrix2fv(this.addr,!1,Vi),Xi(n,r)}}function er(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(qi(n,t))return;e.uniformMatrix3fv(this.addr,!1,t),Xi(n,t)}else{if(qi(n,r))return;Gi.set(r),e.uniformMatrix3fv(this.addr,!1,Gi),Xi(n,r)}}function nr(e,t){var n=this.cache,r=t.elements;if(void 0===r){if(qi(n,t))return;e.uniformMatrix4fv(this.addr,!1,t),Xi(n,t)}else{if(qi(n,r))return;ji.set(r),e.uniformMatrix4fv(this.addr,!1,ji),Xi(n,r)}}function ir(e,t){var n=this.cache;n[0]!==t&&(e.uniform1i(this.addr,t),n[0]=t)}function rr(e,t){var n=this.cache;qi(n,t)||(e.uniform2iv(this.addr,t),Xi(n,t))}function ar(e,t){var n=this.cache;qi(n,t)||(e.uniform3iv(this.addr,t),Xi(n,t))}function or(e,t){var n=this.cache;qi(n,t)||(e.uniform4iv(this.addr,t),Xi(n,t))}function sr(e,t){var n=this.cache;n[0]!==t&&(e.uniform1ui(this.addr,t),n[0]=t)}function lr(e,t){var n=this.cache;qi(n,t)||(e.uniform2uiv(this.addr,t),Xi(n,t))}function cr(e,t){var n=this.cache;qi(n,t)||(e.uniform3uiv(this.addr,t),Xi(n,t))}function ur(e,t){var n=this.cache;qi(n,t)||(e.uniform4uiv(this.addr,t),Xi(n,t))}function dr(e,t,n){var r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(e.uniform1i(this.addr,o),r[0]=o),n.safeSetTexture2D(t||Ni,o)}function pr(e,t,n){var r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(e.uniform1i(this.addr,o),r[0]=o),n.setTexture3D(t||zi,o)}function fr(e,t,n){var r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(e.uniform1i(this.addr,o),r[0]=o),n.safeSetTextureCube(t||Fi,o)}function mr(e,t,n){var r=this.cache,o=n.allocateTextureUnit();r[0]!==o&&(e.uniform1i(this.addr,o),r[0]=o),n.setTexture2DArray(t||Hi,o)}function vr(e,t){e.uniform1fv(this.addr,t)}function gr(e,t){var data=Wi(t,this.size,2);e.uniform2fv(this.addr,data)}function yr(e,t){var data=Wi(t,this.size,3);e.uniform3fv(this.addr,data)}function xr(e,t){var data=Wi(t,this.size,4);e.uniform4fv(this.addr,data)}function _r(e,t){var data=Wi(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,data)}function wr(e,t){var data=Wi(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,data)}function Mr(e,t){var data=Wi(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,data)}function Sr(e,t){e.uniform1iv(this.addr,t)}function Er(e,t){e.uniform2iv(this.addr,t)}function Tr(e,t){e.uniform3iv(this.addr,t)}function Cr(e,t){e.uniform4iv(this.addr,t)}function Lr(e,t){e.uniform1uiv(this.addr,t)}function Ar(e,t){e.uniform2uiv(this.addr,t)}function Rr(e,t){e.uniform3uiv(this.addr,t)}function kr(e,t){e.uniform4uiv(this.addr,t)}function Pr(e,t,n){var r=t.length,o=Yi(n,r);e.uniform1iv(this.addr,o);for(var l=0;l!==r;++l)n.safeSetTexture2D(t[l]||Ni,o[l])}function Or(e,t,n){var r=t.length,o=Yi(n,r);e.uniform1iv(this.addr,o);for(var l=0;l!==r;++l)n.safeSetTextureCube(t[l]||Fi,o[l])}function Ir(e,t,n){this.id=e,this.addr=n,this.cache=[],this.setValue=function(e){switch(e){case 5126:return Zi;case 35664:return Ji;case 35665:return $i;case 35666:return Ki;case 35674:return Qi;case 35675:return er;case 35676:return nr;case 5124:case 35670:return ir;case 35667:case 35671:return rr;case 35668:case 35672:return ar;case 35669:case 35673:return or;case 5125:return sr;case 36294:return lr;case 36295:return cr;case 36296:return ur;case 35678:case 36198:case 36298:case 36306:case 35682:return dr;case 35679:case 36299:case 36307:return pr;case 35680:case 36300:case 36308:case 36293:return fr;case 36289:case 36303:case 36311:case 36292:return mr}}(t.type)}function Dr(e,t,n){this.id=e,this.addr=n,this.cache=[],this.size=t.size,this.setValue=function(e){switch(e){case 5126:return vr;case 35664:return gr;case 35665:return yr;case 35666:return xr;case 35674:return _r;case 35675:return wr;case 35676:return Mr;case 5124:case 35670:return Sr;case 35667:case 35671:return Er;case 35668:case 35672:return Tr;case 35669:case 35673:return Cr;case 5125:return Lr;case 36294:return Ar;case 36295:return Rr;case 36296:return kr;case 35678:case 36198:case 36298:case 36306:case 35682:return Pr;case 35680:case 36300:case 36308:case 36293:return Or}}(t.type)}function Nr(e){this.id=e,this.seq=[],this.map={}}Dr.prototype.updateCache=function(data){var e=this.cache;data instanceof Float32Array&&e.length!==data.length&&(this.cache=new Float32Array(data.length)),Xi(e,data)},Nr.prototype.setValue=function(e,t,n){for(var r=this.seq,o=0,l=r.length;o!==l;++o){var u=r[o];u.setValue(e,t[u.id],n)}};var Hr=/(\w+)(\])?(\[|\.)?/g;function zr(e,t){e.seq.push(t),e.map[t.id]=t}function Fr(e,t,n){var path=e.name,r=path.length;for(Hr.lastIndex=0;;){var o=Hr.exec(path),l=Hr.lastIndex,c=o[1],h="]"===o[2],d=o[3];if(h&&(c|=0),void 0===d||"["===d&&l+2===r){zr(n,void 0===d?new Ir(c,e,t):new Dr(c,e,t));break}var f=n.map[c];void 0===f&&zr(n,f=new Nr(c)),n=f}}function Br(e,t){this.seq=[],this.map={};for(var n=e.getProgramParameter(t,35718),r=0;r<n;++r){var o=e.getActiveUniform(t,r);Fr(o,e.getUniformLocation(t,o.name),this)}}function Ur(e,t,n){var r=e.createShader(t);return e.shaderSource(r,n),e.compileShader(r),r}Br.prototype.setValue=function(e,t,n,r){var u=this.map[t];void 0!==u&&u.setValue(e,n,r)},Br.prototype.setOptional=function(e,object,t){var n=object[t];void 0!==n&&this.setValue(e,t,n)},Br.upload=function(e,t,n,r){for(var o=0,l=t.length;o!==l;++o){var u=t[o],c=n[u.id];!1!==c.needsUpdate&&u.setValue(e,c.value,r)}},Br.seqWithValue=function(e,t){for(var n=[],r=0,o=e.length;r!==o;++r){var u=e[r];u.id in t&&n.push(u)}return n};var jr=0;function Gr(e){switch(e){case he:return["Linear","( value )"];case de:return["sRGB","( value )"];case fe:return["RGBE","( value )"];case 3004:return["RGBM","( value, 7.0 )"];case 3005:return["RGBM","( value, 16.0 )"];case 3006:return["RGBD","( value, 256.0 )"];case pe:return["Gamma","( value, float( GAMMA_FACTOR ) )"];case 3003:return["LogLuv","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",e),["Linear","( value )"]}}function Vr(e,t,n){var r=e.getShaderParameter(t,35713),o=e.getShaderInfoLog(t).trim();return r&&""===o?"":"THREE.WebGLShader: gl.getShaderInfoLog() "+n+"\n"+o+function(e){for(var t=e.split("\n"),n=0;n<t.length;n++)t[n]=n+1+": "+t[n];return t.join("\n")}(e.getShaderSource(t))}function Wr(e,t){var n=Gr(t);return"vec4 "+e+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function qr(e,t){var n;switch(t){case 1:n="Linear";break;case 2:n="Reinhard";break;case 3:n="OptimizedCineon";break;case 4:n="ACESFilmic";break;case 5:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+e+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Xr(e){return""!==e}function Yr(e,t){return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function Zr(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}var Jr=/^[ \t]*#include +<([\w\d./]+)>/gm;function $r(e){return e.replace(Jr,Kr)}function Kr(e,t){var n=gi[t];if(void 0===n)throw new Error("Can not resolve #include <"+t+">");return $r(n)}var Qr=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,ea=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function ta(e){return e.replace(ea,ia).replace(Qr,na)}function na(e,t,n,r){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),ia(e,t,n,r)}function ia(e,t,n,r){for(var o="",l=parseInt(t);l<parseInt(n);l++)o+=r.replace(/\[\s*i\s*\]/g,"[ "+l+" ]").replace(/UNROLLED_LOOP_INDEX/g,l);return o}function ra(e){var t="precision "+e.precision+" float;\nprecision "+e.precision+" int;";return"highp"===e.precision?t+="\n#define HIGH_PRECISION":"mediump"===e.precision?t+="\n#define MEDIUM_PRECISION":"lowp"===e.precision&&(t+="\n#define LOW_PRECISION"),t}function aa(e,t,n,r){var o,l,c,h,d,f=e.getContext(),m=n.defines,v=n.vertexShader,y=n.fragmentShader,x=function(e){var t="SHADOWMAP_TYPE_BASIC";return 1===e.shadowMapType?t="SHADOWMAP_TYPE_PCF":2===e.shadowMapType?t="SHADOWMAP_TYPE_PCF_SOFT":3===e.shadowMapType&&(t="SHADOWMAP_TYPE_VSM"),t}(n),_=function(e){var t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case O:case I:t="ENVMAP_TYPE_CUBE";break;case D:case N:t="ENVMAP_TYPE_CUBE_UV"}return t}(n),w=function(e){var t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case I:case N:t="ENVMAP_MODE_REFRACTION"}return t}(n),M=function(e){var t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case 0:t="ENVMAP_BLENDING_MULTIPLY";break;case 1:t="ENVMAP_BLENDING_MIX";break;case 2:t="ENVMAP_BLENDING_ADD"}return t}(n),S=e.gammaFactor>0?e.gammaFactor:1,E=n.isWebGL2?"":function(e){return[e.extensionDerivatives||e.envMapCubeUV||e.bumpMap||e.tangentSpaceNormalMap||e.clearcoatNormalMap||e.flatShading||"physical"===e.shaderID?"#extension GL_OES_standard_derivatives : enable":"",(e.extensionFragDepth||e.logarithmicDepthBuffer)&&e.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",e.extensionDrawBuffers&&e.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(e.extensionShaderTextureLOD||e.envMap)&&e.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Xr).join("\n")}(n),T=function(e){var t=[];for(var n in e){var r=e[n];!1!==r&&t.push("#define "+n+" "+r)}return t.join("\n")}(m),C=f.createProgram(),L=n.glslVersion?"#version "+n.glslVersion+"\n":"";n.isRawShaderMaterial?((o=[T].filter(Xr).join("\n")).length>0&&(o+="\n"),(l=[E,T].filter(Xr).join("\n")).length>0&&(l+="\n")):(o=[ra(n),"#define SHADER_NAME "+n.shaderName,T,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+S,"#define MAX_BONES "+n.maxBones,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+w:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.useVertexTexture?"#define BONE_TEXTURE":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&!1===n.flatShading?"#define USE_MORPHNORMALS":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+x:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","\tattribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","\tattribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","\tattribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","\tattribute vec4 color;","#elif defined( USE_COLOR )","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Xr).join("\n"),l=[E,ra(n),"#define SHADER_NAME "+n.shaderName,T,n.alphaTest?"#define ALPHATEST "+n.alphaTest+(n.alphaTest%1?"":".0"):"","#define GAMMA_FACTOR "+S,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+_:"",n.envMap?"#define "+w:"",n.envMap?"#define "+M:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.sheen?"#define USE_SHEEN":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+x:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(n.extensionShaderTextureLOD||n.envMap)&&n.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",0!==n.toneMapping?"#define TONE_MAPPING":"",0!==n.toneMapping?gi.tonemapping_pars_fragment:"",0!==n.toneMapping?qr("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",gi.encodings_pars_fragment,n.map?Wr("mapTexelToLinear",n.mapEncoding):"",n.matcap?Wr("matcapTexelToLinear",n.matcapEncoding):"",n.envMap?Wr("envMapTexelToLinear",n.envMapEncoding):"",n.emissiveMap?Wr("emissiveMapTexelToLinear",n.emissiveMapEncoding):"",n.lightMap?Wr("lightMapTexelToLinear",n.lightMapEncoding):"",(c="linearToOutputTexel",h=n.outputEncoding,d=Gr(h),"vec4 "+c+"( vec4 value ) { return LinearTo"+d[0]+d[1]+"; }"),n.depthPacking?"#define DEPTH_PACKING "+n.depthPacking:"","\n"].filter(Xr).join("\n")),v=Zr(v=Yr(v=$r(v),n),n),y=Zr(y=Yr(y=$r(y),n),n),v=ta(v),y=ta(y),n.isWebGL2&&!0!==n.isRawShaderMaterial&&(L="#version 300 es\n",o=["#define attribute in","#define varying out","#define texture2D texture"].join("\n")+"\n"+o,l=["#define varying in",n.glslVersion===ye?"":"out highp vec4 pc_fragColor;",n.glslVersion===ye?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join("\n")+"\n"+l);var A,R,k=L+l+y,P=Ur(f,35633,L+o+v),H=Ur(f,35632,k);if(f.attachShader(C,P),f.attachShader(C,H),void 0!==n.index0AttributeName?f.bindAttribLocation(C,0,n.index0AttributeName):!0===n.morphTargets&&f.bindAttribLocation(C,0,"position"),f.linkProgram(C),e.debug.checkShaderErrors){var z=f.getProgramInfoLog(C).trim(),F=f.getShaderInfoLog(P).trim(),B=f.getShaderInfoLog(H).trim(),U=!0,j=!0;if(!1===f.getProgramParameter(C,35714)){U=!1;var G=Vr(f,P,"vertex"),V=Vr(f,H,"fragment");console.error("THREE.WebGLProgram: shader error: ",f.getError(),"35715",f.getProgramParameter(C,35715),"gl.getProgramInfoLog",z,G,V)}else""!==z?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",z):""!==F&&""!==B||(j=!1);j&&(this.diagnostics={runnable:U,programLog:z,vertexShader:{log:F,prefix:o},fragmentShader:{log:B,prefix:l}})}return f.deleteShader(P),f.deleteShader(H),this.getUniforms=function(){return void 0===A&&(A=new Br(f,C)),A},this.getAttributes=function(){return void 0===R&&(R=function(e,t){for(var n={},r=e.getProgramParameter(t,35721),o=0;o<r;o++){var l=e.getActiveAttrib(t,o).name;n[l]=e.getAttribLocation(t,l)}return n}(f,C)),R},this.destroy=function(){r.releaseStatesOfProgram(this),f.deleteProgram(C),this.program=void 0},this.name=n.shaderName,this.id=jr++,this.cacheKey=t,this.usedTimes=1,this.program=C,this.vertexShader=P,this.fragmentShader=H,this}function oa(e,t,n,r,o,l){var c=[],h=r.isWebGL2,d=r.logarithmicDepthBuffer,f=r.floatVertexTextures,m=r.maxVertexUniforms,v=r.vertexTextures,y=r.precision,x={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"},_=["precision","isWebGL2","supportsVertexTextures","outputEncoding","instancing","instancingColor","map","mapEncoding","matcap","matcapEncoding","envMap","envMapMode","envMapEncoding","envMapCubeUV","lightMap","lightMapEncoding","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","objectSpaceNormalMap","tangentSpaceNormalMap","clearcoatMap","clearcoatRoughnessMap","clearcoatNormalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","vertexAlphas","vertexTangents","vertexUvs","uvsVertexOnly","fog","useFog","fogExp2","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","numDirLightShadows","numPointLightShadows","numSpotLightShadows","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering","sheen","transmissionMap"];function w(map){var e;return map&&map.isTexture?e=map.encoding:map&&map.isWebGLRenderTarget?(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),e=map.texture.encoding):e=he,e}return{getParameters:function(o,c,_,M,object){var S,E,T=M.fog,C=o.isMeshStandardMaterial?M.environment:null,L=t.get(o.envMap||C),A=x[o.type],R=object.isSkinnedMesh?function(object){var e=object.skeleton.bones;if(f)return 1024;var t=m,n=Math.floor((t-20)/4),r=Math.min(n,e.length);return r<e.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+e.length+" bones. This GPU supports "+r+"."),0):r}(object):0;if(null!==o.precision&&(y=r.getMaxPrecision(o.precision))!==o.precision&&console.warn("THREE.WebGLProgram.getParameters:",o.precision,"not supported, using",y,"instead."),A){var k=xi[A];S=k.vertexShader,E=k.fragmentShader}else S=o.vertexShader,E=o.fragmentShader;var P=e.getRenderTarget();return{isWebGL2:h,shaderID:A,shaderName:o.type,vertexShader:S,fragmentShader:E,defines:o.defines,isRawShaderMaterial:!0===o.isRawShaderMaterial,glslVersion:o.glslVersion,precision:y,instancing:!0===object.isInstancedMesh,instancingColor:!0===object.isInstancedMesh&&null!==object.instanceColor,supportsVertexTextures:v,outputEncoding:null!==P?w(P.texture):e.outputEncoding,map:!!o.map,mapEncoding:w(o.map),matcap:!!o.matcap,matcapEncoding:w(o.matcap),envMap:!!L,envMapMode:L&&L.mapping,envMapEncoding:w(L),envMapCubeUV:!!L&&(L.mapping===D||L.mapping===N),lightMap:!!o.lightMap,lightMapEncoding:w(o.lightMap),aoMap:!!o.aoMap,emissiveMap:!!o.emissiveMap,emissiveMapEncoding:w(o.emissiveMap),bumpMap:!!o.bumpMap,normalMap:!!o.normalMap,objectSpaceNormalMap:1===o.normalMapType,tangentSpaceNormalMap:0===o.normalMapType,clearcoatMap:!!o.clearcoatMap,clearcoatRoughnessMap:!!o.clearcoatRoughnessMap,clearcoatNormalMap:!!o.clearcoatNormalMap,displacementMap:!!o.displacementMap,roughnessMap:!!o.roughnessMap,metalnessMap:!!o.metalnessMap,specularMap:!!o.specularMap,alphaMap:!!o.alphaMap,gradientMap:!!o.gradientMap,sheen:!!o.sheen,transmissionMap:!!o.transmissionMap,combine:o.combine,vertexTangents:o.normalMap&&o.vertexTangents,vertexColors:o.vertexColors,vertexAlphas:!0===o.vertexColors&&object.geometry.attributes.color&&4===object.geometry.attributes.color.itemSize,vertexUvs:!!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatMap||o.clearcoatRoughnessMap||o.clearcoatNormalMap||o.displacementMap||o.transmissionMap),uvsVertexOnly:!(o.map||o.bumpMap||o.normalMap||o.specularMap||o.alphaMap||o.emissiveMap||o.roughnessMap||o.metalnessMap||o.clearcoatNormalMap||o.transmissionMap||!o.displacementMap),fog:!!T,useFog:o.fog,fogExp2:T&&T.isFogExp2,flatShading:!!o.flatShading,sizeAttenuation:o.sizeAttenuation,logarithmicDepthBuffer:d,skinning:o.skinning&&R>0,maxBones:R,useVertexTexture:f,morphTargets:o.morphTargets,morphNormals:o.morphNormals,numDirLights:c.directional.length,numPointLights:c.point.length,numSpotLights:c.spot.length,numRectAreaLights:c.rectArea.length,numHemiLights:c.hemi.length,numDirLightShadows:c.directionalShadowMap.length,numPointLightShadows:c.pointShadowMap.length,numSpotLightShadows:c.spotShadowMap.length,numClippingPlanes:l.numPlanes,numClipIntersection:l.numIntersection,dithering:o.dithering,shadowMapEnabled:e.shadowMap.enabled&&_.length>0,shadowMapType:e.shadowMap.type,toneMapping:o.toneMapped?e.toneMapping:0,physicallyCorrectLights:e.physicallyCorrectLights,premultipliedAlpha:o.premultipliedAlpha,alphaTest:o.alphaTest,doubleSided:2===o.side,flipSided:1===o.side,depthPacking:void 0!==o.depthPacking&&o.depthPacking,index0AttributeName:o.index0AttributeName,extensionDerivatives:o.extensions&&o.extensions.derivatives,extensionFragDepth:o.extensions&&o.extensions.fragDepth,extensionDrawBuffers:o.extensions&&o.extensions.drawBuffers,extensionShaderTextureLOD:o.extensions&&o.extensions.shaderTextureLOD,rendererExtensionFragDepth:h||n.has("EXT_frag_depth"),rendererExtensionDrawBuffers:h||n.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:h||n.has("EXT_shader_texture_lod"),customProgramCacheKey:o.customProgramCacheKey()}},getProgramCacheKey:function(t){var n=[];if(t.shaderID?n.push(t.shaderID):(n.push(t.fragmentShader),n.push(t.vertexShader)),void 0!==t.defines)for(var r in t.defines)n.push(r),n.push(t.defines[r]);if(!1===t.isRawShaderMaterial){for(var o=0;o<_.length;o++)n.push(t[_[o]]);n.push(e.outputEncoding),n.push(e.gammaFactor)}return n.push(t.customProgramCacheKey),n.join()},getUniforms:function(e){var t,n=x[e.type];if(n){var r=xi[n];t=ti.clone(r.uniforms)}else t=e.uniforms;return t},acquireProgram:function(t,n){for(var r,p=0,l=c.length;p<l;p++){var h=c[p];if(h.cacheKey===n){++(r=h).usedTimes;break}}return void 0===r&&(r=new aa(e,n,t,o),c.push(r)),r},releaseProgram:function(e){if(0==--e.usedTimes){var t=c.indexOf(e);c[t]=c[c.length-1],c.pop(),e.destroy()}},programs:c}}function sa(){var e=new WeakMap;return{get:function(object){var map=e.get(object);return void 0===map&&(map={},e.set(object,map)),map},remove:function(object){e.delete(object)},update:function(object,t,n){e.get(object)[t]=n},dispose:function(){e=new WeakMap}}}function la(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.program!==b.program?a.program.id-b.program.id:a.material.id!==b.material.id?a.material.id-b.material.id:a.z!==b.z?a.z-b.z:a.id-b.id}function ca(a,b){return a.groupOrder!==b.groupOrder?a.groupOrder-b.groupOrder:a.renderOrder!==b.renderOrder?a.renderOrder-b.renderOrder:a.z!==b.z?b.z-a.z:a.id-b.id}function ua(e){var t=[],n=0,r=[],o=[],l={id:-1};function c(object,r,o,c,h,d){var f=t[n],m=e.get(o);return void 0===f?(f={id:object.id,object:object,geometry:r,material:o,program:m.program||l,groupOrder:c,renderOrder:object.renderOrder,z:h,group:d},t[n]=f):(f.id=object.id,f.object=object,f.geometry=r,f.material=o,f.program=m.program||l,f.groupOrder=c,f.renderOrder=object.renderOrder,f.z=h,f.group=d),n++,f}return{opaque:r,transparent:o,init:function(){n=0,r.length=0,o.length=0},push:function(object,e,t,n,l,h){var d=c(object,e,t,n,l,h);(!0===t.transparent?o:r).push(d)},unshift:function(object,e,t,n,l,h){var d=c(object,e,t,n,l,h);(!0===t.transparent?o:r).unshift(d)},finish:function(){for(var e=n,r=t.length;e<r;e++){var o=t[e];if(null===o.id)break;o.id=null,o.object=null,o.geometry=null,o.material=null,o.program=null,o.group=null}},sort:function(e,t){r.length>1&&r.sort(e||la),o.length>1&&o.sort(t||ca)}}}function ha(e){var t=new WeakMap;return{get:function(n,r){var o;return!1===t.has(n)?(o=new ua(e),t.set(n,[o])):r>=t.get(n).length?(o=new ua(e),t.get(n).push(o)):o=t.get(n)[r],o},dispose:function(){t=new WeakMap}}}function da(){var e={};return{get:function(t){if(void 0!==e[t.id])return e[t.id];var n;switch(t.type){case"DirectionalLight":n={direction:new Ie,color:new cn};break;case"SpotLight":n={position:new Ie,direction:new Ie,color:new cn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ie,color:new cn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ie,skyColor:new cn,groundColor:new cn};break;case"RectAreaLight":n={color:new cn,position:new Ie,halfWidth:new Ie,halfHeight:new Ie}}return e[t.id]=n,n}}}var pa=0;function fa(e,t){return(t.castShadow?1:0)-(e.castShadow?1:0)}function ma(e,t){for(var n,r=new da,o=(n={},{get:function(e){if(void 0!==n[e.id])return n[e.id];var t;switch(e.type){case"DirectionalLight":case"SpotLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Se};break;case"PointLight":t={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new Se,shadowCameraNear:1,shadowCameraFar:1e3}}return n[e.id]=t,t}}),l={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},c=0;c<9;c++)l.probe.push(new Ie);var h=new Ie,d=new pt,f=new pt;return{setup:function(n){for(var c=0,g=0,b=0,h=0;h<9;h++)l.probe[h].set(0,0,0);var d=0,f=0,m=0,v=0,y=0,x=0,_=0,w=0;n.sort(fa);for(var M=0,S=n.length;M<S;M++){var E=n[M],T=E.color,C=E.intensity,L=E.distance,A=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)c+=T.r*C,g+=T.g*C,b+=T.b*C;else if(E.isLightProbe)for(var R=0;R<9;R++)l.probe[R].addScaledVector(E.sh.coefficients[R],C);else if(E.isDirectionalLight){var k=r.get(E);if(k.color.copy(E.color).multiplyScalar(E.intensity),E.castShadow){var shadow=E.shadow,P=o.get(E);P.shadowBias=shadow.bias,P.shadowNormalBias=shadow.normalBias,P.shadowRadius=shadow.radius,P.shadowMapSize=shadow.mapSize,l.directionalShadow[d]=P,l.directionalShadowMap[d]=A,l.directionalShadowMatrix[d]=E.shadow.matrix,x++}l.directional[d]=k,d++}else if(E.isSpotLight){var O=r.get(E);if(O.position.setFromMatrixPosition(E.matrixWorld),O.color.copy(T).multiplyScalar(C),O.distance=L,O.coneCos=Math.cos(E.angle),O.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),O.decay=E.decay,E.castShadow){var I=E.shadow,D=o.get(E);D.shadowBias=I.bias,D.shadowNormalBias=I.normalBias,D.shadowRadius=I.radius,D.shadowMapSize=I.mapSize,l.spotShadow[m]=D,l.spotShadowMap[m]=A,l.spotShadowMatrix[m]=E.shadow.matrix,w++}l.spot[m]=O,m++}else if(E.isRectAreaLight){var N=r.get(E);N.color.copy(T).multiplyScalar(C),N.halfWidth.set(.5*E.width,0,0),N.halfHeight.set(0,.5*E.height,0),l.rectArea[v]=N,v++}else if(E.isPointLight){var H=r.get(E);if(H.color.copy(E.color).multiplyScalar(E.intensity),H.distance=E.distance,H.decay=E.decay,E.castShadow){var z=E.shadow,F=o.get(E);F.shadowBias=z.bias,F.shadowNormalBias=z.normalBias,F.shadowRadius=z.radius,F.shadowMapSize=z.mapSize,F.shadowCameraNear=z.camera.near,F.shadowCameraFar=z.camera.far,l.pointShadow[f]=F,l.pointShadowMap[f]=A,l.pointShadowMatrix[f]=E.shadow.matrix,_++}l.point[f]=H,f++}else if(E.isHemisphereLight){var B=r.get(E);B.skyColor.copy(E.color).multiplyScalar(C),B.groundColor.copy(E.groundColor).multiplyScalar(C),l.hemi[y]=B,y++}}v>0&&(t.isWebGL2||!0===e.has("OES_texture_float_linear")?(l.rectAreaLTC1=yi.LTC_FLOAT_1,l.rectAreaLTC2=yi.LTC_FLOAT_2):!0===e.has("OES_texture_half_float_linear")?(l.rectAreaLTC1=yi.LTC_HALF_1,l.rectAreaLTC2=yi.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),l.ambient[0]=c,l.ambient[1]=g,l.ambient[2]=b;var U=l.hash;U.directionalLength===d&&U.pointLength===f&&U.spotLength===m&&U.rectAreaLength===v&&U.hemiLength===y&&U.numDirectionalShadows===x&&U.numPointShadows===_&&U.numSpotShadows===w||(l.directional.length=d,l.spot.length=m,l.rectArea.length=v,l.point.length=f,l.hemi.length=y,l.directionalShadow.length=x,l.directionalShadowMap.length=x,l.pointShadow.length=_,l.pointShadowMap.length=_,l.spotShadow.length=w,l.spotShadowMap.length=w,l.directionalShadowMatrix.length=x,l.pointShadowMatrix.length=_,l.spotShadowMatrix.length=w,U.directionalLength=d,U.pointLength=f,U.spotLength=m,U.rectAreaLength=v,U.hemiLength=y,U.numDirectionalShadows=x,U.numPointShadows=_,U.numSpotShadows=w,l.version=pa++)},setupView:function(e,t){for(var n=0,r=0,o=0,c=0,m=0,v=t.matrixWorldInverse,y=0,x=e.length;y<x;y++){var _=e[y];if(_.isDirectionalLight){var w=l.directional[n];w.direction.setFromMatrixPosition(_.matrixWorld),h.setFromMatrixPosition(_.target.matrixWorld),w.direction.sub(h),w.direction.transformDirection(v),n++}else if(_.isSpotLight){var M=l.spot[o];M.position.setFromMatrixPosition(_.matrixWorld),M.position.applyMatrix4(v),M.direction.setFromMatrixPosition(_.matrixWorld),h.setFromMatrixPosition(_.target.matrixWorld),M.direction.sub(h),M.direction.transformDirection(v),o++}else if(_.isRectAreaLight){var S=l.rectArea[c];S.position.setFromMatrixPosition(_.matrixWorld),S.position.applyMatrix4(v),f.identity(),d.copy(_.matrixWorld),d.premultiply(v),f.extractRotation(d),S.halfWidth.set(.5*_.width,0,0),S.halfHeight.set(0,.5*_.height,0),S.halfWidth.applyMatrix4(f),S.halfHeight.applyMatrix4(f),c++}else if(_.isPointLight){var E=l.point[r];E.position.setFromMatrixPosition(_.matrixWorld),E.position.applyMatrix4(v),r++}else if(_.isHemisphereLight){var T=l.hemi[m];T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(v),T.direction.normalize(),m++}}},state:l}}function va(e,t){var n=new ma(e,t),r=[],o=[];return{init:function(){r.length=0,o.length=0},state:{lightsArray:r,shadowsArray:o,lights:n},setupLights:function(){n.setup(r)},setupLightsView:function(e){n.setupView(r,e)},pushLight:function(e){r.push(e)},pushShadow:function(e){o.push(e)}}}function ga(e,t){var n=new WeakMap;return{get:function(r){var o,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return!1===n.has(r)?(o=new va(e,t),n.set(r,[o])):l>=n.get(r).length?(o=new va(e,t),n.get(r).push(o)):o=n.get(r)[l],o},dispose:function(){n=new WeakMap}}}var ya=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="MeshDepthMaterial",r.depthPacking=3200,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.depthPacking=source.depthPacking,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.map=source.map,this.alphaMap=source.alphaMap,this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this}}]),n}(tn);ya.prototype.isMeshDepthMaterial=!0;var xa=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="MeshDistanceMaterial",r.referencePosition=new Ie,r.nearDistance=1,r.farDistance=1e3,r.skinning=!1,r.morphTargets=!1,r.map=null,r.alphaMap=null,r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.fog=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.referencePosition.copy(source.referencePosition),this.nearDistance=source.nearDistance,this.farDistance=source.farDistance,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.map=source.map,this.alphaMap=source.alphaMap,this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this}}]),n}(tn);xa.prototype.isMeshDistanceMaterial=!0;function ba(e,t,n){var r=new pi,o=new Se,l=new Se,c=new ke,h=[],d=[],f={},m=n.maxTextureSize,v={0:1,1:0,2:2},y=new ni({defines:{SAMPLE_RATE:2/8,HALF_SAMPLE_RATE:1/8},uniforms:{shadow_pass:{value:null},resolution:{value:new Se},radius:{value:4}},vertexShader:"void main() {\n\tgl_Position = vec4( position, 1.0 );\n}",fragmentShader:"uniform sampler2D shadow_pass;\nuniform vec2 resolution;\nuniform float radius;\n#include <packing>\nvoid main() {\n\tfloat mean = 0.0;\n\tfloat squared_mean = 0.0;\n\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy ) / resolution ) );\n\tfor ( float i = -1.0; i < 1.0 ; i += SAMPLE_RATE) {\n\t\t#ifdef HORIZONTAL_PASS\n\t\t\tvec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( i, 0.0 ) * radius ) / resolution ) );\n\t\t\tmean += distribution.x;\n\t\t\tsquared_mean += distribution.y * distribution.y + distribution.x * distribution.x;\n\t\t#else\n\t\t\tfloat depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, i ) * radius ) / resolution ) );\n\t\t\tmean += depth;\n\t\t\tsquared_mean += depth * depth;\n\t\t#endif\n\t}\n\tmean = mean * HALF_SAMPLE_RATE;\n\tsquared_mean = squared_mean * HALF_SAMPLE_RATE;\n\tfloat std_dev = sqrt( squared_mean - mean * mean );\n\tgl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );\n}"}),x=y.clone();x.defines.HORIZONTAL_PASS=1;var _=new Pn;_.setAttribute("position",new pn(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));var w=new Jn(_,y),M=this;function S(shadow,n){var r=t.update(w);y.uniforms.shadow_pass.value=shadow.map.texture,y.uniforms.resolution.value=shadow.mapSize,y.uniforms.radius.value=shadow.radius,e.setRenderTarget(shadow.mapPass),e.clear(),e.renderBufferDirect(n,null,r,y,w,null),x.uniforms.shadow_pass.value=shadow.mapPass.texture,x.uniforms.resolution.value=shadow.mapSize,x.uniforms.radius.value=shadow.radius,e.setRenderTarget(shadow.map),e.clear(),e.renderBufferDirect(n,null,r,x,w,null)}function E(e,t,n){var r=e<<0|t<<1|n<<2,o=h[r];return void 0===o&&(o=new ya({depthPacking:3201,morphTargets:e,skinning:t}),h[r]=o),o}function T(e,t,n){var r=e<<0|t<<1|n<<2,o=d[r];return void 0===o&&(o=new xa({morphTargets:e,skinning:t}),d[r]=o),o}function C(object,t,n,r,o,l,c){var h=null,d=E,m=object.customDepthMaterial;if(!0===r.isPointLight&&(d=T,m=object.customDistanceMaterial),void 0===m){var y=!1;!0===n.morphTargets&&(y=t.morphAttributes&&t.morphAttributes.position&&t.morphAttributes.position.length>0);var x=!1;!0===object.isSkinnedMesh&&(!0===n.skinning?x=!0:console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",object)),h=d(y,x,!0===object.isInstancedMesh)}else h=m;if(e.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var _=h.uuid,w=n.uuid,M=f[_];void 0===M&&(M={},f[_]=M);var S=M[w];void 0===S&&(S=h.clone(),M[w]=S),h=S}return h.visible=n.visible,h.wireframe=n.wireframe,h.side=3===c?null!==n.shadowSide?n.shadowSide:n.side:null!==n.shadowSide?n.shadowSide:v[n.side],h.clipShadows=n.clipShadows,h.clippingPlanes=n.clippingPlanes,h.clipIntersection=n.clipIntersection,h.wireframeLinewidth=n.wireframeLinewidth,h.linewidth=n.linewidth,!0===r.isPointLight&&!0===h.isMeshDistanceMaterial&&(h.referencePosition.setFromMatrixPosition(r.matrixWorld),h.nearDistance=o,h.farDistance=l),h}function L(object,n,o,l,c){if(!1!==object.visible){if(object.layers.test(n.layers)&&(object.isMesh||object.isLine||object.isPoints)&&(object.castShadow||object.receiveShadow&&3===c)&&(!object.frustumCulled||r.intersectsObject(object))){object.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,object.matrixWorld);var h=t.update(object),d=object.material;if(Array.isArray(d))for(var f=h.groups,m=0,v=f.length;m<v;m++){var y=f[m],x=d[y.materialIndex];if(x&&x.visible){var _=C(object,h,x,l,o.near,o.far,c);e.renderBufferDirect(o,null,h,_,object,y)}}else if(d.visible){var w=C(object,h,d,l,o.near,o.far,c);e.renderBufferDirect(o,null,h,w,object,null)}}for(var M=object.children,S=0,E=M.length;S<E;S++)L(M[S],n,o,l,c)}}this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=1,this.render=function(t,n,h){if(!1!==M.enabled&&(!1!==M.autoUpdate||!1!==M.needsUpdate)&&0!==t.length){var d=e.getRenderTarget(),f=e.getActiveCubeFace(),v=e.getActiveMipmapLevel(),y=e.state;y.setBlending(0),y.buffers.color.setClear(1,1,1,1),y.buffers.depth.setTest(!0),y.setScissorTest(!1);for(var x=0,_=t.length;x<_;x++){var w=t[x],shadow=w.shadow;if(void 0!==shadow){if(!1!==shadow.autoUpdate||!1!==shadow.needsUpdate){o.copy(shadow.mapSize);var E=shadow.getFrameExtents();if(o.multiply(E),l.copy(shadow.mapSize),(o.x>m||o.y>m)&&(o.x>m&&(l.x=Math.floor(m/E.x),o.x=l.x*E.x,shadow.mapSize.x=l.x),o.y>m&&(l.y=Math.floor(m/E.y),o.y=l.y*E.y,shadow.mapSize.y=l.y)),null===shadow.map&&!shadow.isPointLightShadow&&3===this.type){var T={minFilter:G,magFilter:G,format:ee};shadow.map=new Pe(o.x,o.y,T),shadow.map.texture.name=w.name+".shadowMap",shadow.mapPass=new Pe(o.x,o.y,T),shadow.camera.updateProjectionMatrix()}if(null===shadow.map){var C={minFilter:B,magFilter:B,format:ee};shadow.map=new Pe(o.x,o.y,C),shadow.map.texture.name=w.name+".shadowMap",shadow.camera.updateProjectionMatrix()}e.setRenderTarget(shadow.map),e.clear();for(var A=shadow.getViewportCount(),R=0;R<A;R++){var k=shadow.getViewport(R);c.set(l.x*k.x,l.y*k.y,l.x*k.z,l.y*k.w),y.viewport(c),shadow.updateMatrices(w,R),r=shadow.getFrustum(),L(n,h,shadow.camera,w,this.type)}shadow.isPointLightShadow||3!==this.type||S(shadow,h),shadow.needsUpdate=!1}}else console.warn("THREE.WebGLShadowMap:",w,"has no shadow.")}M.needsUpdate=!1,e.setRenderTarget(d,f,v)}}}function _a(e,t,n){var r,l,c=n.isWebGL2;var h=new function(){var t=!1,n=new ke,r=null,o=new ke(0,0,0,0);return{setMask:function(n){r===n||t||(e.colorMask(n,n,n,n),r=n)},setLocked:function(e){t=e},setClear:function(t,g,b,a,r){!0===r&&(t*=a,g*=a,b*=a),n.set(t,g,b,a),!1===o.equals(n)&&(e.clearColor(t,g,b,a),o.copy(n))},reset:function(){t=!1,r=null,o.set(-1,0,0,0)}}},d=new function(){var t=!1,n=null,r=null,o=null;return{setTest:function(e){e?X(2929):Y(2929)},setMask:function(r){n===r||t||(e.depthMask(r),n=r)},setFunc:function(t){if(r!==t){if(t)switch(t){case 0:e.depthFunc(512);break;case 1:e.depthFunc(519);break;case 2:e.depthFunc(513);break;case 3:default:e.depthFunc(515);break;case 4:e.depthFunc(514);break;case 5:e.depthFunc(518);break;case 6:e.depthFunc(516);break;case 7:e.depthFunc(517)}else e.depthFunc(515);r=t}},setLocked:function(e){t=e},setClear:function(t){o!==t&&(e.clearDepth(t),o=t)},reset:function(){t=!1,n=null,r=null,o=null}}},f=new function(){var t=!1,n=null,r=null,o=null,l=null,c=null,h=null,d=null,f=null;return{setTest:function(e){t||(e?X(2960):Y(2960))},setMask:function(r){n===r||t||(e.stencilMask(r),n=r)},setFunc:function(t,n,c){r===t&&o===n&&l===c||(e.stencilFunc(t,n,c),r=t,o=n,l=c)},setOp:function(t,n,r){c===t&&h===n&&d===r||(e.stencilOp(t,n,r),c=t,h=n,d=r)},setLocked:function(e){t=e},setClear:function(t){f!==t&&(e.clearStencil(t),f=t)},reset:function(){t=!1,n=null,r=null,o=null,l=null,c=null,h=null,d=null,f=null}}},m={},v=null,y={},x=null,_=!1,w=null,M=null,S=null,E=null,T=null,C=null,L=null,A=!1,R=null,k=null,O=null,I=null,D=null,N=e.getParameter(35661),H=!1,z=0,F=e.getParameter(7938);-1!==F.indexOf("WebGL")?(z=parseFloat(/^WebGL (\d)/.exec(F)[1]),H=z>=1):-1!==F.indexOf("OpenGL ES")&&(z=parseFloat(/^OpenGL ES (\d)/.exec(F)[1]),H=z>=2);var B=null,U={},j=new ke(0,0,e.canvas.width,e.canvas.height),G=new ke(0,0,e.canvas.width,e.canvas.height);function V(t,n,r){var data=new Uint8Array(4),o=e.createTexture();e.bindTexture(t,o),e.texParameteri(t,10241,9728),e.texParameteri(t,10240,9728);for(var l=0;l<r;l++)e.texImage2D(n+l,0,6408,1,1,0,6408,5121,data);return o}var W={};function X(t){!0!==m[t]&&(e.enable(t),m[t]=!0)}function Y(t){!1!==m[t]&&(e.disable(t),m[t]=!1)}W[3553]=V(3553,3553,1),W[34067]=V(34067,34069,6),h.setClear(0,0,0,1),d.setClear(1),f.setClear(0),X(2929),d.setFunc(3),Q(!1),ee(1),X(2884),K(0);var Z=(r={},Object(o.a)(r,P,32774),Object(o.a)(r,101,32778),Object(o.a)(r,102,32779),r);if(c)Z[103]=32775,Z[104]=32776;else{var J=t.get("EXT_blend_minmax");null!==J&&(Z[103]=J.MIN_EXT,Z[104]=J.MAX_EXT)}var $=(l={},Object(o.a)(l,200,0),Object(o.a)(l,201,1),Object(o.a)(l,202,768),Object(o.a)(l,204,770),Object(o.a)(l,210,776),Object(o.a)(l,208,774),Object(o.a)(l,206,772),Object(o.a)(l,203,769),Object(o.a)(l,205,771),Object(o.a)(l,209,775),Object(o.a)(l,207,773),l);function K(t,n,r,o,l,c,h,d){if(0!==t){if(!1===_&&(X(3042),_=!0),5===t)l=l||n,c=c||r,h=h||o,n===M&&l===T||(e.blendEquationSeparate(Z[n],Z[l]),M=n,T=l),r===S&&o===E&&c===C&&h===L||(e.blendFuncSeparate($[r],$[o],$[c],$[h]),S=r,E=o,C=c,L=h),w=t,A=null;else if(t!==w||d!==A){if(M===P&&T===P||(e.blendEquation(32774),M=P,T=P),d)switch(t){case 1:e.blendFuncSeparate(1,771,1,771);break;case 2:e.blendFunc(1,1);break;case 3:e.blendFuncSeparate(0,0,769,771);break;case 4:e.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}else switch(t){case 1:e.blendFuncSeparate(770,771,1,771);break;case 2:e.blendFunc(770,1);break;case 3:e.blendFunc(0,769);break;case 4:e.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",t)}S=null,E=null,C=null,L=null,w=t,A=d}}else!0===_&&(Y(3042),_=!1)}function Q(t){R!==t&&(t?e.frontFace(2304):e.frontFace(2305),R=t)}function ee(t){0!==t?(X(2884),t!==k&&(1===t?e.cullFace(1029):2===t?e.cullFace(1028):e.cullFace(1032))):Y(2884),k=t}function te(t,n,r){t?(X(32823),I===n&&D===r||(e.polygonOffset(n,r),I=n,D=r)):Y(32823)}function ne(t){void 0===t&&(t=33984+N-1),B!==t&&(e.activeTexture(t),B=t)}return{buffers:{color:h,depth:d,stencil:f},enable:X,disable:Y,bindFramebuffer:function(t,n){null===n&&null!==v&&(n=v),y[t]!==n&&(e.bindFramebuffer(t,n),y[t]=n)},bindXRFramebuffer:function(t){t!==v&&(e.bindFramebuffer(36160,t),v=t)},useProgram:function(t){return x!==t&&(e.useProgram(t),x=t,!0)},setBlending:K,setMaterial:function(e,t){2===e.side?Y(2884):X(2884);var n=1===e.side;t&&(n=!n),Q(n),1===e.blending&&!1===e.transparent?K(0):K(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha),d.setFunc(e.depthFunc),d.setTest(e.depthTest),d.setMask(e.depthWrite),h.setMask(e.colorWrite);var r=e.stencilWrite;f.setTest(r),r&&(f.setMask(e.stencilWriteMask),f.setFunc(e.stencilFunc,e.stencilRef,e.stencilFuncMask),f.setOp(e.stencilFail,e.stencilZFail,e.stencilZPass)),te(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits),!0===e.alphaToCoverage?X(32926):Y(32926)},setFlipSided:Q,setCullFace:ee,setLineWidth:function(t){t!==O&&(H&&e.lineWidth(t),O=t)},setPolygonOffset:te,setScissorTest:function(e){e?X(3089):Y(3089)},activeTexture:ne,bindTexture:function(t,n){null===B&&ne();var r=U[B];void 0===r&&(r={type:void 0,texture:void 0},U[B]=r),r.type===t&&r.texture===n||(e.bindTexture(t,n||W[t]),r.type=t,r.texture=n)},unbindTexture:function(){var t=U[B];void 0!==t&&void 0!==t.type&&(e.bindTexture(t.type,null),t.type=void 0,t.texture=void 0)},compressedTexImage2D:function(){try{e.compressedTexImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage2D:function(){try{e.texImage2D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},texImage3D:function(){try{e.texImage3D.apply(e,arguments)}catch(e){console.error("THREE.WebGLState:",e)}},scissor:function(t){!1===j.equals(t)&&(e.scissor(t.x,t.y,t.z,t.w),j.copy(t))},viewport:function(t){!1===G.equals(t)&&(e.viewport(t.x,t.y,t.z,t.w),G.copy(t))},reset:function(){e.disable(3042),e.disable(2884),e.disable(2929),e.disable(32823),e.disable(3089),e.disable(2960),e.disable(32926),e.blendEquation(32774),e.blendFunc(1,0),e.blendFuncSeparate(1,0,1,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(513),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(519,0,4294967295),e.stencilOp(7680,7680,7680),e.clearStencil(0),e.cullFace(1029),e.frontFace(2305),e.polygonOffset(0,0),e.activeTexture(33984),e.bindFramebuffer(36160,null),!0===c&&(e.bindFramebuffer(36009,null),e.bindFramebuffer(36008,null)),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),m={},B=null,U={},v=null,y={},x=null,_=!1,w=null,M=null,S=null,E=null,T=null,C=null,L=null,A=!1,R=null,k=null,O=null,I=null,D=null,j.set(0,0,e.canvas.width,e.canvas.height),G.set(0,0,e.canvas.width,e.canvas.height),h.reset(),d.reset(),f.reset()}}}function wa(e,t,n,r,l,c,h){var d,f,m,v=l.isWebGL2,y=l.maxTextures,x=l.maxCubemapSize,_=l.maxTextureSize,w=l.maxSamples,M=new WeakMap,S=!1;try{S="undefined"!=typeof OffscreenCanvas&&null!==new OffscreenCanvas(1,1).getContext("2d")}catch(e){}function E(e,t){return S?new OffscreenCanvas(e,t):document.createElementNS("http://www.w3.org/1999/xhtml","canvas")}function T(image,e,t,n){var r=1;if((image.width>n||image.height>n)&&(r=n/Math.max(image.width,image.height)),r<1||!0===e){if("undefined"!=typeof HTMLImageElement&&image instanceof HTMLImageElement||"undefined"!=typeof HTMLCanvasElement&&image instanceof HTMLCanvasElement||"undefined"!=typeof ImageBitmap&&image instanceof ImageBitmap){var o=e?Me.floorPowerOfTwo:Math.floor,l=o(r*image.width),c=o(r*image.height);void 0===m&&(m=E(l,c));var canvas=t?E(l,c):m;return canvas.width=l,canvas.height=c,canvas.getContext("2d").drawImage(image,0,0,l,c),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+image.width+"x"+image.height+") to ("+l+"x"+c+")."),canvas}return"data"in image&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+image.width+"x"+image.height+")."),image}return image}function C(image){return Me.isPowerOfTwo(image.width)&&Me.isPowerOfTwo(image.height)}function L(e,t){return e.generateMipmaps&&t&&e.minFilter!==B&&e.minFilter!==G}function A(t,n,o,l){e.generateMipmap(t),r.get(n).__maxMipLevel=Math.log2(Math.max(o,l))}function R(n,r,o){if(!1===v)return r;if(null!==n){if(void 0!==e[n])return e[n];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+n+"'")}var l=r;return 6403===r&&(5126===o&&(l=33326),5131===o&&(l=33325),5121===o&&(l=33321)),6407===r&&(5126===o&&(l=34837),5131===o&&(l=34843),5121===o&&(l=32849)),6408===r&&(5126===o&&(l=34836),5131===o&&(l=34842),5121===o&&(l=32856)),33325!==l&&33326!==l&&34842!==l&&34836!==l||t.get("EXT_color_buffer_float"),l}function k(e){return e===B||e===U||e===j?9728:9729}function P(t){var n=t.target;n.removeEventListener("dispose",P),function(t){var n=r.get(t);if(void 0===n.__webglInit)return;e.deleteTexture(n.__webglTexture),r.remove(t)}(n),n.isVideoTexture&&M.delete(n),h.memory.textures--}function O(t){var n=t.target;n.removeEventListener("dispose",O),function(t){var n=t.texture,o=r.get(t),l=r.get(n);if(!t)return;void 0!==l.__webglTexture&&e.deleteTexture(l.__webglTexture);t.depthTexture&&t.depthTexture.dispose();if(t.isWebGLCubeRenderTarget)for(var c=0;c<6;c++)e.deleteFramebuffer(o.__webglFramebuffer[c]),o.__webglDepthbuffer&&e.deleteRenderbuffer(o.__webglDepthbuffer[c]);else e.deleteFramebuffer(o.__webglFramebuffer),o.__webglDepthbuffer&&e.deleteRenderbuffer(o.__webglDepthbuffer),o.__webglMultisampledFramebuffer&&e.deleteFramebuffer(o.__webglMultisampledFramebuffer),o.__webglColorRenderbuffer&&e.deleteRenderbuffer(o.__webglColorRenderbuffer),o.__webglDepthRenderbuffer&&e.deleteRenderbuffer(o.__webglDepthRenderbuffer);r.remove(n),r.remove(t)}(n),h.memory.textures--}var I=0;function D(e,slot){var t=r.get(e);if(e.isVideoTexture&&function(e){var t=h.render.frame;M.get(e)!==t&&(M.set(e,t),e.update())}(e),e.version>0&&t.__version!==e.version){var image=e.image;if(void 0===image)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else{if(!1!==image.complete)return void oe(t,e,slot);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete")}}n.activeTexture(33984+slot),n.bindTexture(3553,t.__webglTexture)}function N(t,slot){var o=r.get(t);t.version>0&&o.__version!==t.version?function(t,r,slot){if(6!==r.image.length)return;ae(t,r),n.activeTexture(33984+slot),n.bindTexture(34067,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);for(var o=r&&(r.isCompressedTexture||r.image[0].isCompressedTexture),l=r.image[0]&&r.image[0].isDataTexture,h=[],d=0;d<6;d++)h[d]=o||l?l?r.image[d].image:r.image[d]:T(r.image[d],!1,!0,x);var f,image=h[0],m=C(image)||v,y=c.convert(r.format),_=c.convert(r.type),w=R(r.internalFormat,y,_);if(re(34067,r,m),o){for(var M=0;M<6;M++){f=h[M].mipmaps;for(var S=0;S<f.length;S++){var E=f[S];r.format!==ee&&r.format!==Q?null!==y?n.compressedTexImage2D(34069+M,S,w,E.width,E.height,0,E.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(34069+M,S,w,E.width,E.height,0,y,_,E.data)}}t.__maxMipLevel=f.length-1}else{f=r.mipmaps;for(var k=0;k<6;k++)if(l){n.texImage2D(34069+k,0,w,h[k].width,h[k].height,0,y,_,h[k].data);for(var P=0;P<f.length;P++){var O=f[P].image[k].image;n.texImage2D(34069+k,P+1,w,O.width,O.height,0,y,_,O.data)}}else{n.texImage2D(34069+k,0,w,y,_,h[k]);for(var I=0;I<f.length;I++){var D=f[I];n.texImage2D(34069+k,I+1,w,y,_,D.image[k])}}t.__maxMipLevel=f.length}L(r,m)&&A(34067,r,image.width,image.height);t.__version=r.version,r.onUpdate&&r.onUpdate(r)}(o,t,slot):(n.activeTexture(33984+slot),n.bindTexture(34067,o.__webglTexture))}var X=(d={},Object(o.a)(d,H,10497),Object(o.a)(d,z,33071),Object(o.a)(d,F,33648),d),ie=(f={},Object(o.a)(f,B,9728),Object(o.a)(f,U,9984),Object(o.a)(f,j,9986),Object(o.a)(f,G,9729),Object(o.a)(f,V,9985),Object(o.a)(f,W,9987),f);function re(n,o,c){if(c?(e.texParameteri(n,10242,X[o.wrapS]),e.texParameteri(n,10243,X[o.wrapT]),32879!==n&&35866!==n||e.texParameteri(n,32882,X[o.wrapR]),e.texParameteri(n,10240,ie[o.magFilter]),e.texParameteri(n,10241,ie[o.minFilter])):(e.texParameteri(n,10242,33071),e.texParameteri(n,10243,33071),32879!==n&&35866!==n||e.texParameteri(n,32882,33071),o.wrapS===z&&o.wrapT===z||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),e.texParameteri(n,10240,k(o.magFilter)),e.texParameteri(n,10241,k(o.minFilter)),o.minFilter!==B&&o.minFilter!==G&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),!0===t.has("EXT_texture_filter_anisotropic")){var h=t.get("EXT_texture_filter_anisotropic");if(o.type===J&&!1===t.has("OES_texture_float_linear"))return;if(!1===v&&o.type===$&&!1===t.has("OES_texture_half_float_linear"))return;(o.anisotropy>1||r.get(o).__currentAnisotropy)&&(e.texParameterf(n,h.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(o.anisotropy,l.getMaxAnisotropy())),r.get(o).__currentAnisotropy=o.anisotropy)}}function ae(t,n){void 0===t.__webglInit&&(t.__webglInit=!0,n.addEventListener("dispose",P),t.__webglTexture=e.createTexture(),h.memory.textures++)}function oe(t,r,slot){var o=3553;r.isDataTexture2DArray&&(o=35866),r.isDataTexture3D&&(o=32879),ae(t,r),n.activeTexture(33984+slot),n.bindTexture(o,t.__webglTexture),e.pixelStorei(37440,r.flipY),e.pixelStorei(37441,r.premultiplyAlpha),e.pixelStorei(3317,r.unpackAlignment),e.pixelStorei(37443,0);var l,h=function(e){return!v&&(e.wrapS!==z||e.wrapT!==z||e.minFilter!==B&&e.minFilter!==G)}(r)&&!1===C(r.image),image=T(r.image,h,!1,_),d=C(image)||v,f=c.convert(r.format),m=c.convert(r.type),y=R(r.internalFormat,f,m);re(o,r,d);var x=r.mipmaps;if(r.isDepthTexture)y=6402,v?y=r.type===J?36012:r.type===Z?33190:r.type===K?35056:33189:r.type===J&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),r.format===te&&6402===y&&r.type!==Y&&r.type!==Z&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=Y,m=c.convert(r.type)),r.format===ne&&6402===y&&(y=34041,r.type!==K&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=K,m=c.convert(r.type))),n.texImage2D(3553,0,y,image.width,image.height,0,f,m,null);else if(r.isDataTexture)if(x.length>0&&d){for(var w=0,M=x.length;w<M;w++)l=x[w],n.texImage2D(3553,w,y,l.width,l.height,0,f,m,l.data);r.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(3553,0,y,image.width,image.height,0,f,m,image.data),t.__maxMipLevel=0;else if(r.isCompressedTexture){for(var S=0,E=x.length;S<E;S++)l=x[S],r.format!==ee&&r.format!==Q?null!==f?n.compressedTexImage2D(3553,S,y,l.width,l.height,0,l.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(3553,S,y,l.width,l.height,0,f,m,l.data);t.__maxMipLevel=x.length-1}else if(r.isDataTexture2DArray)n.texImage3D(35866,0,y,image.width,image.height,image.depth,0,f,m,image.data),t.__maxMipLevel=0;else if(r.isDataTexture3D)n.texImage3D(32879,0,y,image.width,image.height,image.depth,0,f,m,image.data),t.__maxMipLevel=0;else if(x.length>0&&d){for(var k=0,P=x.length;k<P;k++)l=x[k],n.texImage2D(3553,k,y,f,m,l);r.generateMipmaps=!1,t.__maxMipLevel=x.length-1}else n.texImage2D(3553,0,y,f,m,image),t.__maxMipLevel=0;L(r,d)&&A(o,r,image.width,image.height),t.__version=r.version,r.onUpdate&&r.onUpdate(r)}function se(t,o,l,h){var d=o.texture,f=c.convert(d.format),m=c.convert(d.type),v=R(d.internalFormat,f,m);32879===h||35866===h?n.texImage3D(h,0,v,o.width,o.height,o.depth,0,f,m,null):n.texImage2D(h,0,v,o.width,o.height,0,f,m,null),n.bindFramebuffer(36160,t),e.framebufferTexture2D(36160,l,h,r.get(d).__webglTexture,0),n.bindFramebuffer(36160,null)}function le(t,n,r){if(e.bindRenderbuffer(36161,t),n.depthBuffer&&!n.stencilBuffer){var o=33189;if(r){var l=n.depthTexture;l&&l.isDepthTexture&&(l.type===J?o=36012:l.type===Z&&(o=33190));var h=ue(n);e.renderbufferStorageMultisample(36161,h,o,n.width,n.height)}else e.renderbufferStorage(36161,o,n.width,n.height);e.framebufferRenderbuffer(36160,36096,36161,t)}else if(n.depthBuffer&&n.stencilBuffer){if(r){var d=ue(n);e.renderbufferStorageMultisample(36161,d,35056,n.width,n.height)}else e.renderbufferStorage(36161,34041,n.width,n.height);e.framebufferRenderbuffer(36160,33306,36161,t)}else{var f=n.texture,m=c.convert(f.format),v=c.convert(f.type),y=R(f.internalFormat,m,v);if(r){var x=ue(n);e.renderbufferStorageMultisample(36161,x,y,n.width,n.height)}else e.renderbufferStorage(36161,y,n.width,n.height)}e.bindRenderbuffer(36161,null)}function ce(t){var o=r.get(t),l=!0===t.isWebGLCubeRenderTarget;if(t.depthTexture){if(l)throw new Error("target.depthTexture not supported in Cube render targets");!function(t,o){if(o&&o.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,t),!o.depthTexture||!o.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(o.depthTexture).__webglTexture&&o.depthTexture.image.width===o.width&&o.depthTexture.image.height===o.height||(o.depthTexture.image.width=o.width,o.depthTexture.image.height=o.height,o.depthTexture.needsUpdate=!0),D(o.depthTexture,0);var l=r.get(o.depthTexture).__webglTexture;if(o.depthTexture.format===te)e.framebufferTexture2D(36160,36096,3553,l,0);else{if(o.depthTexture.format!==ne)throw new Error("Unknown depthTexture format");e.framebufferTexture2D(36160,33306,3553,l,0)}}(o.__webglFramebuffer,t)}else if(l){o.__webglDepthbuffer=[];for(var c=0;c<6;c++)n.bindFramebuffer(36160,o.__webglFramebuffer[c]),o.__webglDepthbuffer[c]=e.createRenderbuffer(),le(o.__webglDepthbuffer[c],t,!1)}else n.bindFramebuffer(36160,o.__webglFramebuffer),o.__webglDepthbuffer=e.createRenderbuffer(),le(o.__webglDepthbuffer,t,!1);n.bindFramebuffer(36160,null)}function ue(e){return v&&e.isWebGLMultisampleRenderTarget?Math.min(w,e.samples):0}var he=!1,de=!1;this.allocateTextureUnit=function(){var e=I;return e>=y&&console.warn("THREE.WebGLTextures: Trying to use "+e+" texture units while this GPU supports only "+y),I+=1,e},this.resetTextureUnits=function(){I=0},this.setTexture2D=D,this.setTexture2DArray=function(e,slot){var t=r.get(e);e.version>0&&t.__version!==e.version?oe(t,e,slot):(n.activeTexture(33984+slot),n.bindTexture(35866,t.__webglTexture))},this.setTexture3D=function(e,slot){var t=r.get(e);e.version>0&&t.__version!==e.version?oe(t,e,slot):(n.activeTexture(33984+slot),n.bindTexture(32879,t.__webglTexture))},this.setTextureCube=N,this.setupRenderTarget=function(t){var o=t.texture,l=r.get(t),d=r.get(o);t.addEventListener("dispose",O),d.__webglTexture=e.createTexture(),d.__version=o.version,h.memory.textures++;var f=!0===t.isWebGLCubeRenderTarget,m=!0===t.isWebGLMultisampleRenderTarget,y=o.isDataTexture3D||o.isDataTexture2DArray,x=C(t)||v;if(!v||o.format!==Q||o.type!==J&&o.type!==$||(o.format=ee,console.warn("THREE.WebGLRenderer: Rendering to textures with RGB format is not supported. Using RGBA format instead.")),f){l.__webglFramebuffer=[];for(var _=0;_<6;_++)l.__webglFramebuffer[_]=e.createFramebuffer()}else if(l.__webglFramebuffer=e.createFramebuffer(),m)if(v){l.__webglMultisampledFramebuffer=e.createFramebuffer(),l.__webglColorRenderbuffer=e.createRenderbuffer(),e.bindRenderbuffer(36161,l.__webglColorRenderbuffer);var w=c.convert(o.format),M=c.convert(o.type),S=R(o.internalFormat,w,M),E=ue(t);e.renderbufferStorageMultisample(36161,E,S,t.width,t.height),n.bindFramebuffer(36160,l.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(36160,36064,36161,l.__webglColorRenderbuffer),e.bindRenderbuffer(36161,null),t.depthBuffer&&(l.__webglDepthRenderbuffer=e.createRenderbuffer(),le(l.__webglDepthRenderbuffer,t,!0)),n.bindFramebuffer(36160,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(f){n.bindTexture(34067,d.__webglTexture),re(34067,o,x);for(var T=0;T<6;T++)se(l.__webglFramebuffer[T],t,36064,34069+T);L(o,x)&&A(34067,o,t.width,t.height),n.bindTexture(34067,null)}else{var k=3553;if(y)if(v)k=o.isDataTexture3D?32879:35866;else console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.");n.bindTexture(k,d.__webglTexture),re(k,o,x),se(l.__webglFramebuffer,t,36064,k),L(o,x)&&A(3553,o,t.width,t.height),n.bindTexture(3553,null)}t.depthBuffer&&ce(t)},this.updateRenderTargetMipmap=function(e){var t=e.texture;if(L(t,C(e)||v)){var o=e.isWebGLCubeRenderTarget?34067:3553,l=r.get(t).__webglTexture;n.bindTexture(o,l),A(o,t,e.width,e.height),n.bindTexture(o,null)}},this.updateMultisampleRenderTarget=function(t){if(t.isWebGLMultisampleRenderTarget)if(v){var o=r.get(t);n.bindFramebuffer(36008,o.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,o.__webglFramebuffer);var l=t.width,c=t.height,mask=16384;t.depthBuffer&&(mask|=256),t.stencilBuffer&&(mask|=1024),e.blitFramebuffer(0,0,l,c,0,0,l,c,mask,9728),n.bindFramebuffer(36160,o.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")},this.safeSetTexture2D=function(e,slot){e&&e.isWebGLRenderTarget&&(!1===he&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),he=!0),e=e.texture),D(e,slot)},this.safeSetTextureCube=function(e,slot){e&&e.isWebGLCubeRenderTarget&&(!1===de&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),de=!0),e=e.texture),N(e,slot)}}function Ma(e,t,n){var r=n.isWebGL2;return{convert:function(p){var e;if(p===X)return 5121;if(1017===p)return 32819;if(1018===p)return 32820;if(1019===p)return 33635;if(1010===p)return 5120;if(1011===p)return 5122;if(p===Y)return 5123;if(1013===p)return 5124;if(p===Z)return 5125;if(p===J)return 5126;if(p===$)return r?5131:null!==(e=t.get("OES_texture_half_float"))?e.HALF_FLOAT_OES:null;if(1021===p)return 6406;if(p===Q)return 6407;if(p===ee)return 6408;if(1024===p)return 6409;if(1025===p)return 6410;if(p===te)return 6402;if(p===ne)return 34041;if(1028===p)return 6403;if(1029===p)return 36244;if(1030===p)return 33319;if(1031===p)return 33320;if(1032===p)return 36248;if(1033===p)return 36249;if(33776===p||33777===p||33778===p||33779===p){if(null===(e=t.get("WEBGL_compressed_texture_s3tc")))return null;if(33776===p)return e.COMPRESSED_RGB_S3TC_DXT1_EXT;if(33777===p)return e.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(33778===p)return e.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(33779===p)return e.COMPRESSED_RGBA_S3TC_DXT5_EXT}if(35840===p||35841===p||35842===p||35843===p){if(null===(e=t.get("WEBGL_compressed_texture_pvrtc")))return null;if(35840===p)return e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(35841===p)return e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(35842===p)return e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(35843===p)return e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(36196===p)return null!==(e=t.get("WEBGL_compressed_texture_etc1"))?e.COMPRESSED_RGB_ETC1_WEBGL:null;if((37492===p||37496===p)&&null!==(e=t.get("WEBGL_compressed_texture_etc"))){if(37492===p)return e.COMPRESSED_RGB8_ETC2;if(37496===p)return e.COMPRESSED_RGBA8_ETC2_EAC}return 37808===p||37809===p||37810===p||37811===p||37812===p||37813===p||37814===p||37815===p||37816===p||37817===p||37818===p||37819===p||37820===p||37821===p||37840===p||37841===p||37842===p||37843===p||37844===p||37845===p||37846===p||37847===p||37848===p||37849===p||37850===p||37851===p||37852===p||37853===p?null!==(e=t.get("WEBGL_compressed_texture_astc"))?p:null:36492===p?null!==(e=t.get("EXT_texture_compression_bptc"))?p:null:p===K?r?34042:null!==(e=t.get("WEBGL_depth_texture"))?e.UNSIGNED_INT_24_8_WEBGL:null:void 0}}}var Sa=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(x.a)(this,n),(e=t.call(this)).cameras=r,e}return Object(_.a)(n)}(ri);Sa.prototype.isArrayCamera=!0;var Ea=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e;return Object(x.a)(this,n),(e=t.call(this)).type="Group",e}return Object(_.a)(n)}(zt);function Ta(){this._targetRay=null,this._grip=null,this._hand=null}function Ca(e,t){var n=this,o=e.state,l=null,c=1,h=null,d="local-floor",f=null,m=[],v=new Map,y=new ri;y.layers.enable(1),y.viewport=new ke;var x=new ri;x.layers.enable(2),x.viewport=new ke;var _=[y,x],w=new Sa;w.layers.enable(1),w.layers.enable(2);var M=null,S=null;function E(e){var t=v.get(e.inputSource);t&&t.dispatchEvent({type:e.type,data:e.inputSource})}function T(){v.forEach((function(e,t){e.disconnect(t)})),v.clear(),M=null,S=null,o.bindXRFramebuffer(null),e.setRenderTarget(e.getRenderTarget()),P.stop(),n.isPresenting=!1,n.dispatchEvent({type:"sessionend"})}function C(e){for(var t=l.inputSources,n=0;n<m.length;n++)v.set(t[n],m[n]);for(var r=0;r<e.removed.length;r++){var o=e.removed[r],c=v.get(o);c&&(c.dispatchEvent({type:"disconnected",data:o}),v.delete(o))}for(var h=0;h<e.added.length;h++){var d=e.added[h],f=v.get(d);f&&f.dispatchEvent({type:"connected",data:d})}}this.enabled=!1,this.isPresenting=!1,this.getController=function(e){var t=m[e];return void 0===t&&(t=new Ta,m[e]=t),t.getTargetRaySpace()},this.getControllerGrip=function(e){var t=m[e];return void 0===t&&(t=new Ta,m[e]=t),t.getGripSpace()},this.getHand=function(e){var t=m[e];return void 0===t&&(t=new Ta,m[e]=t),t.getHandSpace()},this.setFramebufferScaleFactor=function(e){c=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(e){d=e,!0===n.isPresenting&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h},this.getSession=function(){return l},this.setSession=function(){var e=Object(r.a)(regeneratorRuntime.mark((function e(r){var o,f,m;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===(l=r)){e.next=24;break}if(l.addEventListener("select",E),l.addEventListener("selectstart",E),l.addEventListener("selectend",E),l.addEventListener("squeeze",E),l.addEventListener("squeezestart",E),l.addEventListener("squeezeend",E),l.addEventListener("end",T),l.addEventListener("inputsourceschange",C),!0===(o=t.getContextAttributes()).xrCompatible){e.next=14;break}return e.next=14,t.makeXRCompatible();case 14:return f={antialias:o.antialias,alpha:o.alpha,depth:o.depth,stencil:o.stencil,framebufferScaleFactor:c},m=new XRWebGLLayer(l,t,f),l.updateRenderState({baseLayer:m}),e.next=19,l.requestReferenceSpace(d);case 19:h=e.sent,P.setContext(l),P.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"});case 24:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var L=new Ie,A=new Ie;function R(e,t){null===t?e.matrixWorld.copy(e.matrix):e.matrixWorld.multiplyMatrices(t.matrixWorld,e.matrix),e.matrixWorldInverse.copy(e.matrixWorld).invert()}this.getCamera=function(e){w.near=x.near=y.near=e.near,w.far=x.far=y.far=e.far,M===w.near&&S===w.far||(l.updateRenderState({depthNear:w.near,depthFar:w.far}),M=w.near,S=w.far);var t=e.parent,n=w.cameras;R(w,t);for(var r=0;r<n.length;r++)R(n[r],t);e.matrixWorld.copy(w.matrixWorld),e.matrix.copy(w.matrix),e.matrix.decompose(e.position,e.quaternion,e.scale);for(var o=e.children,c=0,h=o.length;c<h;c++)o[c].updateMatrixWorld(!0);return 2===n.length?function(e,t,n){L.setFromMatrixPosition(t.matrixWorld),A.setFromMatrixPosition(n.matrixWorld);var r=L.distanceTo(A),o=t.projectionMatrix.elements,l=n.projectionMatrix.elements,c=o[14]/(o[10]-1),h=o[14]/(o[10]+1),d=(o[9]+1)/o[5],f=(o[9]-1)/o[5],m=(o[8]-1)/o[0],v=(l[8]+1)/l[0],y=c*m,x=c*v,_=r/(-m+v),w=_*-m;t.matrixWorld.decompose(e.position,e.quaternion,e.scale),e.translateX(w),e.translateZ(_),e.matrixWorld.compose(e.position,e.quaternion,e.scale),e.matrixWorldInverse.copy(e.matrixWorld).invert();var M=c+_,S=h+_,E=y-w,T=x+(r-w),C=d*h/S*M,R=f*h/S*M;e.projectionMatrix.makePerspective(E,T,C,R,M,S)}(w,y,x):w.projectionMatrix.copy(y.projectionMatrix),w};var k=null;var P=new fi;P.setAnimationLoop((function(time,e){if(null!==(f=e.getViewerPose(h))){var t=f.views,n=l.renderState.baseLayer;o.bindXRFramebuffer(n.framebuffer);var r=!1;t.length!==w.cameras.length&&(w.cameras.length=0,r=!0);for(var c=0;c<t.length;c++){var view=t[c],d=n.getViewport(view),v=_[c];v.matrix.fromArray(view.transform.matrix),v.projectionMatrix.fromArray(view.projectionMatrix),v.viewport.set(d.x,d.y,d.width,d.height),0===c&&w.matrix.copy(v.matrix),!0===r&&w.cameras.push(v)}}for(var y=l.inputSources,x=0;x<m.length;x++){var M=m[x],S=y[x];M.update(S,e,h)}k&&k(time,e)})),this.setAnimationLoop=function(e){k=e},this.dispose=function(){}}function La(e){function t(t,n){t.opacity.value=n.opacity,n.color&&t.diffuse.value.copy(n.color),n.emissive&&t.emissive.value.copy(n.emissive).multiplyScalar(n.emissiveIntensity),n.map&&(t.map.value=n.map),n.alphaMap&&(t.alphaMap.value=n.alphaMap),n.specularMap&&(t.specularMap.value=n.specularMap);var r,o,l=e.get(n).envMap;if(l){t.envMap.value=l,t.flipEnvMap.value=l.isCubeTexture&&l._needsFlipEnvMap?-1:1,t.reflectivity.value=n.reflectivity,t.refractionRatio.value=n.refractionRatio;var c=e.get(l).__maxMipLevel;void 0!==c&&(t.maxMipLevel.value=c)}n.lightMap&&(t.lightMap.value=n.lightMap,t.lightMapIntensity.value=n.lightMapIntensity),n.aoMap&&(t.aoMap.value=n.aoMap,t.aoMapIntensity.value=n.aoMapIntensity),n.map?r=n.map:n.specularMap?r=n.specularMap:n.displacementMap?r=n.displacementMap:n.normalMap?r=n.normalMap:n.bumpMap?r=n.bumpMap:n.roughnessMap?r=n.roughnessMap:n.metalnessMap?r=n.metalnessMap:n.alphaMap?r=n.alphaMap:n.emissiveMap?r=n.emissiveMap:n.clearcoatMap?r=n.clearcoatMap:n.clearcoatNormalMap?r=n.clearcoatNormalMap:n.clearcoatRoughnessMap&&(r=n.clearcoatRoughnessMap),void 0!==r&&(r.isWebGLRenderTarget&&(r=r.texture),!0===r.matrixAutoUpdate&&r.updateMatrix(),t.uvTransform.value.copy(r.matrix)),n.aoMap?o=n.aoMap:n.lightMap&&(o=n.lightMap),void 0!==o&&(o.isWebGLRenderTarget&&(o=o.texture),!0===o.matrixAutoUpdate&&o.updateMatrix(),t.uv2Transform.value.copy(o.matrix))}function n(t,n){t.roughness.value=n.roughness,t.metalness.value=n.metalness,n.roughnessMap&&(t.roughnessMap.value=n.roughnessMap),n.metalnessMap&&(t.metalnessMap.value=n.metalnessMap),n.emissiveMap&&(t.emissiveMap.value=n.emissiveMap),n.bumpMap&&(t.bumpMap.value=n.bumpMap,t.bumpScale.value=n.bumpScale,1===n.side&&(t.bumpScale.value*=-1)),n.normalMap&&(t.normalMap.value=n.normalMap,t.normalScale.value.copy(n.normalScale),1===n.side&&t.normalScale.value.negate()),n.displacementMap&&(t.displacementMap.value=n.displacementMap,t.displacementScale.value=n.displacementScale,t.displacementBias.value=n.displacementBias),e.get(n).envMap&&(t.envMapIntensity.value=n.envMapIntensity)}return{refreshFogUniforms:function(e,t){e.fogColor.value.copy(t.color),t.isFog?(e.fogNear.value=t.near,e.fogFar.value=t.far):t.isFogExp2&&(e.fogDensity.value=t.density)},refreshMaterialUniforms:function(e,r,o,l){r.isMeshBasicMaterial?t(e,r):r.isMeshLambertMaterial?(t(e,r),function(e,t){t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap)}(e,r)):r.isMeshToonMaterial?(t(e,r),function(e,t){t.gradientMap&&(e.gradientMap.value=t.gradientMap);t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshPhongMaterial?(t(e,r),function(e,t){e.specular.value.copy(t.specular),e.shininess.value=Math.max(t.shininess,1e-4),t.emissiveMap&&(e.emissiveMap.value=t.emissiveMap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshStandardMaterial?(t(e,r),r.isMeshPhysicalMaterial?function(e,t){n(e,t),e.reflectivity.value=t.reflectivity,e.clearcoat.value=t.clearcoat,e.clearcoatRoughness.value=t.clearcoatRoughness,t.sheen&&e.sheen.value.copy(t.sheen);t.clearcoatMap&&(e.clearcoatMap.value=t.clearcoatMap);t.clearcoatRoughnessMap&&(e.clearcoatRoughnessMap.value=t.clearcoatRoughnessMap);t.clearcoatNormalMap&&(e.clearcoatNormalScale.value.copy(t.clearcoatNormalScale),e.clearcoatNormalMap.value=t.clearcoatNormalMap,1===t.side&&e.clearcoatNormalScale.value.negate());e.transmission.value=t.transmission,t.transmissionMap&&(e.transmissionMap.value=t.transmissionMap)}(e,r):n(e,r)):r.isMeshMatcapMaterial?(t(e,r),function(e,t){t.matcap&&(e.matcap.value=t.matcap);t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDepthMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isMeshDistanceMaterial?(t(e,r),function(e,t){t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias);e.referencePosition.value.copy(t.referencePosition),e.nearDistance.value=t.nearDistance,e.farDistance.value=t.farDistance}(e,r)):r.isMeshNormalMaterial?(t(e,r),function(e,t){t.bumpMap&&(e.bumpMap.value=t.bumpMap,e.bumpScale.value=t.bumpScale,1===t.side&&(e.bumpScale.value*=-1));t.normalMap&&(e.normalMap.value=t.normalMap,e.normalScale.value.copy(t.normalScale),1===t.side&&e.normalScale.value.negate());t.displacementMap&&(e.displacementMap.value=t.displacementMap,e.displacementScale.value=t.displacementScale,e.displacementBias.value=t.displacementBias)}(e,r)):r.isLineBasicMaterial?(function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity}(e,r),r.isLineDashedMaterial&&function(e,t){e.dashSize.value=t.dashSize,e.totalSize.value=t.dashSize+t.gapSize,e.scale.value=t.scale}(e,r)):r.isPointsMaterial?function(e,t,n,r){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.size.value=t.size*n,e.scale.value=.5*r,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var o;t.map?o=t.map:t.alphaMap&&(o=t.alphaMap);void 0!==o&&(!0===o.matrixAutoUpdate&&o.updateMatrix(),e.uvTransform.value.copy(o.matrix))}(e,r,o,l):r.isSpriteMaterial?function(e,t){e.diffuse.value.copy(t.color),e.opacity.value=t.opacity,e.rotation.value=t.rotation,t.map&&(e.map.value=t.map);t.alphaMap&&(e.alphaMap.value=t.alphaMap);var n;t.map?n=t.map:t.alphaMap&&(n=t.alphaMap);void 0!==n&&(!0===n.matrixAutoUpdate&&n.updateMatrix(),e.uvTransform.value.copy(n.matrix))}(e,r):r.isShadowMaterial?(e.color.value.copy(r.color),e.opacity.value=r.opacity):r.isShaderMaterial&&(r.uniformsNeedUpdate=!1)}}}function Aa(e){var canvas,t=void 0!==(e=e||{}).canvas?e.canvas:((canvas=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")).style.display="block",canvas),n=void 0!==e.context?e.context:null,r=void 0!==e.alpha&&e.alpha,o=void 0===e.depth||e.depth,l=void 0===e.stencil||e.stencil,c=void 0!==e.antialias&&e.antialias,h=void 0===e.premultipliedAlpha||e.premultipliedAlpha,d=void 0!==e.preserveDrawingBuffer&&e.preserveDrawingBuffer,f=void 0!==e.powerPreference?e.powerPreference:"default",m=void 0!==e.failIfMajorPerformanceCaveat&&e.failIfMajorPerformanceCaveat,v=null,y=null,x=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.outputEncoding=he,this.physicallyCorrectLights=!1,this.toneMapping=0,this.toneMappingExposure=1;var w=this,M=!1,S=0,E=0,T=null,C=-1,L=null,A=new ke,R=new ke,k=null,P=t.width,O=t.height,I=1,D=null,N=null,H=new ke(0,0,P,O),z=new ke(0,0,P,O),F=!1,B=new pi,U=!1,j=!1,G=new pt,V=new Ie,W={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function Y(){return null===T?I:1}var Z,K,Q,te,ne,ie,re,ae,oe,se,le,ce,ue,de,pe,fe,me,ve,ge,ye,xe,be,_e=n;function we(e,n){for(var r=0;r<e.length;r++){var o=e[r],l=t.getContext(o,n);if(null!==l)return l}return null}try{var Ee={alpha:r,depth:o,stencil:l,antialias:c,premultipliedAlpha:h,preserveDrawingBuffer:d,powerPreference:f,failIfMajorPerformanceCaveat:m};if(t.addEventListener("webglcontextlost",Ae,!1),t.addEventListener("webglcontextrestored",Re,!1),null===_e){var Te=["webgl2","webgl","experimental-webgl"];if(!0===w.isWebGL1Renderer&&Te.shift(),null===(_e=we(Te,Ee)))throw we(Te)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}void 0===_e.getShaderPrecisionFormat&&(_e.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(e){throw console.error("THREE.WebGLRenderer: "+e.message),e}function Ce(){Z=new Ti(_e),K=new Mi(_e,Z,e),Z.init(K),xe=new Ma(_e,Z,K),Q=new _a(_e,Z,K),te=new Ai(_e),ne=new sa,ie=new wa(_e,Z,Q,ne,K,xe,te),re=new Ei(w),ae=new mi(_e,K),be=new _i(_e,Z,ae,K),oe=new Ci(_e,ae,te,be),se=new Oi(_e,oe,ae,te),ve=new Pi(_e),pe=new Si(ne),le=new oa(w,re,Z,K,be,pe),ce=new La(ne),ue=new ha(ne),de=new ga(Z,K),me=new bi(w,re,Q,se,h),fe=new ba(w,se,K),ge=new wi(_e,Z,te,K),ye=new Li(_e,Z,te,K),te.programs=le.programs,w.capabilities=K,w.extensions=Z,w.properties=ne,w.renderLists=ue,w.shadowMap=fe,w.state=Q,w.info=te}Ce();var Le=new Ca(w,_e);function Ae(e){e.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),M=!0}function Re(){console.log("THREE.WebGLRenderer: Context Restored."),M=!1;var e=te.autoReset,t=fe.enabled,n=fe.autoUpdate,r=fe.needsUpdate,o=fe.type;Ce(),te.autoReset=e,fe.enabled=t,fe.autoUpdate=n,fe.needsUpdate=r,fe.type=o}function Pe(e){var t=e.target;t.removeEventListener("dispose",Pe),function(e){(function(e){var t=ne.get(e).programs;void 0!==t&&t.forEach((function(e){le.releaseProgram(e)}))})(e),ne.remove(e)}(t)}this.xr=Le,this.getContext=function(){return _e},this.getContextAttributes=function(){return _e.getContextAttributes()},this.forceContextLoss=function(){var e=Z.get("WEBGL_lose_context");e&&e.loseContext()},this.forceContextRestore=function(){var e=Z.get("WEBGL_lose_context");e&&e.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(e){void 0!==e&&(I=e,this.setSize(P,O,!1))},this.getSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getsize() now requires a Vector2 as an argument"),e=new Se),e.set(P,O)},this.setSize=function(e,n,r){Le.isPresenting?console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting."):(P=e,O=n,t.width=Math.floor(e*I),t.height=Math.floor(n*I),!1!==r&&(t.style.width=e+"px",t.style.height=n+"px"),this.setViewport(0,0,e,n))},this.getDrawingBufferSize=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getdrawingBufferSize() now requires a Vector2 as an argument"),e=new Se),e.set(P*I,O*I).floor()},this.setDrawingBufferSize=function(e,n,r){P=e,O=n,I=r,t.width=Math.floor(e*r),t.height=Math.floor(n*r),this.setViewport(0,0,e,n)},this.getCurrentViewport=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getCurrentViewport() now requires a Vector4 as an argument"),e=new ke),e.copy(A)},this.getViewport=function(e){return e.copy(H)},this.setViewport=function(e,t,n,r){e.isVector4?H.set(e.x,e.y,e.z,e.w):H.set(e,t,n,r),Q.viewport(A.copy(H).multiplyScalar(I).floor())},this.getScissor=function(e){return e.copy(z)},this.setScissor=function(e,t,n,r){e.isVector4?z.set(e.x,e.y,e.z,e.w):z.set(e,t,n,r),Q.scissor(R.copy(z).multiplyScalar(I).floor())},this.getScissorTest=function(){return F},this.setScissorTest=function(e){Q.setScissorTest(F=e)},this.setOpaqueSort=function(e){D=e},this.setTransparentSort=function(e){N=e},this.getClearColor=function(e){return void 0===e&&(console.warn("WebGLRenderer: .getClearColor() now requires a Color as an argument"),e=new cn),e.copy(me.getClearColor())},this.setClearColor=function(){me.setClearColor.apply(me,arguments)},this.getClearAlpha=function(){return me.getClearAlpha()},this.setClearAlpha=function(){me.setClearAlpha.apply(me,arguments)},this.clear=function(e,t,n){var r=0;(void 0===e||e)&&(r|=16384),(void 0===t||t)&&(r|=256),(void 0===n||n)&&(r|=1024),_e.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",Ae,!1),t.removeEventListener("webglcontextrestored",Re,!1),ue.dispose(),de.dispose(),ne.dispose(),re.dispose(),se.dispose(),be.dispose(),Le.dispose(),Le.removeEventListener("sessionstart",De),Le.removeEventListener("sessionend",Ne),He.stop()},this.renderBufferImmediate=function(object,e){be.initAttributes();var t=ne.get(object);object.hasPositions&&!t.position&&(t.position=_e.createBuffer()),object.hasNormals&&!t.normal&&(t.normal=_e.createBuffer()),object.hasUvs&&!t.uv&&(t.uv=_e.createBuffer()),object.hasColors&&!t.color&&(t.color=_e.createBuffer());var n=e.getAttributes();object.hasPositions&&(_e.bindBuffer(34962,t.position),_e.bufferData(34962,object.positionArray,35048),be.enableAttribute(n.position),_e.vertexAttribPointer(n.position,3,5126,!1,0,0)),object.hasNormals&&(_e.bindBuffer(34962,t.normal),_e.bufferData(34962,object.normalArray,35048),be.enableAttribute(n.normal),_e.vertexAttribPointer(n.normal,3,5126,!1,0,0)),object.hasUvs&&(_e.bindBuffer(34962,t.uv),_e.bufferData(34962,object.uvArray,35048),be.enableAttribute(n.uv),_e.vertexAttribPointer(n.uv,2,5126,!1,0,0)),object.hasColors&&(_e.bindBuffer(34962,t.color),_e.bufferData(34962,object.colorArray,35048),be.enableAttribute(n.color),_e.vertexAttribPointer(n.color,3,5126,!1,0,0)),be.disableUnusedAttributes(),_e.drawArrays(4,0,object.count),object.count=0},this.renderBufferDirect=function(e,t,n,r,object,o){null===t&&(t=W);var l=object.isMesh&&object.matrixWorld.determinant()<0,c=Ge(e,t,r,object);Q.setMaterial(r,l);var h=n.index,d=n.attributes.position;if(null===h){if(void 0===d||0===d.count)return}else if(0===h.count)return;var f,m=1;!0===r.wireframe&&(h=oe.getWireframeAttribute(n),m=2),(r.morphTargets||r.morphNormals)&&ve.update(object,n,r,c),be.setup(object,r,c,n,h);var v=ge;null!==h&&(f=ae.get(h),(v=ye).setIndex(f));var y=null!==h?h.count:d.count,x=n.drawRange.start*m,_=n.drawRange.count*m,w=null!==o?o.start*m:0,M=null!==o?o.count*m:1/0,S=Math.max(x,w),E=Math.min(y,x+_,w+M)-1,T=Math.max(0,E-S+1);if(0!==T){if(object.isMesh)!0===r.wireframe?(Q.setLineWidth(r.wireframeLinewidth*Y()),v.setMode(1)):v.setMode(4);else if(object.isLine){var C=r.linewidth;void 0===C&&(C=1),Q.setLineWidth(C*Y()),object.isLineSegments?v.setMode(1):object.isLineLoop?v.setMode(2):v.setMode(3)}else object.isPoints?v.setMode(0):object.isSprite&&v.setMode(4);if(object.isInstancedMesh)v.renderInstances(S,T,object.count);else if(n.isInstancedBufferGeometry){var L=Math.min(n.instanceCount,n._maxInstanceCount);v.renderInstances(S,T,L)}else v.render(S,T)}},this.compile=function(e,t){(y=de.get(e)).init(),e.traverseVisible((function(object){object.isLight&&object.layers.test(t.layers)&&(y.pushLight(object),object.castShadow&&y.pushShadow(object))})),y.setupLights(),e.traverse((function(object){var t=object.material;if(t)if(Array.isArray(t))for(var n=0;n<t.length;n++){Ue(t[n],e,object)}else Ue(t,e,object)}))};var Oe=null;function De(){He.stop()}function Ne(){He.start()}var He=new fi;function ze(object,e,t,n){if(!1!==object.visible){if(object.layers.test(e.layers))if(object.isGroup)t=object.renderOrder;else if(object.isLOD)!0===object.autoUpdate&&object.update(e);else if(object.isLight)y.pushLight(object),object.castShadow&&y.pushShadow(object);else if(object.isSprite){if(!object.frustumCulled||B.intersectsSprite(object)){n&&V.setFromMatrixPosition(object.matrixWorld).applyMatrix4(G);var r=se.update(object),o=object.material;o.visible&&v.push(object,r,o,t,V.z,null)}}else if(object.isImmediateRenderObject)n&&V.setFromMatrixPosition(object.matrixWorld).applyMatrix4(G),v.push(object,null,object.material,t,V.z,null);else if((object.isMesh||object.isLine||object.isPoints)&&(object.isSkinnedMesh&&object.skeleton.frame!==te.render.frame&&(object.skeleton.update(),object.skeleton.frame=te.render.frame),!object.frustumCulled||B.intersectsObject(object))){n&&V.setFromMatrixPosition(object.matrixWorld).applyMatrix4(G);var l=se.update(object),c=object.material;if(Array.isArray(c))for(var h=l.groups,d=0,f=h.length;d<f;d++){var m=h[d],x=c[m.materialIndex];x&&x.visible&&v.push(object,l,x,t,V.z,m)}else c.visible&&v.push(object,l,c,t,V.z,null)}for(var _=object.children,w=0,M=_.length;w<M;w++)ze(_[w],e,t,n)}}function Fe(e,t,n){for(var r=!0===t.isScene?t.overrideMaterial:null,o=0,l=e.length;o<l;o++){var c=e[o],object=c.object,h=c.geometry,d=null===r?c.material:r,f=c.group;if(n.isArrayCamera)for(var m=n.cameras,v=0,x=m.length;v<x;v++){var _=m[v];object.layers.test(_.layers)&&(Q.viewport(A.copy(_.viewport)),y.setupLightsView(_),Be(object,t,_,h,d,f))}else Be(object,t,n,h,d,f)}}function Be(object,e,t,n,r,o){if(object.onBeforeRender(w,e,t,n,r,o),object.modelViewMatrix.multiplyMatrices(t.matrixWorldInverse,object.matrixWorld),object.normalMatrix.getNormalMatrix(object.modelViewMatrix),object.isImmediateRenderObject){var l=Ge(t,e,r,object);Q.setMaterial(r),be.reset(),function(object,e){object.render((function(object){w.renderBufferImmediate(object,e)}))}(object,l)}else w.renderBufferDirect(t,e,n,r,object,o);object.onAfterRender(w,e,t,n,r,o)}function Ue(e,t,object){!0!==t.isScene&&(t=W);var n=ne.get(e),r=y.state.lights,o=y.state.shadowsArray,l=r.state.version,c=le.getParameters(e,r.state,o,t,object),h=le.getProgramCacheKey(c),d=n.programs;n.environment=e.isMeshStandardMaterial?t.environment:null,n.fog=t.fog,n.envMap=re.get(e.envMap||n.environment),void 0===d&&(e.addEventListener("dispose",Pe),d=new Map,n.programs=d);var f=d.get(h);if(void 0!==f){if(n.currentProgram===f&&n.lightsStateVersion===l)return je(e,c),f}else c.uniforms=le.getUniforms(e),e.onBeforeCompile(c,w),f=le.acquireProgram(c,h),d.set(h,f),n.uniforms=c.uniforms;var m=n.uniforms;(e.isShaderMaterial||e.isRawShaderMaterial)&&!0!==e.clipping||(m.clippingPlanes=pe.uniform),je(e,c),n.needsLights=function(e){return e.isMeshLambertMaterial||e.isMeshToonMaterial||e.isMeshPhongMaterial||e.isMeshStandardMaterial||e.isShadowMaterial||e.isShaderMaterial&&!0===e.lights}(e),n.lightsStateVersion=l,n.needsLights&&(m.ambientLightColor.value=r.state.ambient,m.lightProbe.value=r.state.probe,m.directionalLights.value=r.state.directional,m.directionalLightShadows.value=r.state.directionalShadow,m.spotLights.value=r.state.spot,m.spotLightShadows.value=r.state.spotShadow,m.rectAreaLights.value=r.state.rectArea,m.ltc_1.value=r.state.rectAreaLTC1,m.ltc_2.value=r.state.rectAreaLTC2,m.pointLights.value=r.state.point,m.pointLightShadows.value=r.state.pointShadow,m.hemisphereLights.value=r.state.hemi,m.directionalShadowMap.value=r.state.directionalShadowMap,m.directionalShadowMatrix.value=r.state.directionalShadowMatrix,m.spotShadowMap.value=r.state.spotShadowMap,m.spotShadowMatrix.value=r.state.spotShadowMatrix,m.pointShadowMap.value=r.state.pointShadowMap,m.pointShadowMatrix.value=r.state.pointShadowMatrix);var v=f.getUniforms(),x=Br.seqWithValue(v.seq,m);return n.currentProgram=f,n.uniformsList=x,f}function je(e,t){var n=ne.get(e);n.outputEncoding=t.outputEncoding,n.instancing=t.instancing,n.numClippingPlanes=t.numClippingPlanes,n.numIntersection=t.numClipIntersection,n.vertexAlphas=t.vertexAlphas}function Ge(e,t,n,object){!0!==t.isScene&&(t=W),ie.resetTextureUnits();var r=t.fog,o=n.isMeshStandardMaterial?t.environment:null,l=null===T?w.outputEncoding:T.texture.encoding,c=re.get(n.envMap||o),h=!0===n.vertexColors&&object.geometry.attributes.color&&4===object.geometry.attributes.color.itemSize,d=ne.get(n),f=y.state.lights;if(!0===U&&(!0===j||e!==L)){var m=e===L&&n.id===C;pe.setState(n,e,m)}var v=!1;n.version===d.__version?d.needsLights&&d.lightsStateVersion!==f.state.version||d.outputEncoding!==l||object.isInstancedMesh&&!1===d.instancing?v=!0:object.isInstancedMesh||!0!==d.instancing?d.envMap!==c||n.fog&&d.fog!==r?v=!0:void 0===d.numClippingPlanes||d.numClippingPlanes===pe.numPlanes&&d.numIntersection===pe.numIntersection?d.vertexAlphas!==h&&(v=!0):v=!0:v=!0:(v=!0,d.__version=n.version);var x=d.currentProgram;!0===v&&(x=Ue(n,t,object));var _,M,S=!1,E=!1,A=!1,R=x.getUniforms(),k=d.uniforms;if(Q.useProgram(x.program)&&(S=!0,E=!0,A=!0),n.id!==C&&(C=n.id,E=!0),S||L!==e){if(R.setValue(_e,"projectionMatrix",e.projectionMatrix),K.logarithmicDepthBuffer&&R.setValue(_e,"logDepthBufFC",2/(Math.log(e.far+1)/Math.LN2)),L!==e&&(L=e,E=!0,A=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshStandardMaterial||n.envMap){var P=R.map.cameraPosition;void 0!==P&&P.setValue(_e,V.setFromMatrixPosition(e.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial)&&R.setValue(_e,"isOrthographic",!0===e.isOrthographicCamera),(n.isMeshPhongMaterial||n.isMeshToonMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.isShadowMaterial||n.skinning)&&R.setValue(_e,"viewMatrix",e.matrixWorldInverse)}if(n.skinning){R.setOptional(_e,object,"bindMatrix"),R.setOptional(_e,object,"bindMatrixInverse");var D=object.skeleton;if(D){var N=D.bones;if(K.floatVertexTextures){if(null===D.boneTexture){var H=Math.sqrt(4*N.length);H=Me.ceilPowerOfTwo(H),H=Math.max(H,4);var z=new Float32Array(H*H*4);z.set(D.boneMatrices);var F=new ui(z,H,H,ee,J);D.boneMatrices=z,D.boneTexture=F,D.boneTextureSize=H}R.setValue(_e,"boneTexture",D.boneTexture,ie),R.setValue(_e,"boneTextureSize",D.boneTextureSize)}else R.setOptional(_e,D,"boneMatrices")}}return(E||d.receiveShadow!==object.receiveShadow)&&(d.receiveShadow=object.receiveShadow,R.setValue(_e,"receiveShadow",object.receiveShadow)),E&&(R.setValue(_e,"toneMappingExposure",w.toneMappingExposure),d.needsLights&&(M=A,(_=k).ambientLightColor.needsUpdate=M,_.lightProbe.needsUpdate=M,_.directionalLights.needsUpdate=M,_.directionalLightShadows.needsUpdate=M,_.pointLights.needsUpdate=M,_.pointLightShadows.needsUpdate=M,_.spotLights.needsUpdate=M,_.spotLightShadows.needsUpdate=M,_.rectAreaLights.needsUpdate=M,_.hemisphereLights.needsUpdate=M),r&&n.fog&&ce.refreshFogUniforms(k,r),ce.refreshMaterialUniforms(k,n,I,O),Br.upload(_e,d.uniformsList,k,ie)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Br.upload(_e,d.uniformsList,k,ie),n.uniformsNeedUpdate=!1),n.isSpriteMaterial&&R.setValue(_e,"center",object.center),R.setValue(_e,"modelViewMatrix",object.modelViewMatrix),R.setValue(_e,"normalMatrix",object.normalMatrix),R.setValue(_e,"modelMatrix",object.matrixWorld),x}He.setAnimationLoop((function(time){Oe&&Oe(time)})),"undefined"!=typeof window&&He.setContext(window),this.setAnimationLoop=function(e){Oe=e,Le.setAnimationLoop(e),null===e?He.stop():He.start()},Le.addEventListener("sessionstart",De),Le.addEventListener("sessionend",Ne),this.render=function(e,t){var n,r;if(void 0!==arguments[2]&&(console.warn("THREE.WebGLRenderer.render(): the renderTarget argument has been removed. Use .setRenderTarget() instead."),n=arguments[2]),void 0!==arguments[3]&&(console.warn("THREE.WebGLRenderer.render(): the forceClear argument has been removed. Use .clear() instead."),r=arguments[3]),void 0===t||!0===t.isCamera){if(!0!==M){!0===e.autoUpdate&&e.updateMatrixWorld(),null===t.parent&&t.updateMatrixWorld(),!0===Le.enabled&&!0===Le.isPresenting&&(t=Le.getCamera(t)),!0===e.isScene&&e.onBeforeRender(w,e,t,n||T),(y=de.get(e,_.length)).init(),_.push(y),G.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),B.setFromProjectionMatrix(G),j=this.localClippingEnabled,U=pe.init(this.clippingPlanes,j,t),(v=ue.get(e,x.length)).init(),x.push(v),ze(e,t,0,w.sortObjects),v.finish(),!0===w.sortObjects&&v.sort(D,N),!0===U&&pe.beginShadows();var o=y.state.shadowsArray;fe.render(o,e,t),y.setupLights(),y.setupLightsView(t),!0===U&&pe.endShadows(),!0===this.info.autoReset&&this.info.reset(),void 0!==n&&this.setRenderTarget(n),me.render(v,e,t,r);var l=v.opaque,c=v.transparent;l.length>0&&Fe(l,e,t),c.length>0&&Fe(c,e,t),null!==T&&(ie.updateRenderTargetMipmap(T),ie.updateMultisampleRenderTarget(T)),!0===e.isScene&&e.onAfterRender(w,e,t),Q.buffers.depth.setTest(!0),Q.buffers.depth.setMask(!0),Q.buffers.color.setMask(!0),Q.setPolygonOffset(!1),be.resetDefaultState(),C=-1,L=null,_.pop(),y=_.length>0?_[_.length-1]:null,x.pop(),v=x.length>0?x[x.length-1]:null}}else console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.")},this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return E},this.getRenderTarget=function(){return T},this.setRenderTarget=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;T=e,S=t,E=n,e&&void 0===ne.get(e).__webglFramebuffer&&ie.setupRenderTarget(e);var r=null,o=!1,l=!1;if(e){var c=e.texture;(c.isDataTexture3D||c.isDataTexture2DArray)&&(l=!0);var h=ne.get(e).__webglFramebuffer;e.isWebGLCubeRenderTarget?(r=h[t],o=!0):r=e.isWebGLMultisampleRenderTarget?ne.get(e).__webglMultisampledFramebuffer:h,A.copy(e.viewport),R.copy(e.scissor),k=e.scissorTest}else A.copy(H).multiplyScalar(I).floor(),R.copy(z).multiplyScalar(I).floor(),k=F;if(Q.bindFramebuffer(36160,r),Q.viewport(A),Q.scissor(R),Q.setScissorTest(k),o){var d=ne.get(e.texture);_e.framebufferTexture2D(36160,36064,34069+t,d.__webglTexture,n)}else if(l){var f=ne.get(e.texture),m=t||0;_e.framebufferTextureLayer(36160,36064,f.__webglTexture,n||0,m)}},this.readRenderTargetPixels=function(e,t,n,r,o,l,c){if(e&&e.isWebGLRenderTarget){var h=ne.get(e).__webglFramebuffer;if(e.isWebGLCubeRenderTarget&&void 0!==c&&(h=h[c]),h){Q.bindFramebuffer(36160,h);try{var d=e.texture,f=d.format,m=d.type;if(f!==ee&&xe.convert(f)!==_e.getParameter(35739))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");var v=m===$&&(Z.has("EXT_color_buffer_half_float")||K.isWebGL2&&Z.has("EXT_color_buffer_float"));if(!(m===X||xe.convert(m)===_e.getParameter(35738)||m===J&&(K.isWebGL2||Z.has("OES_texture_float")||Z.has("WEBGL_color_buffer_float"))||v))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");36053===_e.checkFramebufferStatus(36160)?t>=0&&t<=e.width-r&&n>=0&&n<=e.height-o&&_e.readPixels(t,n,r,o,xe.convert(f),xe.convert(m),l):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{var y=null!==T?ne.get(T).__webglFramebuffer:null;Q.bindFramebuffer(36160,y)}}}else console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.")},this.copyFramebufferToTexture=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=Math.pow(2,-n),o=Math.floor(t.image.width*r),l=Math.floor(t.image.height*r),c=xe.convert(t.format);ie.setTexture2D(t,0),_e.copyTexImage2D(3553,n,c,e.x,e.y,o,l,0),Q.unbindTexture()},this.copyTextureToTexture=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=t.image.width,l=t.image.height,c=xe.convert(n.format),h=xe.convert(n.type);ie.setTexture2D(n,0),_e.pixelStorei(37440,n.flipY),_e.pixelStorei(37441,n.premultiplyAlpha),_e.pixelStorei(3317,n.unpackAlignment),t.isDataTexture?_e.texSubImage2D(3553,r,e.x,e.y,o,l,c,h,t.image.data):t.isCompressedTexture?_e.compressedTexSubImage2D(3553,r,e.x,e.y,t.mipmaps[0].width,t.mipmaps[0].height,c,t.mipmaps[0].data):_e.texSubImage2D(3553,r,e.x,e.y,c,h,t.image),0===r&&n.generateMipmaps&&_e.generateMipmap(3553),Q.unbindTexture()},this.copyTextureToTexture3D=function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;if(w.isWebGL1Renderer)console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");else{var l,c=n.image,h=c.width,d=c.height,data=c.data,f=xe.convert(r.format),m=xe.convert(r.type);if(r.isDataTexture3D)ie.setTexture3D(r,0),l=32879;else{if(!r.isDataTexture2DArray)return void console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");ie.setTexture2DArray(r,0),l=35866}_e.pixelStorei(37440,r.flipY),_e.pixelStorei(37441,r.premultiplyAlpha),_e.pixelStorei(3317,r.unpackAlignment);var v=_e.getParameter(3314),y=_e.getParameter(32878),x=_e.getParameter(3316),_=_e.getParameter(3315),M=_e.getParameter(32877);_e.pixelStorei(3314,h),_e.pixelStorei(32878,d),_e.pixelStorei(3316,e.min.x),_e.pixelStorei(3315,e.min.y),_e.pixelStorei(32877,e.min.z),_e.texSubImage3D(l,o,t.x,t.y,t.z,e.max.x-e.min.x+1,e.max.y-e.min.y+1,e.max.z-e.min.z+1,f,m,data),_e.pixelStorei(3314,v),_e.pixelStorei(32878,y),_e.pixelStorei(3316,x),_e.pixelStorei(3315,_),_e.pixelStorei(32877,M),0===o&&r.generateMipmaps&&_e.generateMipmap(l),Q.unbindTexture()}},this.initTexture=function(e){ie.setTexture2D(e,0),Q.unbindTexture()},this.resetState=function(){S=0,E=0,T=null,Q.reset(),be.reset()},"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}Ea.prototype.isGroup=!0,Object.assign(Ta.prototype,{constructor:Ta,getHandSpace:function(){return null===this._hand&&(this._hand=new Ea,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand},getTargetRaySpace:function(){return null===this._targetRay&&(this._targetRay=new Ea,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1),this._targetRay},getGripSpace:function(){return null===this._grip&&(this._grip=new Ea,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1),this._grip},dispatchEvent:function(e){return null!==this._targetRay&&this._targetRay.dispatchEvent(e),null!==this._grip&&this._grip.dispatchEvent(e),null!==this._hand&&this._hand.dispatchEvent(e),this},disconnect:function(e){return this.dispatchEvent({type:"disconnected",data:e}),null!==this._targetRay&&(this._targetRay.visible=!1),null!==this._grip&&(this._grip.visible=!1),null!==this._hand&&(this._hand.visible=!1),this},update:function(e,t,n){var r=null,o=null,l=null,c=this._targetRay,h=this._grip,d=this._hand;if(e&&"visible-blurred"!==t.session.visibilityState)if(null!==c&&null!==(r=t.getPose(e.targetRaySpace,n))&&(c.matrix.fromArray(r.transform.matrix),c.matrix.decompose(c.position,c.rotation,c.scale)),d&&e.hand){l=!0;var f,m=w(e.hand.values());try{for(m.s();!(f=m.n()).done;){var v=f.value,y=t.getJointPose(v,n);if(void 0===d.joints[v.jointName]){var x=new Ea;x.matrixAutoUpdate=!1,x.visible=!1,d.joints[v.jointName]=x,d.add(x)}var _=d.joints[v.jointName];null!==y&&(_.matrix.fromArray(y.transform.matrix),_.matrix.decompose(_.position,_.rotation,_.scale),_.jointRadius=y.radius),_.visible=null!==y}}catch(e){m.e(e)}finally{m.f()}var M=d.joints["index-finger-tip"],S=d.joints["thumb-tip"],E=M.position.distanceTo(S.position);d.inputState.pinching&&E>.025?(d.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:e.handedness,target:this})):!d.inputState.pinching&&E<=.015&&(d.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:e.handedness,target:this}))}else null!==h&&e.gripSpace&&null!==(o=t.getPose(e.gripSpace,n))&&(h.matrix.fromArray(o.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale));return null!==c&&(c.visible=null!==r),null!==h&&(h.visible=null!==o),null!==d&&(d.visible=null!==l),this}}),Object.assign(Ca.prototype,xe.prototype);var Ra=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n)}(Aa);Ra.prototype.isWebGL1Renderer=!0;var ka=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:25e-5;Object(x.a)(this,e),this.name="",this.color=new cn(t),this.density=n}return Object(_.a)(e,[{key:"clone",value:function(){return new e(this.color,this.density)}},{key:"toJSON",value:function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}]),e}();ka.prototype.isFogExp2=!0;var Pa=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;Object(x.a)(this,e),this.name="",this.color=new cn(t),this.near=n,this.far=r}return Object(_.a)(e,[{key:"clone",value:function(){return new e(this.color,this.near,this.far)}},{key:"toJSON",value:function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}]),e}();Pa.prototype.isFog=!0;var Oa=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e;return Object(x.a)(this,n),(e=t.call(this)).type="Scene",e.background=null,e.environment=null,e.fog=null,e.overrideMaterial=null,e.autoUpdate=!0,"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:Object(m.a)(e)})),e}return Object(_.a)(n,[{key:"copy",value:function(source,e){return d(Object(c.a)(n.prototype),"copy",this).call(this,source,e),null!==source.background&&(this.background=source.background.clone()),null!==source.environment&&(this.environment=source.environment.clone()),null!==source.fog&&(this.fog=source.fog.clone()),null!==source.overrideMaterial&&(this.overrideMaterial=source.overrideMaterial.clone()),this.autoUpdate=source.autoUpdate,this.matrixAutoUpdate=source.matrixAutoUpdate,this}},{key:"toJSON",value:function(meta){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this,meta);return null!==this.background&&(data.object.background=this.background.toJSON(meta)),null!==this.environment&&(data.object.environment=this.environment.toJSON(meta)),null!==this.fog&&(data.object.fog=this.fog.toJSON()),data}}]),n}(zt);function Ia(e,t){this.array=e,this.stride=t,this.count=void 0!==e?e.length/t:0,this.usage=ve,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Me.generateUUID()}Oa.prototype.isScene=!0,Object.defineProperty(Ia.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(Ia.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setUsage:function(e){return this.usage=e,this},copy:function(source){return this.array=new source.array.constructor(source.array),this.count=source.count,this.stride=source.stride,this.usage=source.usage,this},copyAt:function(e,t,n){e*=this.stride,n*=t.stride;for(var r=0,o=this.stride;r<o;r++)this.array[e+r]=t.array[n+r];return this},set:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.array.set(e,t),this},clone:function(data){void 0===data.arrayBuffers&&(data.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Me.generateUUID()),void 0===data.arrayBuffers[this.array.buffer._uuid]&&(data.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);var e=new Ia(new this.array.constructor(data.arrayBuffers[this.array.buffer._uuid]),this.stride);return e.setUsage(this.usage),e},onUpload:function(e){return this.onUploadCallback=e,this},toJSON:function(data){return void 0===data.arrayBuffers&&(data.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=Me.generateUUID()),void 0===data.arrayBuffers[this.array.buffer._uuid]&&(data.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}});var Da=new Ie;function Na(e,t,n,r){this.name="",this.data=e,this.itemSize=t,this.offset=n,this.normalized=!0===r}Object.defineProperties(Na.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}},needsUpdate:{set:function(e){this.data.needsUpdate=e}}}),Object.assign(Na.prototype,{isInterleavedBufferAttribute:!0,applyMatrix4:function(e){for(var t=0,n=this.data.count;t<n;t++)Da.x=this.getX(t),Da.y=this.getY(t),Da.z=this.getZ(t),Da.applyMatrix4(e),this.setXYZ(t,Da.x,Da.y,Da.z);return this},applyNormalMatrix:function(e){for(var t=0,n=this.count;t<n;t++)Da.x=this.getX(t),Da.y=this.getY(t),Da.z=this.getZ(t),Da.applyNormalMatrix(e),this.setXYZ(t,Da.x,Da.y,Da.z);return this},transformDirection:function(e){for(var t=0,n=this.count;t<n;t++)Da.x=this.getX(t),Da.y=this.getY(t),Da.z=this.getZ(t),Da.transformDirection(e),this.setXYZ(t,Da.x,Da.y,Da.z);return this},setX:function(e,t){return this.data.array[e*this.data.stride+this.offset]=t,this},setY:function(e,t){return this.data.array[e*this.data.stride+this.offset+1]=t,this},setZ:function(e,t){return this.data.array[e*this.data.stride+this.offset+2]=t,this},setW:function(e,t){return this.data.array[e*this.data.stride+this.offset+3]=t,this},getX:function(e){return this.data.array[e*this.data.stride+this.offset]},getY:function(e){return this.data.array[e*this.data.stride+this.offset+1]},getZ:function(e){return this.data.array[e*this.data.stride+this.offset+2]},getW:function(e){return this.data.array[e*this.data.stride+this.offset+3]},setXY:function(e,t,n){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this},setXYZ:function(e,t,n,r){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this},setXYZW:function(e,t,n,r,o){return e=e*this.data.stride+this.offset,this.data.array[e+0]=t,this.data.array[e+1]=n,this.data.array[e+2]=r,this.data.array[e+3]=o,this},clone:function(data){if(void 0===data){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");for(var e=[],t=0;t<this.count;t++)for(var n=t*this.data.stride+this.offset,r=0;r<this.itemSize;r++)e.push(this.data.array[n+r]);return new pn(new this.array.constructor(e),this.itemSize,this.normalized)}return void 0===data.interleavedBuffers&&(data.interleavedBuffers={}),void 0===data.interleavedBuffers[this.data.uuid]&&(data.interleavedBuffers[this.data.uuid]=this.data.clone(data)),new Na(data.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)},toJSON:function(data){if(void 0===data){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");for(var e=[],t=0;t<this.count;t++)for(var n=t*this.data.stride+this.offset,r=0;r<this.itemSize;r++)e.push(this.data.array[n+r]);return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}return void 0===data.interleavedBuffers&&(data.interleavedBuffers={}),void 0===data.interleavedBuffers[this.data.uuid]&&(data.interleavedBuffers[this.data.uuid]=this.data.toJSON(data)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}});var Ha,za=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="SpriteMaterial",r.color=new cn(16777215),r.map=null,r.alphaMap=null,r.rotation=0,r.sizeAttenuation=!0,r.transparent=!0,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.map=source.map,this.alphaMap=source.alphaMap,this.rotation=source.rotation,this.sizeAttenuation=source.sizeAttenuation,this}}]),n}(tn);za.prototype.isSpriteMaterial=!0;var Fa=new Ie,Ba=new Ie,Ua=new Ie,ja=new Se,Ga=new Se,Va=new pt,Wa=new Ie,qa=new Ie,Xa=new Ie,Ya=new Se,Za=new Se,Ja=new Se,$a=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;if(Object(x.a)(this,n),(r=t.call(this)).type="Sprite",void 0===Ha){Ha=new Pn;var o=new Ia(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);Ha.setIndex([0,1,2,0,2,3]),Ha.setAttribute("position",new Na(o,3,0,!1)),Ha.setAttribute("uv",new Na(o,2,3,!1))}return r.geometry=Ha,r.material=void 0!==e?e:new za,r.center=new Se(.5,.5),r}return Object(_.a)(n,[{key:"raycast",value:function(e,t){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),Ba.setFromMatrixScale(this.matrixWorld),Va.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),Ua.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&Ba.multiplyScalar(-Ua.z);var n,r,o=this.material.rotation;0!==o&&(r=Math.cos(o),n=Math.sin(o));var l=this.center;Ka(Wa.set(-.5,-.5,0),Ua,l,Ba,n,r),Ka(qa.set(.5,-.5,0),Ua,l,Ba,n,r),Ka(Xa.set(.5,.5,0),Ua,l,Ba,n,r),Ya.set(0,0),Za.set(1,0),Ja.set(1,1);var c=e.ray.intersectTriangle(Wa,qa,Xa,!1,Fa);if(null!==c||(Ka(qa.set(-.5,.5,0),Ua,l,Ba,n,r),Za.set(0,1),null!==(c=e.ray.intersectTriangle(Wa,Xa,qa,!1,Fa)))){var h=e.ray.origin.distanceTo(Fa);h<e.near||h>e.far||t.push({distance:h,point:Fa.clone(),uv:Qt.getUV(Fa,Wa,qa,Xa,Ya,Za,Ja,new Se),face:null,object:this})}}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),void 0!==source.center&&this.center.copy(source.center),this.material=source.material,this}}]),n}(zt);function Ka(e,t,n,r,o,l){ja.subVectors(e,n).addScalar(.5).multiply(r),void 0!==o?(Ga.x=l*ja.x-o*ja.y,Ga.y=o*ja.x+l*ja.y):Ga.copy(ja),e.copy(t),e.x+=Ga.x,e.y+=Ga.y,e.applyMatrix4(Va)}$a.prototype.isSprite=!0;var Qa=new Ie,eo=new ke,to=new ke,no=new Ie,io=new pt;function ro(e,t){Jn.call(this,e,t),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new pt,this.bindMatrixInverse=new pt}function ao(){zt.call(this),this.type="Bone"}ro.prototype=Object.assign(Object.create(Jn.prototype),{constructor:ro,isSkinnedMesh:!0,copy:function(source){return Jn.prototype.copy.call(this,source),this.bindMode=source.bindMode,this.bindMatrix.copy(source.bindMatrix),this.bindMatrixInverse.copy(source.bindMatrixInverse),this.skeleton=source.skeleton,this},bind:function(e,t){this.skeleton=e,void 0===t&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),t=this.matrixWorld),this.bindMatrix.copy(t),this.bindMatrixInverse.copy(t).invert()},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){for(var e=new ke,t=this.geometry.attributes.skinWeight,n=0,r=t.count;n<r;n++){e.x=t.getX(n),e.y=t.getY(n),e.z=t.getZ(n),e.w=t.getW(n);var o=1/e.manhattanLength();o!==1/0?e.multiplyScalar(o):e.set(1,0,0,0),t.setXYZW(n,e.x,e.y,e.z,e.w)}},updateMatrixWorld:function(e){Jn.prototype.updateMatrixWorld.call(this,e),"attached"===this.bindMode?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},boneTransform:function(e,t){var n=this.skeleton,r=this.geometry;eo.fromBufferAttribute(r.attributes.skinIndex,e),to.fromBufferAttribute(r.attributes.skinWeight,e),Qa.fromBufferAttribute(r.attributes.position,e).applyMatrix4(this.bindMatrix),t.set(0,0,0);for(var o=0;o<4;o++){var l=to.getComponent(o);if(0!==l){var c=eo.getComponent(o);io.multiplyMatrices(n.bones[c].matrixWorld,n.boneInverses[c]),t.addScaledVector(no.copy(Qa).applyMatrix4(io),l)}}return t.applyMatrix4(this.bindMatrixInverse)}}),ao.prototype=Object.assign(Object.create(zt.prototype),{constructor:ao,isBone:!0});var oo=new pt,so=new pt,lo=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object(x.a)(this,e),this.uuid=Me.generateUUID(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}return Object(_.a)(e,[{key:"init",value:function(){var e=this.bones,t=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===t.length)this.calculateInverses();else if(e.length!==t.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new pt)}}},{key:"calculateInverses",value:function(){this.boneInverses.length=0;for(var e=0,t=this.bones.length;e<t;e++){var n=new pt;this.bones[e]&&n.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(n)}}},{key:"pose",value:function(){for(var e=0,t=this.bones.length;e<t;e++){var n=this.bones[e];n&&n.matrixWorld.copy(this.boneInverses[e]).invert()}for(var r=0,o=this.bones.length;r<o;r++){var l=this.bones[r];l&&(l.parent&&l.parent.isBone?(l.matrix.copy(l.parent.matrixWorld).invert(),l.matrix.multiply(l.matrixWorld)):l.matrix.copy(l.matrixWorld),l.matrix.decompose(l.position,l.quaternion,l.scale))}}},{key:"update",value:function(){for(var e=this.bones,t=this.boneInverses,n=this.boneMatrices,r=this.boneTexture,o=0,l=e.length;o<l;o++){var c=e[o]?e[o].matrixWorld:so;oo.multiplyMatrices(c,t[o]),oo.toArray(n,16*o)}null!==r&&(r.needsUpdate=!0)}},{key:"clone",value:function(){return new e(this.bones,this.boneInverses)}},{key:"getBoneByName",value:function(e){for(var t=0,n=this.bones.length;t<n;t++){var r=this.bones[t];if(r.name===e)return r}}},{key:"dispose",value:function(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}},{key:"fromJSON",value:function(e,t){this.uuid=e.uuid;for(var n=0,r=e.bones.length;n<r;n++){var o=e.bones[n],l=t[o];void 0===l&&(console.warn("THREE.Skeleton: No bone found with UUID:",o),l=new ao),this.bones.push(l),this.boneInverses.push((new pt).fromArray(e.boneInverses[n]))}return this.init(),this}},{key:"toJSON",value:function(){var data={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};data.uuid=this.uuid;for(var e=this.bones,t=this.boneInverses,n=0,r=e.length;n<r;n++){var o=e[n];data.bones.push(o.uuid);var l=t[n];data.boneInverses.push(l.toArray())}return data}}]),e}(),co=new pt,uo=new pt,ho=[],po=new Jn;function fo(e,t,n){Jn.call(this,e,t),this.instanceMatrix=new pn(new Float32Array(16*n),16),this.instanceColor=null,this.count=n,this.frustumCulled=!1}fo.prototype=Object.assign(Object.create(Jn.prototype),{constructor:fo,isInstancedMesh:!0,copy:function(source){return Jn.prototype.copy.call(this,source),this.instanceMatrix.copy(source.instanceMatrix),null!==source.instanceColor&&(this.instanceColor=source.instanceColor.clone()),this.count=source.count,this},getColorAt:function(e,t){t.fromArray(this.instanceColor.array,3*e)},getMatrixAt:function(e,t){t.fromArray(this.instanceMatrix.array,16*e)},raycast:function(e,t){var n=this.matrixWorld,r=this.count;if(po.geometry=this.geometry,po.material=this.material,void 0!==po.material)for(var o=0;o<r;o++){this.getMatrixAt(o,co),uo.multiplyMatrices(n,co),po.matrixWorld=uo,po.raycast(e,ho);for(var l=0,c=ho.length;l<c;l++){var h=ho[l];h.instanceId=o,h.object=this,t.push(h)}ho.length=0}},setColorAt:function(e,t){null===this.instanceColor&&(this.instanceColor=new pn(new Float32Array(3*this.count),3)),t.toArray(this.instanceColor.array,3*e)},setMatrixAt:function(e,t){t.toArray(this.instanceMatrix.array,16*e)},updateMorphTargets:function(){},dispose:function(){this.dispatchEvent({type:"dispose"})}});var mo=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="LineBasicMaterial",r.color=new cn(16777215),r.linewidth=1,r.linecap="round",r.linejoin="round",r.morphTargets=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.linewidth=source.linewidth,this.linecap=source.linecap,this.linejoin=source.linejoin,this.morphTargets=source.morphTargets,this}}]),n}(tn);mo.prototype.isLineBasicMaterial=!0;var vo=new Ie,go=new Ie,yo=new pt,xo=new ht,bo=new nt;function _o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new mo;zt.call(this),this.type="Line",this.geometry=e,this.material=t,this.updateMorphTargets()}_o.prototype=Object.assign(Object.create(zt.prototype),{constructor:_o,isLine:!0,copy:function(source){return zt.prototype.copy.call(this,source),this.material=source.material,this.geometry=source.geometry,this},computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[0],r=1,o=t.count;r<o;r++)vo.fromBufferAttribute(t,r-1),go.fromBufferAttribute(t,r),n[r]=n[r-1],n[r]+=vo.distanceTo(go);e.setAttribute("lineDistance",new wn(n,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,o=e.params.Line.threshold,l=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),bo.copy(n.boundingSphere),bo.applyMatrix4(r),bo.radius+=o,!1!==e.ray.intersectsSphere(bo)){yo.copy(r).invert(),xo.copy(e.ray).applyMatrix4(yo);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c,d=new Ie,f=new Ie,m=new Ie,v=new Ie,y=this.isLineSegments?2:1;if(n.isBufferGeometry){var x=n.index,_=n.attributes.position;if(null!==x)for(var w=Math.max(0,l.start),M=Math.min(x.count,l.start+l.count)-1;w<M;w+=y){var a=x.getX(w),b=x.getX(w+1);if(d.fromBufferAttribute(_,a),f.fromBufferAttribute(_,b),!(xo.distanceSqToSegment(d,f,v,m)>h)){v.applyMatrix4(this.matrixWorld);var S=e.ray.origin.distanceTo(v);S<e.near||S>e.far||t.push({distance:S,point:m.clone().applyMatrix4(this.matrixWorld),index:w,face:null,faceIndex:null,object:this})}}else for(var E=Math.max(0,l.start),T=Math.min(_.count,l.start+l.count)-1;E<T;E+=y){if(d.fromBufferAttribute(_,E),f.fromBufferAttribute(_,E+1),!(xo.distanceSqToSegment(d,f,v,m)>h)){v.applyMatrix4(this.matrixWorld);var C=e.ray.origin.distanceTo(v);C<e.near||C>e.far||t.push({distance:C,point:m.clone().applyMatrix4(this.matrixWorld),index:E,face:null,faceIndex:null,object:this})}}}else n.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,l=r.length;o<l;o++){var c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}else{var h=e.morphTargets;void 0!==h&&h.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}});var wo=new Ie,Mo=new Ie;function So(e,t){_o.call(this,e,t),this.type="LineSegments"}So.prototype=Object.assign(Object.create(_o.prototype),{constructor:So,isLineSegments:!0,computeLineDistances:function(){var e=this.geometry;if(e.isBufferGeometry)if(null===e.index){for(var t=e.attributes.position,n=[],r=0,o=t.count;r<o;r+=2)wo.fromBufferAttribute(t,r),Mo.fromBufferAttribute(t,r+1),n[r]=0===r?0:n[r-1],n[r+1]=n[r]+wo.distanceTo(Mo);e.setAttribute("lineDistance",new wn(n,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else e.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}});var Eo=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o;return Object(x.a)(this,n),(o=t.call(this,e,r)).type="LineLoop",o}return Object(_.a)(n)}(_o);Eo.prototype.isLineLoop=!0;var To=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="PointsMaterial",r.color=new cn(16777215),r.map=null,r.alphaMap=null,r.size=1,r.sizeAttenuation=!0,r.morphTargets=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.map=source.map,this.alphaMap=source.alphaMap,this.size=source.size,this.sizeAttenuation=source.sizeAttenuation,this.morphTargets=source.morphTargets,this}}]),n}(tn);To.prototype.isPointsMaterial=!0;var Co=new pt,Lo=new ht,Ao=new nt,Ro=new Ie;function ko(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Pn,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new To;zt.call(this),this.type="Points",this.geometry=e,this.material=t,this.updateMorphTargets()}function Po(e,t,n,r,o,l,object){var c=Lo.distanceSqToPoint(e);if(c<n){var h=new Ie;Lo.closestPointToPoint(e,h),h.applyMatrix4(r);var d=o.ray.origin.distanceTo(h);if(d<o.near||d>o.far)return;l.push({distance:d,distanceToRay:Math.sqrt(c),point:h,index:t,face:null,object:object})}}ko.prototype=Object.assign(Object.create(zt.prototype),{constructor:ko,isPoints:!0,copy:function(source){return zt.prototype.copy.call(this,source),this.material=source.material,this.geometry=source.geometry,this},raycast:function(e,t){var n=this.geometry,r=this.matrixWorld,o=e.params.Points.threshold,l=n.drawRange;if(null===n.boundingSphere&&n.computeBoundingSphere(),Ao.copy(n.boundingSphere),Ao.applyMatrix4(r),Ao.radius+=o,!1!==e.ray.intersectsSphere(Ao)){Co.copy(r).invert(),Lo.copy(e.ray).applyMatrix4(Co);var c=o/((this.scale.x+this.scale.y+this.scale.z)/3),h=c*c;if(n.isBufferGeometry){var d=n.index,f=n.attributes.position;if(null!==d)for(var m=Math.max(0,l.start),v=Math.min(d.count,l.start+l.count);m<v;m++){var a=d.getX(m);Ro.fromBufferAttribute(f,a),Po(Ro,a,h,r,e,t,this)}else for(var y=Math.max(0,l.start),x=Math.min(f.count,l.start+l.count);y<x;y++)Ro.fromBufferAttribute(f,y),Po(Ro,y,h,r,e,t,this)}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}},updateMorphTargets:function(){var e=this.geometry;if(e.isBufferGeometry){var t=e.morphAttributes,n=Object.keys(t);if(n.length>0){var r=t[n[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(var o=0,l=r.length;o<l;o++){var c=r[o].name||String(o);this.morphTargetInfluences.push(0),this.morphTargetDictionary[c]=o}}}}else{var h=e.morphTargets;void 0!==h&&h.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}),function(e){Object(v.a)(n,e);var t=S(n);function n(video,e,r,o,l,c,h,d,f){var v;Object(x.a)(this,n),(v=t.call(this,video,e,r,o,l,c,h,d,f)).format=void 0!==h?h:Q,v.minFilter=void 0!==c?c:G,v.magFilter=void 0!==l?l:G,v.generateMipmaps=!1;var y=Object(m.a)(v);return"requestVideoFrameCallback"in video&&video.requestVideoFrameCallback((function e(){y.needsUpdate=!0,video.requestVideoFrameCallback(e)})),v}return Object(_.a)(n,[{key:"clone",value:function(){return new this.constructor(this.image).copy(this)}},{key:"update",value:function(){var video=this.image;!1==="requestVideoFrameCallback"in video&&video.readyState>=video.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}]),n}(Ae).prototype.isVideoTexture=!0;var Oo=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o,l,c,h,d,f,m,v,y,_){var w;return Object(x.a)(this,n),(w=t.call(this,null,h,d,f,m,v,l,c,y,_)).image={width:r,height:o},w.mipmaps=e,w.flipY=!1,w.generateMipmaps=!1,w}return Object(_.a)(n)}(Ae);Oo.prototype.isCompressedTexture=!0;var Io=function(e){Object(v.a)(n,e);var t=S(n);function n(canvas,e,r,o,l,c,h,d,f){var m;return Object(x.a)(this,n),(m=t.call(this,canvas,e,r,o,l,c,h,d,f)).needsUpdate=!0,m}return Object(_.a)(n)}(Ae);Io.prototype.isCanvasTexture=!0,function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o,l,c,h,d,f,m,v){var y;if(Object(x.a)(this,n),(v=void 0!==v?v:te)!==te&&v!==ne)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");return void 0===o&&v===te&&(o=Y),void 0===o&&v===ne&&(o=K),(y=t.call(this,null,l,c,h,d,f,v,o,m)).image={width:e,height:r},y.magFilter=void 0!==d?d:B,y.minFilter=void 0!==f?f:B,y.flipY=!1,y.generateMipmaps=!1,y}return Object(_.a)(n)}(Ae).prototype.isDepthTexture=!0;new Ie,new Ie,new Ie,new Qt;var Do=function(data,e,t){t=t||2;var n,r,o,l,c,h,d,f=e&&e.length,m=f?e[0]*t:data.length,v=No(data,0,m,t,!0),y=[];if(!v||v.next===v.prev)return y;if(f&&(v=function(data,e,t,n){var i,r,o,l=[];for(i=0,r=e.length;i<r;i++)(o=No(data,e[i]*n,i<r-1?e[i+1]*n:data.length,n,!1))===o.next&&(o.steiner=!0),l.push(Xo(o));for(l.sort(Go),i=0;i<l.length;i++)Vo(l[i],t),t=Ho(t,t.next);return t}(data,e,v,t)),data.length>80*t){n=o=data[0],r=l=data[1];for(var x=t;x<m;x+=t)(c=data[x])<n&&(n=c),(h=data[x+1])<r&&(r=h),c>o&&(o=c),h>l&&(l=h);d=0!==(d=Math.max(o-n,l-r))?1/d:0}return zo(v,y,t,n,r,d),y};function No(data,e,t,n,r){var i,o;if(r===function(data,e,t,n){for(var r=0,o=e,l=t-n;o<t;o+=n)r+=(data[l]-data[o])*(data[o+1]+data[l+1]),l=o;return r}(data,e,t,n)>0)for(i=e;i<t;i+=n)o=is(i,data[i],data[i+1],o);else for(i=t-n;i>=e;i-=n)o=is(i,data[i],data[i+1],o);return o&&$o(o,o.next)&&(rs(o),o=o.next),o}function Ho(e,t){if(!e)return e;t||(t=e);var n,p=e;do{if(n=!1,p.steiner||!$o(p,p.next)&&0!==Jo(p.prev,p,p.next))p=p.next;else{if(rs(p),(p=t=p.prev)===p.next)break;n=!0}}while(n||p!==t);return t}function zo(e,t,n,r,o,l,c){if(e){!c&&l&&function(e,t,n,r){var p=e;do{null===p.z&&(p.z=qo(p.x,p.y,t,n,r)),p.prevZ=p.prev,p.nextZ=p.next,p=p.next}while(p!==e);p.prevZ.nextZ=null,p.prevZ=null,function(e){var i,p,q,t,n,r,o,l,c=1;do{for(p=e,e=null,n=null,r=0;p;){for(r++,q=p,o=0,i=0;i<c&&(o++,q=q.nextZ);i++);for(l=c;o>0||l>0&&q;)0!==o&&(0===l||!q||p.z<=q.z)?(t=p,p=p.nextZ,o--):(t=q,q=q.nextZ,l--),n?n.nextZ=t:e=t,t.prevZ=n,n=t;p=q}n.nextZ=null,c*=2}while(r>1)}(p)}(e,r,o,l);for(var h,d,f=e;e.prev!==e.next;)if(h=e.prev,d=e.next,l?Bo(e,r,o,l):Fo(e))t.push(h.i/n),t.push(e.i/n),t.push(d.i/n),rs(e),e=d.next,f=d.next;else if((e=d)===f){c?1===c?zo(e=Uo(Ho(e),t,n),t,n,r,o,l,2):2===c&&jo(e,t,n,r,o,l):zo(Ho(e),t,n,r,o,l,1);break}}}function Fo(e){var a=e.prev,b=e,t=e.next;if(Jo(a,b,t)>=0)return!1;for(var p=e.next.next;p!==e.prev;){if(Yo(a.x,a.y,b.x,b.y,t.x,t.y,p.x,p.y)&&Jo(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function Bo(e,t,n,r){var a=e.prev,b=e,o=e.next;if(Jo(a,b,o)>=0)return!1;for(var l=a.x<b.x?a.x<o.x?a.x:o.x:b.x<o.x?b.x:o.x,c=a.y<b.y?a.y<o.y?a.y:o.y:b.y<o.y?b.y:o.y,h=a.x>b.x?a.x>o.x?a.x:o.x:b.x>o.x?b.x:o.x,d=a.y>b.y?a.y>o.y?a.y:o.y:b.y>o.y?b.y:o.y,f=qo(l,c,t,n,r),m=qo(h,d,t,n,r),p=e.prevZ,v=e.nextZ;p&&p.z>=f&&v&&v.z<=m;){if(p!==e.prev&&p!==e.next&&Yo(a.x,a.y,b.x,b.y,o.x,o.y,p.x,p.y)&&Jo(p.prev,p,p.next)>=0)return!1;if(p=p.prevZ,v!==e.prev&&v!==e.next&&Yo(a.x,a.y,b.x,b.y,o.x,o.y,v.x,v.y)&&Jo(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;p&&p.z>=f;){if(p!==e.prev&&p!==e.next&&Yo(a.x,a.y,b.x,b.y,o.x,o.y,p.x,p.y)&&Jo(p.prev,p,p.next)>=0)return!1;p=p.prevZ}for(;v&&v.z<=m;){if(v!==e.prev&&v!==e.next&&Yo(a.x,a.y,b.x,b.y,o.x,o.y,v.x,v.y)&&Jo(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function Uo(e,t,n){var p=e;do{var a=p.prev,b=p.next.next;!$o(a,b)&&Ko(a,p,p.next,b)&&ts(a,b)&&ts(b,a)&&(t.push(a.i/n),t.push(p.i/n),t.push(b.i/n),rs(p),rs(p.next),p=e=b),p=p.next}while(p!==e);return Ho(p)}function jo(e,t,n,r,o,l){var a=e;do{for(var b=a.next.next;b!==a.prev;){if(a.i!==b.i&&Zo(a,b)){var c=ns(a,b);return a=Ho(a,a.next),c=Ho(c,c.next),zo(a,t,n,r,o,l),void zo(c,t,n,r,o,l)}b=b.next}a=a.next}while(a!==e)}function Go(a,b){return a.x-b.x}function Vo(e,t){if(t=function(e,t){var n,p=t,r=e.x,o=e.y,l=-1/0;do{if(o<=p.y&&o>=p.next.y&&p.next.y!==p.y){var c=p.x+(o-p.y)*(p.next.x-p.x)/(p.next.y-p.y);if(c<=r&&c>l){if(l=c,c===r){if(o===p.y)return p;if(o===p.next.y)return p.next}n=p.x<p.next.x?p:p.next}}p=p.next}while(p!==t);if(!n)return null;if(r===l)return n;var h,d=n,f=n.x,m=n.y,v=1/0;p=n;do{r>=p.x&&p.x>=f&&r!==p.x&&Yo(o<m?r:l,o,f,m,o<m?l:r,o,p.x,p.y)&&(h=Math.abs(o-p.y)/(r-p.x),ts(p,e)&&(h<v||h===v&&(p.x>n.x||p.x===n.x&&Wo(n,p)))&&(n=p,v=h)),p=p.next}while(p!==d);return n}(e,t),t){var b=ns(t,e);Ho(t,t.next),Ho(b,b.next)}}function Wo(e,p){return Jo(e.prev,e,p.prev)<0&&Jo(p.next,e,e.next)<0}function qo(e,t,n,r,o){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*o)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-r)*o)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Xo(e){var p=e,t=e;do{(p.x<t.x||p.x===t.x&&p.y<t.y)&&(t=p),p=p.next}while(p!==e);return t}function Yo(e,t,n,r,o,l,c,h){return(o-c)*(t-h)-(e-c)*(l-h)>=0&&(e-c)*(r-h)-(n-c)*(t-h)>=0&&(n-c)*(l-h)-(o-c)*(r-h)>=0}function Zo(a,b){return a.next.i!==b.i&&a.prev.i!==b.i&&!function(a,b){var p=a;do{if(p.i!==a.i&&p.next.i!==a.i&&p.i!==b.i&&p.next.i!==b.i&&Ko(p,p.next,a,b))return!0;p=p.next}while(p!==a);return!1}(a,b)&&(ts(a,b)&&ts(b,a)&&function(a,b){var p=a,e=!1,t=(a.x+b.x)/2,n=(a.y+b.y)/2;do{p.y>n!=p.next.y>n&&p.next.y!==p.y&&t<(p.next.x-p.x)*(n-p.y)/(p.next.y-p.y)+p.x&&(e=!e),p=p.next}while(p!==a);return e}(a,b)&&(Jo(a.prev,a,b.prev)||Jo(a,b.prev,b))||$o(a,b)&&Jo(a.prev,a,a.next)>0&&Jo(b.prev,b,b.next)>0)}function Jo(p,q,e){return(q.y-p.y)*(e.x-q.x)-(q.x-p.x)*(e.y-q.y)}function $o(e,t){return e.x===t.x&&e.y===t.y}function Ko(e,t,n,r){var o=es(Jo(e,t,n)),l=es(Jo(e,t,r)),c=es(Jo(n,r,e)),h=es(Jo(n,r,t));return o!==l&&c!==h||(!(0!==o||!Qo(e,n,t))||(!(0!==l||!Qo(e,r,t))||(!(0!==c||!Qo(n,e,r))||!(0!==h||!Qo(n,t,r)))))}function Qo(p,q,e){return q.x<=Math.max(p.x,e.x)&&q.x>=Math.min(p.x,e.x)&&q.y<=Math.max(p.y,e.y)&&q.y>=Math.min(p.y,e.y)}function es(e){return e>0?1:e<0?-1:0}function ts(a,b){return Jo(a.prev,a,a.next)<0?Jo(a,b,a.next)>=0&&Jo(a,a.prev,b)>=0:Jo(a,b,a.prev)<0||Jo(a,a.next,b)<0}function ns(a,b){var e=new as(a.i,a.x,a.y),t=new as(b.i,b.x,b.y),n=a.next,r=b.prev;return a.next=b,b.prev=a,e.next=n,n.prev=e,t.next=e,e.prev=t,r.next=t,t.prev=r,t}function is(i,e,t,n){var p=new as(i,e,t);return n?(p.next=n.next,p.prev=n,n.next.prev=p,n.next=p):(p.prev=p,p.next=p),p}function rs(p){p.next.prev=p.prev,p.prev.next=p.next,p.prevZ&&(p.prevZ.nextZ=p.nextZ),p.nextZ&&(p.nextZ.prevZ=p.prevZ)}function as(i,e,t){this.i=i,this.x=e,this.y=t,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}var os={area:function(e){for(var t=e.length,a=0,p=t-1,q=0;q<t;p=q++)a+=e[p].x*e[q].y-e[q].x*e[p].y;return.5*a},isClockWise:function(e){return os.area(e)<0},triangulateShape:function(e,t){var n=[],r=[],o=[];ss(e),ls(n,e);var l=e.length;t.forEach(ss);for(var c=0;c<t.length;c++)r.push(l),l+=t[c].length,ls(n,t[c]);for(var h=Do(n,r),d=0;d<h.length;d+=3)o.push(h.slice(d,d+3));return o}};function ss(e){var t=e.length;t>2&&e[t-1].equals(e[0])&&e.pop()}function ls(e,t){for(var n=0;n<t.length;n++)e.push(t[n].x),e.push(t[n].y)}var cs=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o;Object(x.a)(this,n),(o=t.call(this)).type="ExtrudeGeometry",o.parameters={shapes:e,options:r},e=Array.isArray(e)?e:[e];for(var l=Object(m.a)(o),c=[],h=[],d=0,f=e.length;d<f;d++){v(e[d])}function v(e){var t=[],n=void 0!==r.curveSegments?r.curveSegments:12,o=void 0!==r.steps?r.steps:1,d=void 0!==r.depth?r.depth:100,f=void 0===r.bevelEnabled||r.bevelEnabled,m=void 0!==r.bevelThickness?r.bevelThickness:6,v=void 0!==r.bevelSize?r.bevelSize:m-2,y=void 0!==r.bevelOffset?r.bevelOffset:0,x=void 0!==r.bevelSegments?r.bevelSegments:3,_=r.extrudePath,w=void 0!==r.UVGenerator?r.UVGenerator:us;void 0!==r.amount&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),d=r.amount);var M,S,E,T,C,L=!1;_&&(M=_.getSpacedPoints(o),L=!0,f=!1,S=_.computeFrenetFrames(o,!1),E=new Ie,T=new Ie,C=new Ie),f||(x=0,m=0,v=0,y=0);var A=e.extractPoints(n),R=A.shape,k=A.holes;if(!os.isClockWise(R)){R=R.reverse();for(var P=0,O=k.length;P<O;P++){var I=k[P];os.isClockWise(I)&&(k[P]=I.reverse())}}for(var D=os.triangulateShape(R,k),N=R,H=0,z=k.length;H<z;H++){var F=k[H];R=R.concat(F)}function B(e,t,n){return t||console.error("THREE.ExtrudeGeometry: vec does not exist"),t.clone().multiplyScalar(n).add(e)}var U=R.length,j=D.length;function G(e,t,n){var r,o,l,c=e.x-t.x,h=e.y-t.y,d=n.x-e.x,f=n.y-e.y,m=c*c+h*h,v=c*f-h*d;if(Math.abs(v)>Number.EPSILON){var y=Math.sqrt(m),x=Math.sqrt(d*d+f*f),_=t.x-h/y,w=t.y+c/y,M=((n.x-f/x-_)*f-(n.y+d/x-w)*d)/(c*f-h*d),S=(r=_+c*M-e.x)*r+(o=w+h*M-e.y)*o;if(S<=2)return new Se(r,o);l=Math.sqrt(S/2)}else{var E=!1;c>Number.EPSILON?d>Number.EPSILON&&(E=!0):c<-Number.EPSILON?d<-Number.EPSILON&&(E=!0):Math.sign(h)===Math.sign(f)&&(E=!0),E?(r=-h,o=c,l=Math.sqrt(m)):(r=c,o=h,l=Math.sqrt(m/2))}return new Se(r/l,o/l)}for(var V=[],W=0,X=N.length,Y=X-1,Z=W+1;W<X;W++,Y++,Z++)Y===X&&(Y=0),Z===X&&(Z=0),V[W]=G(N[W],N[Y],N[Z]);for(var J,$=[],K=V.concat(),Q=0,ee=k.length;Q<ee;Q++){var te=k[Q];J=[];for(var ne=0,ie=te.length,re=ie-1,ae=ne+1;ne<ie;ne++,re++,ae++)re===ie&&(re=0),ae===ie&&(ae=0),J[ne]=G(te[ne],te[re],te[ae]);$.push(J),K=K.concat(J)}for(var b=0;b<x;b++){for(var oe=b/x,se=m*Math.cos(oe*Math.PI/2),le=v*Math.sin(oe*Math.PI/2)+y,ce=0,ue=N.length;ce<ue;ce++){var he=B(N[ce],V[ce],le);Fe(he.x,he.y,-se)}for(var de=0,pe=k.length;de<pe;de++){var fe=k[de];J=$[de];for(var me=0,ve=fe.length;me<ve;me++){var ge=B(fe[me],J[me],le);Fe(ge.x,ge.y,-se)}}}for(var ye=v+y,xe=0;xe<U;xe++){var be=f?B(R[xe],K[xe],ye):R[xe];L?(T.copy(S.normals[0]).multiplyScalar(be.x),E.copy(S.binormals[0]).multiplyScalar(be.y),C.copy(M[0]).add(T).add(E),Fe(C.x,C.y,C.z)):Fe(be.x,be.y,0)}for(var s=1;s<=o;s++)for(var _e=0;_e<U;_e++){var we=f?B(R[_e],K[_e],ye):R[_e];L?(T.copy(S.normals[s]).multiplyScalar(we.x),E.copy(S.binormals[s]).multiplyScalar(we.y),C.copy(M[s]).add(T).add(E),Fe(C.x,C.y,C.z)):Fe(we.x,we.y,d/o*s)}for(var Me=x-1;Me>=0;Me--){for(var Ee=Me/x,Te=m*Math.cos(Ee*Math.PI/2),Ce=v*Math.sin(Ee*Math.PI/2)+y,Le=0,Ae=N.length;Le<Ae;Le++){var Re=B(N[Le],V[Le],Ce);Fe(Re.x,Re.y,d+Te)}for(var ke=0,Pe=k.length;ke<Pe;ke++){var Oe=k[ke];J=$[ke];for(var De=0,Ne=Oe.length;De<Ne;De++){var He=B(Oe[De],J[De],Ce);L?Fe(He.x,He.y+M[o-1].y,M[o-1].x+Te):Fe(He.x,He.y,d+Te)}}}function ze(e,t){for(var i=e.length;--i>=0;){var n=i,r=i-1;r<0&&(r=e.length-1);for(var l=0,c=o+2*x;l<c;l++){var h=U*l,d=U*(l+1);Ue(t+n+h,t+r+h,t+r+d,t+n+d)}}}function Fe(e,n,r){t.push(e),t.push(n),t.push(r)}function Be(a,b,e){je(a),je(b),je(e);var t=c.length/3,n=w.generateTopUV(l,c,t-3,t-2,t-1);Ge(n[0]),Ge(n[1]),Ge(n[2])}function Ue(a,b,e,t){je(a),je(b),je(t),je(b),je(e),je(t);var n=c.length/3,r=w.generateSideWallUV(l,c,n-6,n-3,n-2,n-1);Ge(r[0]),Ge(r[1]),Ge(r[3]),Ge(r[1]),Ge(r[2]),Ge(r[3])}function je(e){c.push(t[3*e+0]),c.push(t[3*e+1]),c.push(t[3*e+2])}function Ge(e){h.push(e.x),h.push(e.y)}!function(){var e=c.length/3;if(f){for(var t=0,n=U*t,r=0;r<j;r++){var h=D[r];Be(h[2]+n,h[1]+n,h[0]+n)}n=U*(t=o+2*x);for(var d=0;d<j;d++){var m=D[d];Be(m[0]+n,m[1]+n,m[2]+n)}}else{for(var v=0;v<j;v++){var y=D[v];Be(y[2],y[1],y[0])}for(var _=0;_<j;_++){var w=D[_];Be(w[0]+U*o,w[1]+U*o,w[2]+U*o)}}l.addGroup(e,c.length/3-e,0)}(),function(){var e=c.length/3,t=0;ze(N,t),t+=N.length;for(var n=0,r=k.length;n<r;n++){var o=k[n];ze(o,t),t+=o.length}l.addGroup(e,c.length/3-e,1)}()}return o.setAttribute("position",new wn(c,3)),o.setAttribute("uv",new wn(h,2)),o.computeVertexNormals(),o}return Object(_.a)(n,[{key:"toJSON",value:function(){var data=Pn.prototype.toJSON.call(this);return function(e,t,data){if(data.shapes=[],Array.isArray(e))for(var n=0,r=e.length;n<r;n++){var o=e[n];data.shapes.push(o.uuid)}else data.shapes.push(e.uuid);void 0!==t.extrudePath&&(data.options.extrudePath=t.extrudePath.toJSON());return data}(this.parameters.shapes,this.parameters.options,data)}}]),n}(Pn),us={generateTopUV:function(e,t,n,r,o){var l=t[3*n],c=t[3*n+1],h=t[3*r],d=t[3*r+1],f=t[3*o],m=t[3*o+1];return[new Se(l,c),new Se(h,d),new Se(f,m)]},generateSideWallUV:function(e,t,n,r,o,l){var c=t[3*n],h=t[3*n+1],d=t[3*n+2],f=t[3*r],m=t[3*r+1],v=t[3*r+2],y=t[3*o],x=t[3*o+1],_=t[3*o+2],w=t[3*l],M=t[3*l+1],S=t[3*l+2];return Math.abs(h-m)<.01?[new Se(c,1-d),new Se(f,1-v),new Se(y,1-_),new Se(w,1-S)]:[new Se(h,1-d),new Se(m,1-v),new Se(x,1-_),new Se(M,1-S)]}};function hs(e,t,n){Pn.call(this),this.type="ParametricGeometry",this.parameters={func:e,slices:t,stacks:n};var r=[],o=[],l=[],c=[],h=1e-5,d=new Ie,f=new Ie,m=new Ie,v=new Ie,y=new Ie;e.length<3&&console.error("THREE.ParametricGeometry: Function must now modify a Vector3 as third parameter.");for(var x=t+1,_=0;_<=n;_++)for(var w=_/n,M=0;M<=t;M++){var u=M/t;e(u,w,f),o.push(f.x,f.y,f.z),u-h>=0?(e(u-h,w,m),v.subVectors(f,m)):(e(u+h,w,m),v.subVectors(m,f)),w-h>=0?(e(u,w-h,m),y.subVectors(f,m)):(e(u,w+h,m),y.subVectors(m,f)),d.crossVectors(v,y).normalize(),l.push(d.x,d.y,d.z),c.push(u,w)}for(var S=0;S<n;S++)for(var E=0;E<t;E++){var a=S*x+E,b=S*x+E+1,T=(S+1)*x+E+1,C=(S+1)*x+E;r.push(a,b,C),r.push(b,T,C)}this.setIndex(r),this.setAttribute("position",new wn(o,3)),this.setAttribute("normal",new wn(l,3)),this.setAttribute("uv",new wn(c,2))}hs.prototype=Object.create(Pn.prototype),hs.prototype.constructor=hs;var ds=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:12;Object(x.a)(this,n),(r=t.call(this)).type="ShapeGeometry",r.parameters={shapes:e,curveSegments:o};var l=[],c=[],h=[],d=[],f=0,m=0;if(!1===Array.isArray(e))y(e);else for(var v=0;v<e.length;v++)y(e[v]),r.addGroup(f,m,v),f+=m,m=0;function y(e){var t=c.length/3,n=e.extractPoints(o),r=n.shape,f=n.holes;!1===os.isClockWise(r)&&(r=r.reverse());for(var v=0,y=f.length;v<y;v++){var x=f[v];!0===os.isClockWise(x)&&(f[v]=x.reverse())}for(var _=os.triangulateShape(r,f),w=0,M=f.length;w<M;w++){var S=f[w];r=r.concat(S)}for(var E=0,T=r.length;E<T;E++){var C=r[E];c.push(C.x,C.y,0),h.push(0,0,1),d.push(C.x,C.y)}for(var L=0,A=_.length;L<A;L++){var R=_[L],a=R[0]+t,b=R[1]+t,k=R[2]+t;l.push(a,b,k),m+=3}}return r.setIndex(l),r.setAttribute("position",new wn(c,3)),r.setAttribute("normal",new wn(h,3)),r.setAttribute("uv",new wn(d,2)),r}return Object(_.a)(n,[{key:"toJSON",value:function(){var data=Pn.prototype.toJSON.call(this);return function(e,data){if(data.shapes=[],Array.isArray(e))for(var t=0,n=e.length;t<n;t++){var r=e[t];data.shapes.push(r.uuid)}else data.shapes.push(e.uuid);return data}(this.parameters.shapes,data)}}]),n}(Pn);var ps=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="ShadowMaterial",r.color=new cn(0),r.transparent=!0,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this}}]),n}(tn);ps.prototype.isShadowMaterial=!0;var fs=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this,e)).type="RawShaderMaterial",r}return Object(_.a)(n)}(ni);function ms(e){tn.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new cn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new cn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new Se(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.flatShading=!1,this.vertexTangents=!1,this.setValues(e)}function vs(e){ms.call(this),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoat=0,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new Se(1,1),this.clearcoatNormalMap=null,this.reflectivity=.5,Object.defineProperty(this,"ior",{get:function(){return(1+.4*this.reflectivity)/(1-.4*this.reflectivity)},set:function(e){this.reflectivity=Me.clamp(2.5*(e-1)/(e+1),0,1)}}),this.sheen=null,this.transmission=0,this.transmissionMap=null,this.setValues(e)}fs.prototype.isRawShaderMaterial=!0,ms.prototype=Object.create(tn.prototype),ms.prototype.constructor=ms,ms.prototype.isMeshStandardMaterial=!0,ms.prototype.copy=function(source){return tn.prototype.copy.call(this,source),this.defines={STANDARD:""},this.color.copy(source.color),this.roughness=source.roughness,this.metalness=source.metalness,this.map=source.map,this.lightMap=source.lightMap,this.lightMapIntensity=source.lightMapIntensity,this.aoMap=source.aoMap,this.aoMapIntensity=source.aoMapIntensity,this.emissive.copy(source.emissive),this.emissiveMap=source.emissiveMap,this.emissiveIntensity=source.emissiveIntensity,this.bumpMap=source.bumpMap,this.bumpScale=source.bumpScale,this.normalMap=source.normalMap,this.normalMapType=source.normalMapType,this.normalScale.copy(source.normalScale),this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this.roughnessMap=source.roughnessMap,this.metalnessMap=source.metalnessMap,this.alphaMap=source.alphaMap,this.envMap=source.envMap,this.envMapIntensity=source.envMapIntensity,this.refractionRatio=source.refractionRatio,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.wireframeLinecap=source.wireframeLinecap,this.wireframeLinejoin=source.wireframeLinejoin,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this.flatShading=source.flatShading,this.vertexTangents=source.vertexTangents,this},vs.prototype=Object.create(ms.prototype),vs.prototype.constructor=vs,vs.prototype.isMeshPhysicalMaterial=!0,vs.prototype.copy=function(source){return ms.prototype.copy.call(this,source),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=source.clearcoat,this.clearcoatMap=source.clearcoatMap,this.clearcoatRoughness=source.clearcoatRoughness,this.clearcoatRoughnessMap=source.clearcoatRoughnessMap,this.clearcoatNormalMap=source.clearcoatNormalMap,this.clearcoatNormalScale.copy(source.clearcoatNormalScale),this.reflectivity=source.reflectivity,source.sheen?this.sheen=(this.sheen||new cn).copy(source.sheen):this.sheen=null,this.transmission=source.transmission,this.transmissionMap=source.transmissionMap,this};var gs=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="MeshPhongMaterial",r.color=new cn(16777215),r.specular=new cn(1118481),r.shininess=30,r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new cn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Se(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.specular.copy(source.specular),this.shininess=source.shininess,this.map=source.map,this.lightMap=source.lightMap,this.lightMapIntensity=source.lightMapIntensity,this.aoMap=source.aoMap,this.aoMapIntensity=source.aoMapIntensity,this.emissive.copy(source.emissive),this.emissiveMap=source.emissiveMap,this.emissiveIntensity=source.emissiveIntensity,this.bumpMap=source.bumpMap,this.bumpScale=source.bumpScale,this.normalMap=source.normalMap,this.normalMapType=source.normalMapType,this.normalScale.copy(source.normalScale),this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this.specularMap=source.specularMap,this.alphaMap=source.alphaMap,this.envMap=source.envMap,this.combine=source.combine,this.reflectivity=source.reflectivity,this.refractionRatio=source.refractionRatio,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.wireframeLinecap=source.wireframeLinecap,this.wireframeLinejoin=source.wireframeLinejoin,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this.flatShading=source.flatShading,this}}]),n}(tn);gs.prototype.isMeshPhongMaterial=!0;var ys=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).defines={TOON:""},r.type="MeshToonMaterial",r.color=new cn(16777215),r.map=null,r.gradientMap=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new cn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Se(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.map=source.map,this.gradientMap=source.gradientMap,this.lightMap=source.lightMap,this.lightMapIntensity=source.lightMapIntensity,this.aoMap=source.aoMap,this.aoMapIntensity=source.aoMapIntensity,this.emissive.copy(source.emissive),this.emissiveMap=source.emissiveMap,this.emissiveIntensity=source.emissiveIntensity,this.bumpMap=source.bumpMap,this.bumpScale=source.bumpScale,this.normalMap=source.normalMap,this.normalMapType=source.normalMapType,this.normalScale.copy(source.normalScale),this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this.alphaMap=source.alphaMap,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.wireframeLinecap=source.wireframeLinecap,this.wireframeLinejoin=source.wireframeLinejoin,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this}}]),n}(tn);ys.prototype.isMeshToonMaterial=!0;var xs=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="MeshNormalMaterial",r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Se(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.wireframe=!1,r.wireframeLinewidth=1,r.fog=!1,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.bumpMap=source.bumpMap,this.bumpScale=source.bumpScale,this.normalMap=source.normalMap,this.normalMapType=source.normalMapType,this.normalScale.copy(source.normalScale),this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this.flatShading=source.flatShading,this}}]),n}(tn);xs.prototype.isMeshNormalMaterial=!0;var bs=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="MeshLambertMaterial",r.color=new cn(16777215),r.map=null,r.lightMap=null,r.lightMapIntensity=1,r.aoMap=null,r.aoMapIntensity=1,r.emissive=new cn(0),r.emissiveIntensity=1,r.emissiveMap=null,r.specularMap=null,r.alphaMap=null,r.envMap=null,r.combine=0,r.reflectivity=1,r.refractionRatio=.98,r.wireframe=!1,r.wireframeLinewidth=1,r.wireframeLinecap="round",r.wireframeLinejoin="round",r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.map=source.map,this.lightMap=source.lightMap,this.lightMapIntensity=source.lightMapIntensity,this.aoMap=source.aoMap,this.aoMapIntensity=source.aoMapIntensity,this.emissive.copy(source.emissive),this.emissiveMap=source.emissiveMap,this.emissiveIntensity=source.emissiveIntensity,this.specularMap=source.specularMap,this.alphaMap=source.alphaMap,this.envMap=source.envMap,this.combine=source.combine,this.reflectivity=source.reflectivity,this.refractionRatio=source.refractionRatio,this.wireframe=source.wireframe,this.wireframeLinewidth=source.wireframeLinewidth,this.wireframeLinecap=source.wireframeLinecap,this.wireframeLinejoin=source.wireframeLinejoin,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this}}]),n}(tn);bs.prototype.isMeshLambertMaterial=!0;var _s=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).defines={MATCAP:""},r.type="MeshMatcapMaterial",r.color=new cn(16777215),r.matcap=null,r.map=null,r.bumpMap=null,r.bumpScale=1,r.normalMap=null,r.normalMapType=0,r.normalScale=new Se(1,1),r.displacementMap=null,r.displacementScale=1,r.displacementBias=0,r.alphaMap=null,r.skinning=!1,r.morphTargets=!1,r.morphNormals=!1,r.flatShading=!1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.defines={MATCAP:""},this.color.copy(source.color),this.matcap=source.matcap,this.map=source.map,this.bumpMap=source.bumpMap,this.bumpScale=source.bumpScale,this.normalMap=source.normalMap,this.normalMapType=source.normalMapType,this.normalScale.copy(source.normalScale),this.displacementMap=source.displacementMap,this.displacementScale=source.displacementScale,this.displacementBias=source.displacementBias,this.alphaMap=source.alphaMap,this.skinning=source.skinning,this.morphTargets=source.morphTargets,this.morphNormals=source.morphNormals,this.flatShading=source.flatShading,this}}]),n}(tn);_s.prototype.isMeshMatcapMaterial=!0;var ws=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="LineDashedMaterial",r.scale=1,r.dashSize=3,r.gapSize=1,r.setValues(e),r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.scale=source.scale,this.dashSize=source.dashSize,this.gapSize=source.gapSize,this}}]),n}(mo);ws.prototype.isLineDashedMaterial=!0;var Ms={arraySlice:function(e,t,n){return Ms.isTypedArray(e)?new e.constructor(e.subarray(t,void 0!==n?n:e.length)):e.slice(t,n)},convertArray:function(e,t,n){return!e||!n&&e.constructor===t?e:"number"==typeof t.BYTES_PER_ELEMENT?new t(e):Array.prototype.slice.call(e)},isTypedArray:function(object){return ArrayBuffer.isView(object)&&!(object instanceof DataView)},getKeyframeOrder:function(e){for(var t=e.length,n=new Array(t),r=0;r!==t;++r)n[r]=r;return n.sort((function(i,t){return e[i]-e[t]})),n},sortedArray:function(e,t,n){for(var r=e.length,o=new e.constructor(r),l=0,c=0;c!==r;++l)for(var h=n[l]*t,d=0;d!==t;++d)o[c++]=e[h+d];return o},flattenJSON:function(e,t,n,r){for(var i=1,o=e[0];void 0!==o&&void 0===o[r];)o=e[i++];if(void 0!==o){var l=o[r];if(void 0!==l)if(Array.isArray(l))do{void 0!==(l=o[r])&&(t.push(o.time),n.push.apply(n,l)),o=e[i++]}while(void 0!==o);else if(void 0!==l.toArray)do{void 0!==(l=o[r])&&(t.push(o.time),l.toArray(n,n.length)),o=e[i++]}while(void 0!==o);else do{void 0!==(l=o[r])&&(t.push(o.time),n.push(l)),o=e[i++]}while(void 0!==o)}},subclip:function(e,t,n,r){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:30,l=e.clone();l.name=t;for(var c=[],h=0;h<l.tracks.length;++h){for(var track=l.tracks[h],d=track.getValueSize(),f=[],m=[],v=0;v<track.times.length;++v){var y=track.times[v]*o;if(!(y<n||y>=r)){f.push(track.times[v]);for(var x=0;x<d;++x)m.push(track.values[v*d+x])}}0!==f.length&&(track.times=Ms.convertArray(f,track.times.constructor),track.values=Ms.convertArray(m,track.values.constructor),c.push(track))}l.tracks=c;for(var _=1/0,w=0;w<l.tracks.length;++w)_>l.tracks[w].times[0]&&(_=l.tracks[w].times[0]);for(var M=0;M<l.tracks.length;++M)l.tracks[M].shift(-1*_);return l.resetDuration(),l},makeClipAdditive:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30;r<=0&&(r=30);for(var o=n.tracks.length,l=t/r,c=function(t){var r=n.tracks[t],o=r.ValueTypeName;if("bool"===o||"string"===o)return"continue";var c=e.tracks.find((function(track){return track.name===r.name&&track.ValueTypeName===o}));if(void 0===c)return"continue";var h=0,d=r.getValueSize();r.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(h=d/3);var f=0,m=c.getValueSize();c.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(f=m/3);var v=r.times.length-1,y=void 0;if(l<=r.times[0]){var x=h,_=d-h;y=Ms.arraySlice(r.values,x,_)}else if(l>=r.times[v]){var w=v*d+h,M=w+d-h;y=Ms.arraySlice(r.values,w,M)}else{var S=r.createInterpolant(),E=h,T=d-h;S.evaluate(l),y=Ms.arraySlice(S.resultBuffer,E,T)}"quaternion"===o&&(new Oe).fromArray(y).normalize().conjugate().toArray(y);for(var C=c.times.length,L=0;L<C;++L){var A=L*m+f;if("quaternion"===o)Oe.multiplyQuaternionsFlat(c.values,A,y,0,c.values,A);else for(var R=m-2*f,k=0;k<R;++k)c.values[A+k]-=y[k]}},h=0;h<o;++h)c(h);return e.blendMode=ue,e}};function Ss(e,t,n,r){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new t.constructor(n),this.sampleValues=t,this.valueSize=n}function Es(e,t,n,r){Ss.call(this,e,t,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function Ts(e,t,n,r){Ss.call(this,e,t,n,r)}function Cs(e,t,n,r){Ss.call(this,e,t,n,r)}Object.assign(Ss.prototype,{evaluate:function(e){var t=this.parameterPositions,n=this._cachedIndex,r=t[n],o=t[n-1];e:{t:{var l;n:{i:if(!(e<r)){for(var c=n+2;;){if(void 0===r){if(e<o)break i;return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,e,o)}if(n===c)break;if(o=r,e<(r=t[++n]))break t}l=t.length;break n}if(e>=o)break e;var h=t[1];e<h&&(n=2,o=h);for(var d=n-2;;){if(void 0===o)return this._cachedIndex=0,this.beforeStart_(0,e,r);if(n===d)break;if(r=o,e>=(o=t[--n-1]))break t}l=n,n=0}for(;n<l;){var f=n+l>>>1;e<t[f]?l=f:n=f+1}if(r=t[n],void 0===(o=t[n-1]))return this._cachedIndex=0,this.beforeStart_(0,e,r);if(void 0===r)return n=t.length,this._cachedIndex=n,this.afterEnd_(n-1,o,e)}this._cachedIndex=n,this.intervalChanged_(n,o,r)}return this.interpolate_(n,o,e,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r,l=0;l!==r;++l)t[l]=n[o+l];return t},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(Ss.prototype,{beforeStart_:Ss.prototype.copySampleValue_,afterEnd_:Ss.prototype.copySampleValue_}),Es.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Es,DefaultSettings_:{endingStart:oe,endingEnd:oe},intervalChanged_:function(e,t,n){var r=this.parameterPositions,o=e-2,l=e+1,c=r[o],h=r[l];if(void 0===c)switch(this.getSettings_().endingStart){case se:o=e,c=2*t-n;break;case le:c=t+r[o=r.length-2]-r[o+1];break;default:o=e,c=n}if(void 0===h)switch(this.getSettings_().endingEnd){case se:l=e,h=2*n-t;break;case le:l=1,h=n+r[1]-r[0];break;default:l=e-1,h=t}var d=.5*(n-t),f=this.valueSize;this._weightPrev=d/(t-c),this._weightNext=d/(h-n),this._offsetPrev=o*f,this._offsetNext=l*f},interpolate_:function(e,t,n,r){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=e*c,d=h-c,f=this._offsetPrev,m=this._offsetNext,v=this._weightPrev,y=this._weightNext,p=(n-t)/(r-t),x=p*p,_=x*p,w=-v*_+2*v*x-v*p,M=(1+v)*_+(-1.5-2*v)*x+(-.5+v)*p+1,S=(-1-y)*_+(1.5+y)*x+.5*p,E=y*_-y*x,T=0;T!==c;++T)o[T]=w*l[f+T]+M*l[d+T]+S*l[h+T]+E*l[m+T];return o}}),Ts.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ts,interpolate_:function(e,t,n,r){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=e*c,d=h-c,f=(n-t)/(r-t),m=1-f,v=0;v!==c;++v)o[v]=l[d+v]*m+l[h+v]*f;return o}}),Cs.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Cs,interpolate_:function(e){return this.copySampleValue_(e-1)}});var Ls=function(){function e(t,n,r,o){if(Object(x.a)(this,e),void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===n||0===n.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=Ms.convertArray(n,this.TimeBufferType),this.values=Ms.convertArray(r,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}return Object(_.a)(e,[{key:"InterpolantFactoryMethodDiscrete",value:function(e){return new Cs(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodLinear",value:function(e){return new Ts(this.times,this.values,this.getValueSize(),e)}},{key:"InterpolantFactoryMethodSmooth",value:function(e){return new Es(this.times,this.values,this.getValueSize(),e)}},{key:"setInterpolation",value:function(e){var t;switch(e){case ie:t=this.InterpolantFactoryMethodDiscrete;break;case re:t=this.InterpolantFactoryMethodLinear;break;case ae:t=this.InterpolantFactoryMethodSmooth}if(void 0===t){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return console.warn("THREE.KeyframeTrack:",n),this}return this.createInterpolant=t,this}},{key:"getInterpolation",value:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return ie;case this.InterpolantFactoryMethodLinear:return re;case this.InterpolantFactoryMethodSmooth:return ae}}},{key:"getValueSize",value:function(){return this.values.length/this.times.length}},{key:"shift",value:function(e){if(0!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]+=e;return this}},{key:"scale",value:function(e){if(1!==e)for(var t=this.times,n=0,r=t.length;n!==r;++n)t[n]*=e;return this}},{key:"trim",value:function(e,t){for(var n=this.times,r=n.length,o=0,l=r-1;o!==r&&n[o]<e;)++o;for(;-1!==l&&n[l]>t;)--l;if(++l,0!==o||l!==r){o>=l&&(o=(l=Math.max(l,1))-1);var c=this.getValueSize();this.times=Ms.arraySlice(n,o,l),this.values=Ms.arraySlice(this.values,o*c,l*c)}return this}},{key:"validate",value:function(){var e=!0,t=this.getValueSize();t-Math.floor(t)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),e=!1);var n=this.times,r=this.values,o=n.length;0===o&&(console.error("THREE.KeyframeTrack: Track is empty.",this),e=!1);for(var l=null,c=0;c!==o;c++){var h=n[c];if("number"==typeof h&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,c,h),e=!1;break}if(null!==l&&l>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,c,h,l),e=!1;break}l=h}if(void 0!==r&&Ms.isTypedArray(r))for(var d=0,f=r.length;d!==f;++d){var m=r[d];if(isNaN(m)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,d,m),e=!1;break}}return e}},{key:"optimize",value:function(){for(var e=Ms.arraySlice(this.times),t=Ms.arraySlice(this.values),n=this.getValueSize(),r=this.getInterpolation()===ae,o=e.length-1,l=1,c=1;c<o;++c){var h=!1,time=e[c];if(time!==e[c+1]&&(1!==c||time!==e[0]))if(r)h=!0;else for(var d=c*n,f=d-n,m=d+n,v=0;v!==n;++v){var y=t[d+v];if(y!==t[f+v]||y!==t[m+v]){h=!0;break}}if(h){if(c!==l){e[l]=e[c];for(var x=c*n,_=l*n,w=0;w!==n;++w)t[_+w]=t[x+w]}++l}}if(o>0){e[l]=e[o];for(var M=o*n,S=l*n,E=0;E!==n;++E)t[S+E]=t[M+E];++l}return l!==e.length?(this.times=Ms.arraySlice(e,0,l),this.values=Ms.arraySlice(t,0,l*n)):(this.times=e,this.values=t),this}},{key:"clone",value:function(){var e=Ms.arraySlice(this.times,0),t=Ms.arraySlice(this.values,0),track=new(0,this.constructor)(this.name,e,t);return track.createInterpolant=this.createInterpolant,track}}],[{key:"toJSON",value:function(track){var e,t=track.constructor;if(t.toJSON!==this.toJSON)e=t.toJSON(track);else{e={name:track.name,times:Ms.convertArray(track.times,Array),values:Ms.convertArray(track.values,Array)};var n=track.getInterpolation();n!==track.DefaultInterpolation&&(e.interpolation=n)}return e.type=track.ValueTypeName,e}}]),e}();Ls.prototype.TimeBufferType=Float32Array,Ls.prototype.ValueBufferType=Float32Array,Ls.prototype.DefaultInterpolation=re;var As=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n)}(Ls);As.prototype.ValueTypeName="bool",As.prototype.ValueBufferType=Array,As.prototype.DefaultInterpolation=ie,As.prototype.InterpolantFactoryMethodLinear=void 0,As.prototype.InterpolantFactoryMethodSmooth=void 0;var Rs=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n)}(Ls);Rs.prototype.ValueTypeName="color";var ks=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n)}(Ls);function Ps(e,t,n,r){Ss.call(this,e,t,n,r)}ks.prototype.ValueTypeName="number",Ps.prototype=Object.assign(Object.create(Ss.prototype),{constructor:Ps,interpolate_:function(e,t,n,r){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=(n-t)/(r-t),d=e*c,f=d+c;d!==f;d+=4)Oe.slerpFlat(o,0,l,d-c,l,d,h);return o}});var Os=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n,[{key:"InterpolantFactoryMethodLinear",value:function(e){return new Ps(this.times,this.values,this.getValueSize(),e)}}]),n}(Ls);Os.prototype.ValueTypeName="quaternion",Os.prototype.DefaultInterpolation=re,Os.prototype.InterpolantFactoryMethodSmooth=void 0;var Is=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n)}(Ls);Is.prototype.ValueTypeName="string",Is.prototype.ValueBufferType=Array,Is.prototype.DefaultInterpolation=ie,Is.prototype.InterpolantFactoryMethodLinear=void 0,Is.prototype.InterpolantFactoryMethodSmooth=void 0;var Ds=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.apply(this,arguments)}return Object(_.a)(n)}(Ls);Ds.prototype.ValueTypeName="vector";var Ns=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,r=arguments.length>2?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ce;Object(x.a)(this,e),this.name=t,this.tracks=r,this.duration=n,this.blendMode=o,this.uuid=Me.generateUUID(),this.duration<0&&this.resetDuration()}return Object(_.a)(e,[{key:"resetDuration",value:function(){for(var e=0,t=0,n=this.tracks.length;t!==n;++t){var track=this.tracks[t];e=Math.max(e,track.times[track.times.length-1])}return this.duration=e,this}},{key:"trim",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}},{key:"validate",value:function(){for(var e=!0,t=0;t<this.tracks.length;t++)e=e&&this.tracks[t].validate();return e}},{key:"optimize",value:function(){for(var e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}},{key:"clone",value:function(){for(var e=[],t=0;t<this.tracks.length;t++)e.push(this.tracks[t].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}},{key:"toJSON",value:function(){return this.constructor.toJSON(this)}}],[{key:"parse",value:function(e){for(var t=[],n=e.tracks,r=1/(e.fps||1),o=0,l=n.length;o!==l;++o)t.push(Hs(n[o]).scale(r));var c=new this(e.name,e.duration,t,e.blendMode);return c.uuid=e.uuid,c}},{key:"toJSON",value:function(e){for(var t=[],n=e.tracks,r={name:e.name,duration:e.duration,tracks:t,uuid:e.uuid,blendMode:e.blendMode},o=0,l=n.length;o!==l;++o)t.push(Ls.toJSON(n[o]));return r}},{key:"CreateFromMorphTargetSequence",value:function(e,t,n,r){for(var o=t.length,l=[],c=0;c<o;c++){var h=[],d=[];h.push((c+o-1)%o,c,(c+1)%o),d.push(0,1,0);var f=Ms.getKeyframeOrder(h);h=Ms.sortedArray(h,1,f),d=Ms.sortedArray(d,1,f),r||0!==h[0]||(h.push(o),d.push(d[0])),l.push(new ks(".morphTargetInfluences["+t[c].name+"]",h,d).scale(1/n))}return new this(e,-1,l)}},{key:"findByName",value:function(e,t){var n=e;if(!Array.isArray(e)){var r=e;n=r.geometry&&r.geometry.animations||r.animations}for(var o=0;o<n.length;o++)if(n[o].name===t)return n[o];return null}},{key:"CreateClipsFromMorphTargetSequences",value:function(e,t,n){for(var r={},pattern=/^([\w-]*?)([\d]+)$/,o=0,l=e.length;o<l;o++){var c=e[o],h=c.name.match(pattern);if(h&&h.length>1){var d=h[1],f=r[d];f||(r[d]=f=[]),f.push(c)}}var m=[];for(var v in r)m.push(this.CreateFromMorphTargetSequence(v,r[v],t,n));return m}},{key:"parseAnimation",value:function(e,t){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(e,t,n,r,o){if(0!==n.length){var l=[],c=[];Ms.flattenJSON(n,l,c,r),0!==l.length&&o.push(new e(t,l,c))}},r=[],o=e.name||"default",l=e.fps||30,c=e.blendMode,h=e.length||-1,d=e.hierarchy||[],f=0;f<d.length;f++){var m=d[f].keys;if(m&&0!==m.length)if(m[0].morphTargets){var v={},y=void 0;for(y=0;y<m.length;y++)if(m[y].morphTargets)for(var x=0;x<m[y].morphTargets.length;x++)v[m[y].morphTargets[x]]=-1;for(var _ in v){for(var w=[],M=[],S=0;S!==m[y].morphTargets.length;++S){var E=m[y];w.push(E.time),M.push(E.morphTarget===_?1:0)}r.push(new ks(".morphTargetInfluence["+_+"]",w,M))}h=v.length*(l||1)}else{var T=".bones["+t[f].name+"]";n(Ds,T+".position",m,"pos",r),n(Os,T+".quaternion",m,"rot",r),n(Ds,T+".scale",m,"scl",r)}}return 0===r.length?null:new this(o,h,r,c)}}]),e}();function Hs(e){if(void 0===e.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var t=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return ks;case"vector":case"vector2":case"vector3":case"vector4":return Ds;case"color":return Rs;case"quaternion":return Os;case"bool":case"boolean":return As;case"string":return Is}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){var n=[],r=[];Ms.flattenJSON(e.keys,n,r,"value"),e.times=n,e.values=r}return void 0!==t.parse?t.parse(e):new t(e.name,e.times,e.values,e.interpolation)}var zs={enabled:!1,files:{},add:function(e,t){!1!==this.enabled&&(this.files[e]=t)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]},clear:function(){this.files={}}};function Fs(e,t,n){var r=this,o=!1,l=0,c=0,h=void 0,d=[];this.onStart=void 0,this.onLoad=e,this.onProgress=t,this.onError=n,this.itemStart=function(e){c++,!1===o&&void 0!==r.onStart&&r.onStart(e,l,c),o=!0},this.itemEnd=function(e){l++,void 0!==r.onProgress&&r.onProgress(e,l,c),l===c&&(o=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(e){void 0!==r.onError&&r.onError(e)},this.resolveURL=function(e){return h?h(e):e},this.setURLModifier=function(e){return h=e,this},this.addHandler=function(e,t){return d.push(e,t),this},this.removeHandler=function(e){var t=d.indexOf(e);return-1!==t&&d.splice(t,2),this},this.getHandler=function(e){for(var t=0,n=d.length;t<n;t+=2){var r=d[t],o=d[t+1];if(r.global&&(r.lastIndex=0),r.test(e))return o}return null}}var Bs=new Fs;function Us(e){this.manager=void 0!==e?e:Bs,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}Object.assign(Us.prototype,{load:function(){},loadAsync:function(e,t){var n=this;return new Promise((function(r,o){n.load(e,r,t,o)}))},parse:function(){},setCrossOrigin:function(e){return this.crossOrigin=e,this},setWithCredentials:function(e){return this.withCredentials=e,this},setPath:function(path){return this.path=path,this},setResourcePath:function(e){return this.resourcePath=e,this},setRequestHeader:function(e){return this.requestHeader=e,this}});var js={};function Gs(e){Us.call(this,e)}Gs.prototype=Object.assign(Object.create(Us.prototype),{constructor:Gs,load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,l=zs.get(e);if(void 0!==l)return o.manager.itemStart(e),setTimeout((function(){t&&t(l),o.manager.itemEnd(e)}),0),l;if(void 0===js[e]){var c,h=e.match(/^data:(.*?)(;base64)?,(.*)$/);if(h){var d=h[1],f=!!h[2],data=h[3];data=decodeURIComponent(data),f&&(data=atob(data));try{var m,v=(this.responseType||"").toLowerCase();switch(v){case"arraybuffer":case"blob":for(var view=new Uint8Array(data.length),y=0;y<data.length;y++)view[y]=data.charCodeAt(y);m="blob"===v?new Blob([view.buffer],{type:d}):view.buffer;break;case"document":var x=new DOMParser;m=x.parseFromString(data,d);break;case"json":m=JSON.parse(data);break;default:m=data}setTimeout((function(){t&&t(m),o.manager.itemEnd(e)}),0)}catch(t){setTimeout((function(){r&&r(t),o.manager.itemError(e),o.manager.itemEnd(e)}),0)}}else{for(var header in js[e]=[],js[e].push({onLoad:t,onProgress:n,onError:r}),(c=new XMLHttpRequest).open("GET",e,!0),c.addEventListener("load",(function(t){var n=this.response,r=js[e];if(delete js[e],200===this.status||0===this.status){0===this.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),zs.add(e,n);for(var l=0,c=r.length;l<c;l++){var h=r[l];h.onLoad&&h.onLoad(n)}o.manager.itemEnd(e)}else{for(var d=0,f=r.length;d<f;d++){var m=r[d];m.onError&&m.onError(t)}o.manager.itemError(e),o.manager.itemEnd(e)}}),!1),c.addEventListener("progress",(function(t){for(var n=js[e],r=0,o=n.length;r<o;r++){var l=n[r];l.onProgress&&l.onProgress(t)}}),!1),c.addEventListener("error",(function(t){var n=js[e];delete js[e];for(var r=0,l=n.length;r<l;r++){var c=n[r];c.onError&&c.onError(t)}o.manager.itemError(e),o.manager.itemEnd(e)}),!1),c.addEventListener("abort",(function(t){var n=js[e];delete js[e];for(var r=0,l=n.length;r<l;r++){var c=n[r];c.onError&&c.onError(t)}o.manager.itemError(e),o.manager.itemEnd(e)}),!1),void 0!==this.responseType&&(c.responseType=this.responseType),void 0!==this.withCredentials&&(c.withCredentials=this.withCredentials),c.overrideMimeType&&c.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain"),this.requestHeader)c.setRequestHeader(header,this.requestHeader[header]);c.send(null)}return o.manager.itemStart(e),c}js[e].push({onLoad:t,onProgress:n,onError:r})},setResponseType:function(e){return this.responseType=e,this},setMimeType:function(e){return this.mimeType=e,this}});function Vs(e){Us.call(this,e)}Vs.prototype=Object.assign(Object.create(Us.prototype),{constructor:Vs,load:function(e,t,n,r){var o=this,l=[],c=new Oo,h=new Gs(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(o.withCredentials);var d=0;function f(i){h.load(e[i],(function(e){var n=o.parse(e,!0);l[i]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(d+=1)&&(1===n.mipmapCount&&(c.minFilter=G),c.image=l,c.format=n.format,c.needsUpdate=!0,t&&t(c))}),n,r)}if(Array.isArray(e))for(var m=0,v=e.length;m<v;++m)f(m);else h.load(e,(function(e){var n=o.parse(e,!0);if(n.isCubemap){for(var r=n.mipmaps.length/n.mipmapCount,h=0;h<r;h++){l[h]={mipmaps:[]};for(var d=0;d<n.mipmapCount;d++)l[h].mipmaps.push(n.mipmaps[h*n.mipmapCount+d]),l[h].format=n.format,l[h].width=n.width,l[h].height=n.height}c.image=l}else c.image.width=n.width,c.image.height=n.height,c.mipmaps=n.mipmaps;1===n.mipmapCount&&(c.minFilter=G),c.format=n.format,c.needsUpdate=!0,t&&t(c)}),n,r);return c}});var Ws=function(e){Object(v.a)(n,e);var t=S(n);function n(e){return Object(x.a)(this,n),t.call(this,e)}return Object(_.a)(n,[{key:"load",value:function(e,t,n,r){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,l=zs.get(e);if(void 0!==l)return o.manager.itemStart(e),setTimeout((function(){t&&t(l),o.manager.itemEnd(e)}),0),l;var image=document.createElementNS("http://www.w3.org/1999/xhtml","img");function c(){image.removeEventListener("load",c,!1),image.removeEventListener("error",h,!1),zs.add(e,this),t&&t(this),o.manager.itemEnd(e)}function h(t){image.removeEventListener("load",c,!1),image.removeEventListener("error",h,!1),r&&r(t),o.manager.itemError(e),o.manager.itemEnd(e)}return image.addEventListener("load",c,!1),image.addEventListener("error",h,!1),"data:"!==e.substr(0,5)&&void 0!==this.crossOrigin&&(image.crossOrigin=this.crossOrigin),o.manager.itemStart(e),image.src=e,image}}]),n}(Us),qs=function(e){Object(v.a)(n,e);var t=S(n);function n(e){return Object(x.a)(this,n),t.call(this,e)}return Object(_.a)(n,[{key:"load",value:function(e,t,n,r){var o=new si,l=new Ws(this.manager);l.setCrossOrigin(this.crossOrigin),l.setPath(this.path);var c=0;function h(i){l.load(e[i],(function(image){o.images[i]=image,6===++c&&(o.needsUpdate=!0,t&&t(o))}),void 0,r)}for(var d=0;d<e.length;++d)h(d);return o}}]),n}(Us);function Xs(e){Us.call(this,e)}function Ys(e){Us.call(this,e)}function Zs(){this.type="Curve",this.arcLengthDivisions=200}Xs.prototype=Object.assign(Object.create(Us.prototype),{constructor:Xs,load:function(e,t,n,r){var o=this,l=new ui,c=new Gs(this.manager);return c.setResponseType("arraybuffer"),c.setRequestHeader(this.requestHeader),c.setPath(this.path),c.setWithCredentials(o.withCredentials),c.load(e,(function(e){var n=o.parse(e);n&&(void 0!==n.image?l.image=n.image:void 0!==n.data&&(l.image.width=n.width,l.image.height=n.height,l.image.data=n.data),l.wrapS=void 0!==n.wrapS?n.wrapS:z,l.wrapT=void 0!==n.wrapT?n.wrapT:z,l.magFilter=void 0!==n.magFilter?n.magFilter:G,l.minFilter=void 0!==n.minFilter?n.minFilter:G,l.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.encoding&&(l.encoding=n.encoding),void 0!==n.flipY&&(l.flipY=n.flipY),void 0!==n.format&&(l.format=n.format),void 0!==n.type&&(l.type=n.type),void 0!==n.mipmaps&&(l.mipmaps=n.mipmaps,l.minFilter=W),1===n.mipmapCount&&(l.minFilter=G),void 0!==n.generateMipmaps&&(l.generateMipmaps=n.generateMipmaps),l.needsUpdate=!0,t&&t(l,n))}),n,r),l}}),Ys.prototype=Object.assign(Object.create(Us.prototype),{constructor:Ys,load:function(e,t,n,r){var o=new Ae,l=new Ws(this.manager);return l.setCrossOrigin(this.crossOrigin),l.setPath(this.path),l.load(e,(function(image){o.image=image;var n=e.search(/\.jpe?g($|\?)/i)>0||0===e.search(/^data\:image\/jpeg/);o.format=n?Q:ee,o.needsUpdate=!0,void 0!==t&&t(o)}),n,r),o}}),Object.assign(Zs.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(u,e){var t=this.getUtoTmapping(u);return this.getPoint(t,e)},getPoints:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return t},getSpacedPoints:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,t=[],n=0;n<=e;n++)t.push(this.getPointAt(n/e));return t},getLength:function(){var e=this.getLengths();return e[e.length-1]},getLengths:function(e){if(void 0===e&&(e=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var t,n=[],r=this.getPoint(0),o=0;n.push(0);for(var p=1;p<=e;p++)o+=(t=this.getPoint(p/e)).distanceTo(r),n.push(o),r=t;return this.cacheArcLengths=n,n},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(u,e){var t,n=this.getLengths(),i=0,r=n.length;t=e||u*n[r-1];for(var o,l=0,c=r-1;l<=c;)if((o=n[i=Math.floor(l+(c-l)/2)]-t)<0)l=i+1;else{if(!(o>0)){c=i;break}c=i-1}if(n[i=c]===t)return i/(r-1);var h=n[i];return(i+(t-h)/(n[i+1]-h))/(r-1)},getTangent:function(e,t){var n=1e-4,r=e-n,o=e+n;r<0&&(r=0),o>1&&(o=1);var l=this.getPoint(r),c=this.getPoint(o),h=t||(l.isVector2?new Se:new Ie);return h.copy(c).sub(l).normalize(),h},getTangentAt:function(u,e){var t=this.getUtoTmapping(u);return this.getTangent(t,e)},computeFrenetFrames:function(e,t){for(var n=new Ie,r=[],o=[],l=[],c=new Ie,h=new pt,d=0;d<=e;d++){var u=d/e;r[d]=this.getTangentAt(u,new Ie),r[d].normalize()}o[0]=new Ie,l[0]=new Ie;var f=Number.MAX_VALUE,m=Math.abs(r[0].x),v=Math.abs(r[0].y),y=Math.abs(r[0].z);m<=f&&(f=m,n.set(1,0,0)),v<=f&&(f=v,n.set(0,1,0)),y<=f&&n.set(0,0,1),c.crossVectors(r[0],n).normalize(),o[0].crossVectors(r[0],c),l[0].crossVectors(r[0],o[0]);for(var x=1;x<=e;x++){if(o[x]=o[x-1].clone(),l[x]=l[x-1].clone(),c.crossVectors(r[x-1],r[x]),c.length()>Number.EPSILON){c.normalize();var _=Math.acos(Me.clamp(r[x-1].dot(r[x]),-1,1));o[x].applyMatrix4(h.makeRotationAxis(c,_))}l[x].crossVectors(r[x],o[x])}if(!0===t){var w=Math.acos(Me.clamp(o[0].dot(o[e]),-1,1));w/=e,r[0].dot(c.crossVectors(o[0],o[e]))>0&&(w=-w);for(var M=1;M<=e;M++)o[M].applyMatrix4(h.makeRotationAxis(r[M],w*M)),l[M].crossVectors(r[M],o[M])}return{tangents:r,normals:o,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(source){return this.arcLengthDivisions=source.arcLengthDivisions,this},toJSON:function(){var data={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return data.arcLengthDivisions=this.arcLengthDivisions,data.type=this.type,data},fromJSON:function(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}});var Js=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2*Math.PI,f=arguments.length>6&&void 0!==arguments[6]&&arguments[6],m=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0;return Object(x.a)(this,n),(e=t.call(this)).type="EllipseCurve",e.aX=r,e.aY=o,e.xRadius=l,e.yRadius=c,e.aStartAngle=h,e.aEndAngle=d,e.aClockwise=f,e.aRotation=m,e}return Object(_.a)(n,[{key:"getPoint",value:function(e,t){for(var n=t||new Se,r=2*Math.PI,o=this.aEndAngle-this.aStartAngle,l=Math.abs(o)<Number.EPSILON;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=l?0:r),!0!==this.aClockwise||l||(o===r?o=-r:o-=r);var c=this.aStartAngle+e*o,h=this.aX+this.xRadius*Math.cos(c),d=this.aY+this.yRadius*Math.sin(c);if(0!==this.aRotation){var f=Math.cos(this.aRotation),m=Math.sin(this.aRotation),v=h-this.aX,y=d-this.aY;h=v*f-y*m+this.aX,d=v*m+y*f+this.aY}return n.set(h,d)}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.aX=source.aX,this.aY=source.aY,this.xRadius=source.xRadius,this.yRadius=source.yRadius,this.aStartAngle=source.aStartAngle,this.aEndAngle=source.aEndAngle,this.aClockwise=source.aClockwise,this.aRotation=source.aRotation,this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.aX=this.aX,data.aY=this.aY,data.xRadius=this.xRadius,data.yRadius=this.yRadius,data.aStartAngle=this.aStartAngle,data.aEndAngle=this.aEndAngle,data.aClockwise=this.aClockwise,data.aRotation=this.aRotation,data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}}]),n}(Zs);Js.prototype.isEllipseCurve=!0;var $s=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o,l,c,h){var d;return Object(x.a)(this,n),(d=t.call(this,e,r,o,o,l,c,h)).type="ArcCurve",d}return Object(_.a)(n)}(Js);function Ks(){var e=0,t=0,n=0,r=0;function o(o,l,c,h){e=o,t=c,n=-3*o+3*l-2*c-h,r=2*o-2*l+c+h}return{initCatmullRom:function(e,t,n,r,l){o(t,n,l*(n-e),l*(r-t))},initNonuniformCatmullRom:function(e,t,n,r,l,c,h){var d=(t-e)/l-(n-e)/(l+c)+(n-t)/c,f=(n-t)/c-(r-t)/(c+h)+(r-n)/h;o(t,n,d*=c,f*=c)},calc:function(o){var l=o*o;return e+t*o+n*l+r*(l*o)}}}$s.prototype.isArcCurve=!0;var Qs=new Ie,el=new Ks,tl=new Ks,nl=new Ks,il=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"centripetal",c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:.5;return Object(x.a)(this,n),(e=t.call(this)).type="CatmullRomCurve3",e.points=r,e.closed=o,e.curveType=l,e.tension=c,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,o=r,l=this.points,c=l.length,p=(c-(this.closed?0:1))*e,h=Math.floor(p),d=p-h;this.closed?h+=h>0?0:(Math.floor(Math.abs(h)/c)+1)*c:0===d&&h===c-1&&(h=c-2,d=1),this.closed||h>0?t=l[(h-1)%c]:(Qs.subVectors(l[0],l[1]).add(l[0]),t=Qs);var f=l[h%c],m=l[(h+1)%c];if(this.closed||h+2<c?n=l[(h+2)%c]:(Qs.subVectors(l[c-1],l[c-2]).add(l[c-1]),n=Qs),"centripetal"===this.curveType||"chordal"===this.curveType){var v="chordal"===this.curveType?.5:.25,y=Math.pow(t.distanceToSquared(f),v),x=Math.pow(f.distanceToSquared(m),v),_=Math.pow(m.distanceToSquared(n),v);x<1e-4&&(x=1),y<1e-4&&(y=x),_<1e-4&&(_=x),el.initNonuniformCatmullRom(t.x,f.x,m.x,n.x,y,x,_),tl.initNonuniformCatmullRom(t.y,f.y,m.y,n.y,y,x,_),nl.initNonuniformCatmullRom(t.z,f.z,m.z,n.z,y,x,_)}else"catmullrom"===this.curveType&&(el.initCatmullRom(t.x,f.x,m.x,n.x,this.tension),tl.initCatmullRom(t.y,f.y,m.y,n.y,this.tension),nl.initCatmullRom(t.z,f.z,m.z,n.z,this.tension));return o.set(el.calc(d),tl.calc(d),nl.calc(d)),o}},{key:"copy",value:function(source){d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.points=[];for(var e=0,t=source.points.length;e<t;e++){var r=source.points[e];this.points.push(r.clone())}return this.closed=source.closed,this.curveType=source.curveType,this.tension=source.tension,this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);data.points=[];for(var e=0,t=this.points.length;e<t;e++){var r=this.points[e];data.points.push(r.toArray())}return data.closed=this.closed,data.curveType=this.curveType,data.tension=this.tension,data}},{key:"fromJSON",value:function(e){d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var o=e.points[t];this.points.push((new Ie).fromArray(o))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}}]),n}(Zs);function rl(e,t,n,r,o){var l=.5*(r-t),c=.5*(o-n),h=e*e;return(2*n-2*r+l+c)*(e*h)+(-3*n+3*r-2*l-c)*h+l*e+n}function al(e,t,n,r){return function(e,p){var t=1-e;return t*t*p}(e,t)+function(e,p){return 2*(1-e)*e*p}(e,n)+function(e,p){return e*e*p}(e,r)}function sl(e,t,n,r,o){return function(e,p){var t=1-e;return t*t*t*p}(e,t)+function(e,p){var t=1-e;return 3*t*t*e*p}(e,n)+function(e,p){return 3*(1-e)*e*e*p}(e,r)+function(e,p){return e*e*e*p}(e,o)}il.prototype.isCatmullRomCurve3=!0;var ll=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Se,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Se,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Se;return Object(x.a)(this,n),(e=t.call(this)).type="CubicBezierCurve",e.v0=r,e.v1=o,e.v2=l,e.v3=c,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se,n=t,r=this.v0,o=this.v1,l=this.v2,c=this.v3;return n.set(sl(e,r.x,o.x,l.x,c.x),sl(e,r.y,o.y,l.y,c.y)),n}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.v0.copy(source.v0),this.v1.copy(source.v1),this.v2.copy(source.v2),this.v3.copy(source.v3),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.v0=this.v0.toArray(),data.v1=this.v1.toArray(),data.v2=this.v2.toArray(),data.v3=this.v3.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(Zs);ll.prototype.isCubicBezierCurve=!0;var cl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ie,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:new Ie;return Object(x.a)(this,n),(e=t.call(this)).type="CubicBezierCurve3",e.v0=r,e.v1=o,e.v2=l,e.v3=c,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t,r=this.v0,o=this.v1,l=this.v2,c=this.v3;return n.set(sl(e,r.x,o.x,l.x,c.x),sl(e,r.y,o.y,l.y,c.y),sl(e,r.z,o.z,l.z,c.z)),n}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.v0.copy(source.v0),this.v1.copy(source.v1),this.v2.copy(source.v2),this.v3.copy(source.v3),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.v0=this.v0.toArray(),data.v1=this.v1.toArray(),data.v2=this.v2.toArray(),data.v3=this.v3.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}}]),n}(Zs);cl.prototype.isCubicBezierCurve3=!0;var hl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Se,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se;return Object(x.a)(this,n),(e=t.call(this)).type="LineCurve",e.v1=r,e.v2=o,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(u,e){return this.getPoint(u,e)}},{key:"getTangent",value:function(e,t){var n=t||new Se;return n.copy(this.v2).sub(this.v1).normalize(),n}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.v1.copy(source.v1),this.v2.copy(source.v2),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.v1=this.v1.toArray(),data.v2=this.v2.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Zs);hl.prototype.isLineCurve=!0;var pl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie;return Object(x.a)(this,n),(e=t.call(this)).type="LineCurve3",e.isLineCurve3=!0,e.v1=r,e.v2=o,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t;return 1===e?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(e).add(this.v1)),n}},{key:"getPointAt",value:function(u,e){return this.getPoint(u,e)}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.v1.copy(source.v1),this.v2.copy(source.v2),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.v1=this.v1.toArray(),data.v2=this.v2.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Zs),fl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Se,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Se;return Object(x.a)(this,n),(e=t.call(this)).type="QuadraticBezierCurve",e.v0=r,e.v1=o,e.v2=l,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se,n=t,r=this.v0,o=this.v1,l=this.v2;return n.set(al(e,r.x,o.x,l.x),al(e,r.y,o.y,l.y)),n}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.v0.copy(source.v0),this.v1.copy(source.v1),this.v2.copy(source.v2),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.v0=this.v0.toArray(),data.v1=this.v1.toArray(),data.v2=this.v2.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Zs);fl.prototype.isQuadraticBezierCurve=!0;var ml=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Ie;return Object(x.a)(this,n),(e=t.call(this)).type="QuadraticBezierCurve3",e.v0=r,e.v1=o,e.v2=l,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie,n=t,r=this.v0,o=this.v1,l=this.v2;return n.set(al(e,r.x,o.x,l.x),al(e,r.y,o.y,l.y),al(e,r.z,o.z,l.z)),n}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.v0.copy(source.v0),this.v1.copy(source.v1),this.v2.copy(source.v2),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.v0=this.v0.toArray(),data.v1=this.v1.toArray(),data.v2=this.v2.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}}]),n}(Zs);ml.prototype.isQuadraticBezierCurve3=!0;var vl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return Object(x.a)(this,n),(e=t.call(this)).type="SplineCurve",e.points=r,e}return Object(_.a)(n,[{key:"getPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se,n=t,r=this.points,p=(r.length-1)*e,o=Math.floor(p),l=p-o,c=r[0===o?o:o-1],h=r[o],d=r[o>r.length-2?r.length-1:o+1],f=r[o>r.length-3?r.length-1:o+2];return n.set(rl(l,c.x,h.x,d.x,f.x),rl(l,c.y,h.y,d.y,f.y)),n}},{key:"copy",value:function(source){d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.points=[];for(var e=0,t=source.points.length;e<t;e++){var r=source.points[e];this.points.push(r.clone())}return this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);data.points=[];for(var e=0,t=this.points.length;e<t;e++){var r=this.points[e];data.points.push(r.toArray())}return data}},{key:"fromJSON",value:function(e){d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.points=[];for(var t=0,r=e.points.length;t<r;t++){var o=e.points[t];this.points.push((new Se).fromArray(o))}return this}}]),n}(Zs);vl.prototype.isSplineCurve=!0;var gl=Object.freeze({__proto__:null,ArcCurve:$s,CatmullRomCurve3:il,CubicBezierCurve:ll,CubicBezierCurve3:cl,EllipseCurve:Js,LineCurve:hl,LineCurve3:pl,QuadraticBezierCurve:fl,QuadraticBezierCurve3:ml,SplineCurve:vl}),yl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e;return Object(x.a)(this,n),(e=t.call(this)).type="CurvePath",e.curves=[],e.autoClose=!1,e}return Object(_.a)(n,[{key:"add",value:function(e){this.curves.push(e)}},{key:"closePath",value:function(){var e=this.curves[0].getPoint(0),t=this.curves[this.curves.length-1].getPoint(1);e.equals(t)||this.curves.push(new hl(t,e))}},{key:"getPoint",value:function(e){for(var t=e*this.getLength(),n=this.getCurveLengths(),i=0;i<n.length;){if(n[i]>=t){var r=n[i]-t,o=this.curves[i],l=o.getLength(),u=0===l?0:1-r/l;return o.getPointAt(u)}i++}return null}},{key:"getLength",value:function(){var e=this.getCurveLengths();return e[e.length-1]}},{key:"updateArcLengths",value:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}},{key:"getCurveLengths",value:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var e=[],t=0,n=0,r=this.curves.length;n<r;n++)t+=this.curves[n].getLength(),e.push(t);return this.cacheLengths=e,e}},{key:"getSpacedPoints",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:40,t=[],n=0;n<=e;n++)t.push(this.getPoint(n/e));return this.autoClose&&t.push(t[0]),t}},{key:"getPoints",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,n=[],r=0,o=this.curves;r<o.length;r++)for(var l=o[r],c=l&&l.isEllipseCurve?2*t:l&&(l.isLineCurve||l.isLineCurve3)?1:l&&l.isSplineCurve?t*l.points.length:t,h=l.getPoints(c),d=0;d<h.length;d++){var f=h[d];e&&e.equals(f)||(n.push(f),e=f)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}},{key:"copy",value:function(source){d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.curves=[];for(var e=0,t=source.curves.length;e<t;e++){var r=source.curves[e];this.curves.push(r.clone())}return this.autoClose=source.autoClose,this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);data.autoClose=this.autoClose,data.curves=[];for(var e=0,t=this.curves.length;e<t;e++){var r=this.curves[e];data.curves.push(r.toJSON())}return data}},{key:"fromJSON",value:function(e){d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.autoClose=e.autoClose,this.curves=[];for(var t=0,r=e.curves.length;t<r;t++){var o=e.curves[t];this.curves.push((new gl[o.type]).fromJSON(o))}return this}}]),n}(Zs),xl=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="Path",r.currentPoint=new Se,e&&r.setFromPoints(e),r}return Object(_.a)(n,[{key:"setFromPoints",value:function(e){this.moveTo(e[0].x,e[0].y);for(var t=1,n=e.length;t<n;t++)this.lineTo(e[t].x,e[t].y);return this}},{key:"moveTo",value:function(e,t){return this.currentPoint.set(e,t),this}},{key:"lineTo",value:function(e,t){var n=new hl(this.currentPoint.clone(),new Se(e,t));return this.curves.push(n),this.currentPoint.set(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){var o=new fl(this.currentPoint.clone(),new Se(e,t),new Se(n,r));return this.curves.push(o),this.currentPoint.set(n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,o,l){var c=new ll(this.currentPoint.clone(),new Se(e,t),new Se(n,r),new Se(o,l));return this.curves.push(c),this.currentPoint.set(o,l),this}},{key:"splineThru",value:function(e){var t=[this.currentPoint.clone()].concat(e),n=new vl(t);return this.curves.push(n),this.currentPoint.copy(e[e.length-1]),this}},{key:"arc",value:function(e,t,n,r,o,l){var c=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(e+c,t+h,n,r,o,l),this}},{key:"absarc",value:function(e,t,n,r,o,l){return this.absellipse(e,t,n,n,r,o,l),this}},{key:"ellipse",value:function(e,t,n,r,o,l,c,h){var d=this.currentPoint.x,f=this.currentPoint.y;return this.absellipse(e+d,t+f,n,r,o,l,c,h),this}},{key:"absellipse",value:function(e,t,n,r,o,l,c,h){var d=new Js(e,t,n,r,o,l,c,h);if(this.curves.length>0){var f=d.getPoint(0);f.equals(this.currentPoint)||this.lineTo(f.x,f.y)}this.curves.push(d);var m=d.getPoint(1);return this.currentPoint.copy(m),this}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.currentPoint.copy(source.currentPoint),this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);return data.currentPoint=this.currentPoint.toArray(),data}},{key:"fromJSON",value:function(e){return d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.currentPoint.fromArray(e.currentPoint),this}}]),n}(yl),bl=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this,e)).uuid=Me.generateUUID(),r.type="Shape",r.holes=[],r}return Object(_.a)(n,[{key:"getPointsHoles",value:function(e){for(var t=[],n=0,r=this.holes.length;n<r;n++)t[n]=this.holes[n].getPoints(e);return t}},{key:"extractPoints",value:function(e){return{shape:this.getPoints(e),holes:this.getPointsHoles(e)}}},{key:"copy",value:function(source){d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.holes=[];for(var e=0,t=source.holes.length;e<t;e++){var r=source.holes[e];this.holes.push(r.clone())}return this}},{key:"toJSON",value:function(){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this);data.uuid=this.uuid,data.holes=[];for(var e=0,t=this.holes.length;e<t;e++){var r=this.holes[e];data.holes.push(r.toJSON())}return data}},{key:"fromJSON",value:function(e){d(Object(c.a)(n.prototype),"fromJSON",this).call(this,e),this.uuid=e.uuid,this.holes=[];for(var t=0,r=e.holes.length;t<r;t++){var o=e.holes[t];this.holes.push((new xl).fromJSON(o))}return this}}]),n}(xl),_l=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(x.a)(this,n),(r=t.call(this)).type="Light",r.color=new cn(e),r.intensity=o,r}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.color.copy(source.color),this.intensity=source.intensity,this}},{key:"toJSON",value:function(meta){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this,meta);return data.object.color=this.color.getHex(),data.object.intensity=this.intensity,void 0!==this.groundColor&&(data.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(data.object.distance=this.distance),void 0!==this.angle&&(data.object.angle=this.angle),void 0!==this.decay&&(data.object.decay=this.decay),void 0!==this.penumbra&&(data.object.penumbra=this.penumbra),void 0!==this.shadow&&(data.object.shadow=this.shadow.toJSON()),data}}]),n}(zt);_l.prototype.isLight=!0;var wl=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r,o){var l;return Object(x.a)(this,n),(l=t.call(this,e,o)).type="HemisphereLight",l.position.copy(zt.DefaultUp),l.updateMatrix(),l.groundColor=new cn(r),l}return Object(_.a)(n,[{key:"copy",value:function(source){return _l.prototype.copy.call(this,source),this.groundColor.copy(source.groundColor),this}}]),n}(_l);wl.prototype.isHemisphereLight=!0;var Ml=new pt,Sl=new Ie,El=new Ie,Tl=function(){function e(t){Object(x.a)(this,e),this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.mapSize=new Se(512,512),this.map=null,this.mapPass=null,this.matrix=new pt,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new pi,this._frameExtents=new Se(1,1),this._viewportCount=1,this._viewports=[new ke(0,0,1,1)]}return Object(_.a)(e,[{key:"getViewportCount",value:function(){return this._viewportCount}},{key:"getFrustum",value:function(){return this._frustum}},{key:"updateMatrices",value:function(e){var t=this.camera,n=this.matrix;Sl.setFromMatrixPosition(e.matrixWorld),t.position.copy(Sl),El.setFromMatrixPosition(e.target.matrixWorld),t.lookAt(El),t.updateMatrixWorld(),Ml.multiplyMatrices(t.projectionMatrix,t.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Ml),n.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),n.multiply(t.projectionMatrix),n.multiply(t.matrixWorldInverse)}},{key:"getViewport",value:function(e){return this._viewports[e]}},{key:"getFrameExtents",value:function(){return this._frameExtents}},{key:"copy",value:function(source){return this.camera=source.camera.clone(),this.bias=source.bias,this.radius=source.radius,this.mapSize.copy(source.mapSize),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"toJSON",value:function(){var object={};return 0!==this.bias&&(object.bias=this.bias),0!==this.normalBias&&(object.normalBias=this.normalBias),1!==this.radius&&(object.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(object.mapSize=this.mapSize.toArray()),object.camera=this.camera.toJSON(!1).object,delete object.camera.matrix,object}}]),e}(),Cl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e;return Object(x.a)(this,n),(e=t.call(this,new ri(50,1,.5,500))).focus=1,e}return Object(_.a)(n,[{key:"updateMatrices",value:function(e){var t=this.camera,r=2*Me.RAD2DEG*e.angle*this.focus,o=this.mapSize.width/this.mapSize.height,l=e.distance||t.far;r===t.fov&&o===t.aspect&&l===t.far||(t.fov=r,t.aspect=o,t.far=l,t.updateProjectionMatrix()),d(Object(c.a)(n.prototype),"updateMatrices",this).call(this,e)}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.focus=source.focus,this}}]),n}(Tl);Cl.prototype.isSpotLightShadow=!0;var Ll=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Math.PI/3,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1;return Object(x.a)(this,n),(o=t.call(this,e,r)).type="SpotLight",o.position.copy(zt.DefaultUp),o.updateMatrix(),o.target=new zt,o.distance=l,o.angle=c,o.penumbra=h,o.decay=d,o.shadow=new Cl,o}return Object(_.a)(n,[{key:"power",get:function(){return this.intensity*Math.PI},set:function(e){this.intensity=e/Math.PI}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.distance=source.distance,this.angle=source.angle,this.penumbra=source.penumbra,this.decay=source.decay,this.target=source.target.clone(),this.shadow=source.shadow.clone(),this}}]),n}(_l);Ll.prototype.isSpotLight=!0;var Al=new pt,Rl=new Ie,kl=new Ie,Pl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e;return Object(x.a)(this,n),(e=t.call(this,new ri(90,1,.5,500)))._frameExtents=new Se(4,2),e._viewportCount=6,e._viewports=[new ke(2,1,1,1),new ke(0,1,1,1),new ke(3,1,1,1),new ke(1,1,1,1),new ke(3,0,1,1),new ke(1,0,1,1)],e._cubeDirections=[new Ie(1,0,0),new Ie(-1,0,0),new Ie(0,0,1),new Ie(0,0,-1),new Ie(0,1,0),new Ie(0,-1,0)],e._cubeUps=[new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,1,0),new Ie(0,0,1),new Ie(0,0,-1)],e}return Object(_.a)(n,[{key:"updateMatrices",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.camera,r=this.matrix,o=e.distance||n.far;o!==n.far&&(n.far=o,n.updateProjectionMatrix()),Rl.setFromMatrixPosition(e.matrixWorld),n.position.copy(Rl),kl.copy(n.position),kl.add(this._cubeDirections[t]),n.up.copy(this._cubeUps[t]),n.lookAt(kl),n.updateMatrixWorld(),r.makeTranslation(-Rl.x,-Rl.y,-Rl.z),Al.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(Al)}}]),n}(Tl);Pl.prototype.isPointLightShadow=!0;var Ol=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;return Object(x.a)(this,n),(o=t.call(this,e,r)).type="PointLight",o.distance=l,o.decay=c,o.shadow=new Pl,o}return Object(_.a)(n,[{key:"power",get:function(){return 4*this.intensity*Math.PI},set:function(e){this.intensity=e/(4*Math.PI)}},{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.distance=source.distance,this.decay=source.decay,this.shadow=source.shadow.clone(),this}}]),n}(_l);Ol.prototype.isPointLight=!0;var Il=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,h=arguments.length>4&&void 0!==arguments[4]?arguments[4]:.1,d=arguments.length>5&&void 0!==arguments[5]?arguments[5]:2e3;return Object(x.a)(this,n),(e=t.call(this)).type="OrthographicCamera",e.zoom=1,e.view=null,e.left=r,e.right=o,e.top=l,e.bottom=c,e.near=h,e.far=d,e.updateProjectionMatrix(),e}return Object(_.a)(n,[{key:"copy",value:function(source,e){return d(Object(c.a)(n.prototype),"copy",this).call(this,source,e),this.left=source.left,this.right=source.right,this.top=source.top,this.bottom=source.bottom,this.near=source.near,this.far=source.far,this.zoom=source.zoom,this.view=null===source.view?null:Object.assign({},source.view),this}},{key:"setViewOffset",value:function(e,t,n,r,o,l){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=t,this.view.offsetX=n,this.view.offsetY=r,this.view.width=o,this.view.height=l,this.updateProjectionMatrix()}},{key:"clearViewOffset",value:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}},{key:"updateProjectionMatrix",value:function(){var e=(this.right-this.left)/(2*this.zoom),t=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,o=n-e,l=n+e,c=r+t,h=r-t;if(null!==this.view&&this.view.enabled){var d=(this.right-this.left)/this.view.fullWidth/this.zoom,f=(this.top-this.bottom)/this.view.fullHeight/this.zoom;l=(o+=d*this.view.offsetX)+d*this.view.width,h=(c-=f*this.view.offsetY)-f*this.view.height}this.projectionMatrix.makeOrthographic(o,l,c,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}},{key:"toJSON",value:function(meta){var data=zt.prototype.toJSON.call(this,meta);return data.object.zoom=this.zoom,data.object.left=this.left,data.object.right=this.right,data.object.top=this.top,data.object.bottom=this.bottom,data.object.near=this.near,data.object.far=this.far,null!==this.view&&(data.object.view=Object.assign({},this.view)),data}}]),n}(ii);Il.prototype.isOrthographicCamera=!0;var Dl=function(e){Object(v.a)(n,e);var t=S(n);function n(){return Object(x.a)(this,n),t.call(this,new Il(-5,5,5,-5,.5,500))}return Object(_.a)(n)}(Tl);Dl.prototype.isDirectionalLightShadow=!0;var Nl=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o;return Object(x.a)(this,n),(o=t.call(this,e,r)).type="DirectionalLight",o.position.copy(zt.DefaultUp),o.updateMatrix(),o.target=new zt,o.shadow=new Dl,o}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.target=source.target.clone(),this.shadow=source.shadow.clone(),this}}]),n}(_l);Nl.prototype.isDirectionalLight=!0;var Hl=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o;return Object(x.a)(this,n),(o=t.call(this,e,r)).type="AmbientLight",o}return Object(_.a)(n)}(_l);Hl.prototype.isAmbientLight=!0;var zl=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10;return Object(x.a)(this,n),(o=t.call(this,e,r)).type="RectAreaLight",o.width=l,o.height=c,o}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.width=source.width,this.height=source.height,this}},{key:"toJSON",value:function(meta){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this,meta);return data.object.width=this.width,data.object.height=this.height,data}}]),n}(_l);zl.prototype.isRectAreaLight=!0;var Fl=function(){function e(){Object(x.a)(this,e),this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new Ie)}return Object(_.a)(e,[{key:"set",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].copy(e[t]);return this}},{key:"zero",value:function(){for(var e=0;e<9;e++)this.coefficients[e].set(0,0,0);return this}},{key:"getAt",value:function(e,t){var n=e.x,r=e.y,o=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.282095),t.addScaledVector(l[1],.488603*r),t.addScaledVector(l[2],.488603*o),t.addScaledVector(l[3],.488603*n),t.addScaledVector(l[4],n*r*1.092548),t.addScaledVector(l[5],r*o*1.092548),t.addScaledVector(l[6],.315392*(3*o*o-1)),t.addScaledVector(l[7],n*o*1.092548),t.addScaledVector(l[8],.546274*(n*n-r*r)),t}},{key:"getIrradianceAt",value:function(e,t){var n=e.x,r=e.y,o=e.z,l=this.coefficients;return t.copy(l[0]).multiplyScalar(.886227),t.addScaledVector(l[1],1.023328*r),t.addScaledVector(l[2],1.023328*o),t.addScaledVector(l[3],1.023328*n),t.addScaledVector(l[4],.858086*n*r),t.addScaledVector(l[5],.858086*r*o),t.addScaledVector(l[6],.743125*o*o-.247708),t.addScaledVector(l[7],.858086*n*o),t.addScaledVector(l[8],.429043*(n*n-r*r)),t}},{key:"add",value:function(e){for(var t=0;t<9;t++)this.coefficients[t].add(e.coefficients[t]);return this}},{key:"addScaledSH",value:function(e,s){for(var t=0;t<9;t++)this.coefficients[t].addScaledVector(e.coefficients[t],s);return this}},{key:"scale",value:function(s){for(var e=0;e<9;e++)this.coefficients[e].multiplyScalar(s);return this}},{key:"lerp",value:function(e,t){for(var n=0;n<9;n++)this.coefficients[n].lerp(e.coefficients[n],t);return this}},{key:"equals",value:function(e){for(var t=0;t<9;t++)if(!this.coefficients[t].equals(e.coefficients[t]))return!1;return!0}},{key:"copy",value:function(e){return this.set(e.coefficients)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"fromArray",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].fromArray(e,t+3*r);return this}},{key:"toArray",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.coefficients,r=0;r<9;r++)n[r].toArray(e,t+3*r);return e}}],[{key:"getBasisAt",value:function(e,t){var n=e.x,r=e.y,o=e.z;t[0]=.282095,t[1]=.488603*r,t[2]=.488603*o,t[3]=.488603*n,t[4]=1.092548*n*r,t[5]=1.092548*r*o,t[6]=.315392*(3*o*o-1),t[7]=1.092548*n*o,t[8]=.546274*(n*n-r*r)}}]),e}();Fl.prototype.isSphericalHarmonics3=!0;var Bl=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Fl,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(x.a)(this,n),(e=t.call(this,void 0,o)).sh=r,e}return Object(_.a)(n,[{key:"copy",value:function(source){return d(Object(c.a)(n.prototype),"copy",this).call(this,source),this.sh.copy(source.sh),this}},{key:"fromJSON",value:function(e){return this.intensity=e.intensity,this.sh.fromArray(e.sh),this}},{key:"toJSON",value:function(meta){var data=d(Object(c.a)(n.prototype),"toJSON",this).call(this,meta);return data.object.sh=this.sh.toArray(),data}}]),n}(_l);Bl.prototype.isLightProbe=!0;var Ul=function(e){if("undefined"!=typeof TextDecoder)return(new TextDecoder).decode(e);for(var s="",t=0,n=e.length;t<n;t++)s+=String.fromCharCode(e[t]);try{return decodeURIComponent(escape(s))}catch(e){return s}},jl=function(e){var t=e.lastIndexOf("/");return-1===t?"./":e.substr(0,t+1)};function Gl(){Pn.call(this),this.type="InstancedBufferGeometry",this.instanceCount=1/0}function Vl(e,t,n,r){"number"==typeof n&&(r=n,n=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),pn.call(this,e,t,n),this.meshPerAttribute=r||1}Gl.prototype=Object.assign(Object.create(Pn.prototype),{constructor:Gl,isInstancedBufferGeometry:!0,copy:function(source){return Pn.prototype.copy.call(this,source),this.instanceCount=source.instanceCount,this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var data=Pn.prototype.toJSON.call(this);return data.instanceCount=this.instanceCount,data.isInstancedBufferGeometry=!0,data}}),Vl.prototype=Object.assign(Object.create(pn.prototype),{constructor:Vl,isInstancedBufferAttribute:!0,copy:function(source){return pn.prototype.copy.call(this,source),this.meshPerAttribute=source.meshPerAttribute,this},toJSON:function(){var data=pn.prototype.toJSON.call(this);return data.meshPerAttribute=this.meshPerAttribute,data.isInstancedBufferAttribute=!0,data}});function Wl(e){"undefined"==typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"==typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),Us.call(this,e),this.options={premultiplyAlpha:"none"}}Wl.prototype=Object.assign(Object.create(Us.prototype),{constructor:Wl,isImageBitmapLoader:!0,setOptions:function(e){return this.options=e,this},load:function(e,t,n,r){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);var o=this,l=zs.get(e);if(void 0!==l)return o.manager.itemStart(e),setTimeout((function(){t&&t(l),o.manager.itemEnd(e)}),0),l;var c={};c.credentials="anonymous"===this.crossOrigin?"same-origin":"include",c.headers=this.requestHeader,fetch(e,c).then((function(e){return e.blob()})).then((function(e){return createImageBitmap(e,Object.assign(o.options,{colorSpaceConversion:"none"}))})).then((function(n){zs.add(e,n),t&&t(n),o.manager.itemEnd(e)})).catch((function(t){r&&r(t),o.manager.itemError(e),o.manager.itemEnd(e)})),o.manager.itemStart(e)}});var ql=function(){function e(){Object(x.a)(this,e),this.type="ShapePath",this.color=new cn,this.subPaths=[],this.currentPath=null}return Object(_.a)(e,[{key:"moveTo",value:function(e,t){return this.currentPath=new xl,this.subPaths.push(this.currentPath),this.currentPath.moveTo(e,t),this}},{key:"lineTo",value:function(e,t){return this.currentPath.lineTo(e,t),this}},{key:"quadraticCurveTo",value:function(e,t,n,r){return this.currentPath.quadraticCurveTo(e,t,n,r),this}},{key:"bezierCurveTo",value:function(e,t,n,r,o,l){return this.currentPath.bezierCurveTo(e,t,n,r,o,l),this}},{key:"splineThru",value:function(e){return this.currentPath.splineThru(e),this}},{key:"toShapes",value:function(e,t){function n(e){for(var t=[],n=0,r=e.length;n<r;n++){var o=e[n],l=new bl;l.curves=o.curves,t.push(l)}return t}function r(e,t){for(var n=t.length,r=!1,p=n-1,q=0;q<n;p=q++){var o=t[p],l=t[q],c=l.x-o.x,h=l.y-o.y;if(Math.abs(h)>Number.EPSILON){if(h<0&&(o=t[q],c=-c,l=t[p],h=-h),e.y<o.y||e.y>l.y)continue;if(e.y===o.y){if(e.x===o.x)return!0}else{var d=h*(e.x-o.x)-c*(e.y-o.y);if(0===d)return!0;if(d<0)continue;r=!r}}else{if(e.y!==o.y)continue;if(l.x<=e.x&&e.x<=o.x||o.x<=e.x&&e.x<=l.x)return!0}}return r}var o,l,c,h=os.isClockWise,d=this.subPaths;if(0===d.length)return[];if(!0===t)return n(d);var f=[];if(1===d.length)return l=d[0],(c=new bl).curves=l.curves,f.push(c),f;var m=!h(d[0].getPoints());m=e?!m:m;var v,y,x=[],_=[],w=[],M=0;_[M]=void 0,w[M]=[];for(var S=0,E=d.length;S<E;S++)o=h(v=(l=d[S]).getPoints()),(o=e?!o:o)?(!m&&_[M]&&M++,_[M]={s:new bl,p:v},_[M].s.curves=l.curves,m&&M++,w[M]=[]):w[M].push({h:l,p:v[0]});if(!_[0])return n(d);if(_.length>1){for(var T=!1,C=[],L=0,A=_.length;L<A;L++)x[L]=[];for(var R=0,k=_.length;R<k;R++)for(var P=w[R],O=0;O<P.length;O++){for(var I=P[O],D=!0,N=0;N<_.length;N++)r(I.p,_[N].p)&&(R!==N&&C.push({froms:R,tos:N,hole:O}),D?(D=!1,x[N].push(I)):T=!0);D&&x[R].push(I)}C.length>0&&(T||(w=x))}for(var H=0,z=_.length;H<z;H++){c=_[H].s,f.push(c);for(var F=0,B=(y=w[H]).length;F<B;F++)c.holes.push(y[F].h)}return f}}]),e}(),Xl=function(){function e(data){Object(x.a)(this,e),this.type="Font",this.data=data}return Object(_.a)(e,[{key:"generateShapes",value:function(text){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,t=[],n=Yl(text,e,this.data),p=0,r=n.length;p<r;p++)Array.prototype.push.apply(t,n[p].toShapes());return t}}]),e}();function Yl(text,e,data){for(var t=Array.from(text),n=e/data.resolution,r=(data.boundingBox.yMax-data.boundingBox.yMin+data.underlineThickness)*n,o=[],l=0,c=0,h=0;h<t.length;h++){var d=t[h];if("\n"===d)l=0,c-=r;else{var f=Zl(d,n,l,c,data);l+=f.offsetX,o.push(f.path)}}return o}function Zl(e,t,n,r,data){var glyph=data.glyphs[e]||data.glyphs["?"];if(glyph){var o,l,c,h,d,f,m,v,path=new ql;if(glyph.o)for(var y=glyph._cachedOutline||(glyph._cachedOutline=glyph.o.split(" ")),x=0,_=y.length;x<_;){switch(y[x++]){case"m":o=y[x++]*t+n,l=y[x++]*t+r,path.moveTo(o,l);break;case"l":o=y[x++]*t+n,l=y[x++]*t+r,path.lineTo(o,l);break;case"q":c=y[x++]*t+n,h=y[x++]*t+r,d=y[x++]*t+n,f=y[x++]*t+r,path.quadraticCurveTo(d,f,c,h);break;case"b":c=y[x++]*t+n,h=y[x++]*t+r,d=y[x++]*t+n,f=y[x++]*t+r,m=y[x++]*t+n,v=y[x++]*t+r,path.bezierCurveTo(d,f,m,v,c,h)}}return{offsetX:glyph.ha*t,path:path}}console.error('THREE.Font: character "'+e+'" does not exists in font family '+data.familyName+".")}Xl.prototype.isFont=!0;var Jl,$l=function(){return void 0===Jl&&(Jl=new(window.AudioContext||window.webkitAudioContext)),Jl},Kl=function(e){Object(v.a)(n,e);var t=S(n);function n(e){return Object(x.a)(this,n),t.call(this,e)}return Object(_.a)(n,[{key:"load",value:function(e,t,n,r){var o=this,l=new Gs(this.manager);l.setResponseType("arraybuffer"),l.setPath(this.path),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,(function(n){try{var l=n.slice(0);$l().decodeAudioData(l,(function(e){t(e)}))}catch(t){r?r(t):console.error(t),o.manager.itemError(e)}}),n,r)}}]),n}(Us),Ql=function(e){Object(v.a)(n,e);var t=S(n);function n(e,r){var o,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;Object(x.a)(this,n),o=t.call(this,void 0,l);var c=(new cn).set(e),h=(new cn).set(r),d=new Ie(c.r,c.g,c.b),f=new Ie(h.r,h.g,h.b),m=Math.sqrt(Math.PI),v=m*Math.sqrt(.75);return o.sh.coefficients[0].copy(d).add(f).multiplyScalar(m),o.sh.coefficients[1].copy(d).sub(f).multiplyScalar(v),o}return Object(_.a)(n)}(Bl);Ql.prototype.isHemisphereLightProbe=!0;var ec=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;Object(x.a)(this,n),r=t.call(this,void 0,o);var l=(new cn).set(e);return r.sh.coefficients[0].set(l.r,l.g,l.b).multiplyScalar(2*Math.sqrt(Math.PI)),r}return Object(_.a)(n)}(Bl);ec.prototype.isAmbientLightProbe=!0;new pt,new pt;var tc=function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this)).type="Audio",r.listener=e,r.context=e.context,r.gain=r.context.createGain(),r.gain.connect(e.getInput()),r.autoplay=!1,r.buffer=null,r.detune=0,r.loop=!1,r.loopStart=0,r.loopEnd=0,r.offset=0,r.duration=void 0,r.playbackRate=1,r.isPlaying=!1,r.hasPlaybackControl=!0,r.source=null,r.sourceType="empty",r._startedAt=0,r._progress=0,r._connected=!1,r.filters=[],r}return Object(_.a)(n,[{key:"getOutput",value:function(){return this.gain}},{key:"setNodeSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=e,this.connect(),this}},{key:"setMediaElementSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(e),this.connect(),this}},{key:"setMediaStreamSource",value:function(e){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(e),this.connect(),this}},{key:"setBuffer",value:function(e){return this.buffer=e,this.sourceType="buffer",this.autoplay&&this.play(),this}},{key:"play",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!0!==this.isPlaying){if(!1!==this.hasPlaybackControl){this._startedAt=this.context.currentTime+e;var source=this.context.createBufferSource();return source.buffer=this.buffer,source.loop=this.loop,source.loopStart=this.loopStart,source.loopEnd=this.loopEnd,source.onended=this.onEnded.bind(this),source.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=source,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}console.warn("THREE.Audio: this Audio has no playback control.")}else console.warn("THREE.Audio: Audio is already playing.")}},{key:"pause",value:function(){if(!1!==this.hasPlaybackControl)return!0===this.isPlaying&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,!0===this.loop&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"stop",value:function(){if(!1!==this.hasPlaybackControl)return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"connect",value:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].connect(this.filters[e]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}},{key:"disconnect",value:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var e=1,t=this.filters.length;e<t;e++)this.filters[e-1].disconnect(this.filters[e]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}},{key:"getFilters",value:function(){return this.filters}},{key:"setFilters",value:function(e){return e||(e=[]),!0===this._connected?(this.disconnect(),this.filters=e.slice(),this.connect()):this.filters=e.slice(),this}},{key:"setDetune",value:function(e){if(this.detune=e,void 0!==this.source.detune)return!0===this.isPlaying&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}},{key:"getDetune",value:function(){return this.detune}},{key:"getFilter",value:function(){return this.getFilters()[0]}},{key:"setFilter",value:function(filter){return this.setFilters(filter?[filter]:[])}},{key:"setPlaybackRate",value:function(e){if(!1!==this.hasPlaybackControl)return this.playbackRate=e,!0===this.isPlaying&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"getPlaybackRate",value:function(){return this.playbackRate}},{key:"onEnded",value:function(){this.isPlaying=!1}},{key:"getLoop",value:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}},{key:"setLoop",value:function(e){if(!1!==this.hasPlaybackControl)return this.loop=e,!0===this.isPlaying&&(this.source.loop=this.loop),this;console.warn("THREE.Audio: this Audio has no playback control.")}},{key:"setLoopStart",value:function(e){return this.loopStart=e,this}},{key:"setLoopEnd",value:function(e){return this.loopEnd=e,this}},{key:"getVolume",value:function(){return this.gain.gain.value}},{key:"setVolume",value:function(e){return this.gain.gain.setTargetAtTime(e,this.context.currentTime,.01),this}}]),n}(zt),nc=function(){function e(audio){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2048;Object(x.a)(this,e),this.analyser=audio.context.createAnalyser(),this.analyser.fftSize=t,this.data=new Uint8Array(this.analyser.frequencyBinCount),audio.getOutput().connect(this.analyser)}return Object(_.a)(e,[{key:"getFrequencyData",value:function(){return this.analyser.getByteFrequencyData(this.data),this.data}},{key:"getAverageFrequency",value:function(){for(var e=0,data=this.getFrequencyData(),t=0;t<data.length;t++)e+=data[t];return e/data.length}}]),e}(),ic=function(){function e(t,n,r){var o,l,c;switch(Object(x.a)(this,e),this.binding=t,this.valueSize=r,n){case"quaternion":o=this._slerp,l=this._slerpAdditive,c=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":o=this._select,l=this._select,c=this._setAdditiveIdentityOther,this.buffer=new Array(5*r);break;default:o=this._lerp,l=this._lerpAdditive,c=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=o,this._mixBufferRegionAdditive=l,this._setIdentity=c,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}return Object(_.a)(e,[{key:"accumulate",value:function(e,t){var n=this.buffer,r=this.valueSize,o=e*r+r,l=this.cumulativeWeight;if(0===l){for(var c=0;c!==r;++c)n[o+c]=n[c];l=t}else{var h=t/(l+=t);this._mixBufferRegion(n,o,0,h,r)}this.cumulativeWeight=l}},{key:"accumulateAdditive",value:function(e){var t=this.buffer,n=this.valueSize,r=n*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(t,r,0,e,n),this.cumulativeWeightAdditive+=e}},{key:"apply",value:function(e){var t=this.valueSize,n=this.buffer,r=e*t+t,o=this.cumulativeWeight,l=this.cumulativeWeightAdditive,c=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,o<1){var h=t*this._origIndex;this._mixBufferRegion(n,r,h,1-o,t)}l>0&&this._mixBufferRegionAdditive(n,r,this._addIndex*t,1,t);for(var d=t,f=t+t;d!==f;++d)if(n[d]!==n[d+t]){c.setValue(n,r);break}}},{key:"saveOriginalState",value:function(){var e=this.binding,t=this.buffer,n=this.valueSize,r=n*this._origIndex;e.getValue(t,r);for(var o=n,l=r;o!==l;++o)t[o]=t[r+o%n];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}},{key:"restoreOriginalState",value:function(){var e=3*this.valueSize;this.binding.setValue(this.buffer,e)}},{key:"_setAdditiveIdentityNumeric",value:function(){for(var e=this._addIndex*this.valueSize,t=e+this.valueSize,n=e;n<t;n++)this.buffer[n]=0}},{key:"_setAdditiveIdentityQuaternion",value:function(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}},{key:"_setAdditiveIdentityOther",value:function(){for(var e=this._origIndex*this.valueSize,t=this._addIndex*this.valueSize,n=0;n<this.valueSize;n++)this.buffer[t+n]=this.buffer[e+n]}},{key:"_select",value:function(e,t,n,r,o){if(r>=.5)for(var l=0;l!==o;++l)e[t+l]=e[n+l]}},{key:"_slerp",value:function(e,t,n,r){Oe.slerpFlat(e,t,e,t,e,n,r)}},{key:"_slerpAdditive",value:function(e,t,n,r,o){var l=this._workIndex*o;Oe.multiplyQuaternionsFlat(e,l,e,t,e,n),Oe.slerpFlat(e,t,e,t,e,l,r)}},{key:"_lerp",value:function(e,t,n,r,o){for(var s=1-r,l=0;l!==o;++l){var c=t+l;e[c]=e[c]*s+e[n+l]*r}}},{key:"_lerpAdditive",value:function(e,t,n,r,o){for(var l=0;l!==o;++l){var c=t+l;e[c]=e[c]+e[n+l]*r}}}]),e}(),rc="\\[\\]\\.:\\/",ac=new RegExp("[\\[\\]\\.:\\/]","g"),oc="[^\\[\\]\\.:\\/]",sc="[^"+rc.replace("\\.","")+"]",lc=/((?:WC+[\/:])*)/.source.replace("WC",oc),cc=/(WCOD+)?/.source.replace("WCOD",sc),uc=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",oc),hc=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",oc),dc=new RegExp("^"+lc+cc+uc+hc+"$"),pc=["material","materials","bones"];function fc(e,path,t){var n=t||mc.parseTrackName(path);this._targetGroup=e,this._bindings=e.subscribe_(path,n)}function mc(e,path,t){this.path=path,this.parsedPath=t||mc.parseTrackName(path),this.node=mc.findNode(e,this.parsedPath.nodeName)||e,this.rootNode=e}Object.assign(fc.prototype,{getValue:function(e,t){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(e,t)},setValue:function(e,t){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,o=n.length;r!==o;++r)n[r].setValue(e,t)},bind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].bind()},unbind:function(){for(var e=this._bindings,t=this._targetGroup.nCachedObjects_,n=e.length;t!==n;++t)e[t].unbind()}}),Object.assign(mc,{Composite:fc,create:function(e,path,t){return e&&e.isAnimationObjectGroup?new mc.Composite(e,path,t):new mc(e,path,t)},sanitizeNodeName:function(e){return e.replace(/\s/g,"_").replace(ac,"")},parseTrackName:function(e){var t=dc.exec(e);if(!t)throw new Error("PropertyBinding: Cannot parse trackName: "+e);var n={nodeName:t[2],objectName:t[3],objectIndex:t[4],propertyName:t[5],propertyIndex:t[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var o=n.nodeName.substring(r+1);-1!==pc.indexOf(o)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=o)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+e);return n},findNode:function(e,t){if(!t||""===t||"."===t||-1===t||t===e.name||t===e.uuid)return e;if(e.skeleton){var n=e.skeleton.getBoneByName(t);if(void 0!==n)return n}if(e.children){var r=function e(n){for(var r=0;r<n.length;r++){var o=n[r];if(o.name===t||o.uuid===t)return o;var l=e(o.children);if(l)return l}return null}(e.children);if(r)return r}return null}}),Object.assign(mc.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(e,t){e[t]=this.node[this.propertyName]},function(e,t){for(var source=this.resolvedProperty,n=0,r=source.length;n!==r;++n)e[t++]=source[n]},function(e,t){e[t]=this.resolvedProperty[this.propertyIndex]},function(e,t){this.resolvedProperty.toArray(e,t)}],SetterByBindingTypeAndVersioning:[[function(e,t){this.targetObject[this.propertyName]=e[t]},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.targetObject[this.propertyName]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){for(var n=this.resolvedProperty,r=0,o=n.length;r!==o;++r)n[r]=e[t++]},function(e,t){for(var n=this.resolvedProperty,r=0,o=n.length;r!==o;++r)n[r]=e[t++];this.targetObject.needsUpdate=!0},function(e,t){for(var n=this.resolvedProperty,r=0,o=n.length;r!==o;++r)n[r]=e[t++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty[this.propertyIndex]=e[t]},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty[this.propertyIndex]=e[t],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(e,t){this.resolvedProperty.fromArray(e,t)},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.needsUpdate=!0},function(e,t){this.resolvedProperty.fromArray(e,t),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(e,t){this.bind(),this.getValue(e,t)},setValue:function(e,t){this.bind(),this.setValue(e,t)},bind:function(){var e=this.node,t=this.parsedPath,n=t.objectName,r=t.propertyName,o=t.propertyIndex;if(e||(e=mc.findNode(this.rootNode,t.nodeName)||this.rootNode,this.node=e),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,e){if(n){var l=t.objectIndex;switch(n){case"materials":if(!e.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!e.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);e=e.material.materials;break;case"bones":if(!e.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);e=e.skeleton.bones;for(var c=0;c<e.length;c++)if(e[c].name===l){l=c;break}break;default:if(void 0===e[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);e=e[n]}if(void 0!==l){if(void 0===e[l])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,e);e=e[l]}}var h=e[r];if(void 0!==h){var d=this.Versioning.None;this.targetObject=e,void 0!==e.needsUpdate?d=this.Versioning.NeedsUpdate:void 0!==e.matrixWorldNeedsUpdate&&(d=this.Versioning.MatrixWorldNeedsUpdate);var f=this.BindingType.Direct;if(void 0!==o){if("morphTargetInfluences"===r){if(!e.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(!e.geometry.isBufferGeometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);if(!e.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);void 0!==e.morphTargetDictionary[o]&&(o=e.morphTargetDictionary[o])}f=this.BindingType.ArrayElement,this.resolvedProperty=h,this.propertyIndex=o}else void 0!==h.fromArray&&void 0!==h.toArray?(f=this.BindingType.HasFromToArray,this.resolvedProperty=h):Array.isArray(h)?(f=this.BindingType.EntireArray,this.resolvedProperty=h):this.propertyName=r;this.getValue=this.GetterByBindingType[f],this.setValue=this.SetterByBindingTypeAndVersioning[f][d]}else{var m=t.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+m+"."+r+" but it wasn't found.",e)}}else console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.")},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(mc.prototype,{_getValue_unbound:mc.prototype.getValue,_setValue_unbound:mc.prototype.setValue});var vc=function(){function e(){Object(x.a)(this,e),this.uuid=Me.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var n=0,r=arguments.length;n!==r;++n)t[arguments[n].uuid]=n;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var o=this;this.stats={objects:{get total(){return o._objects.length},get inUse(){return this.total-o.nCachedObjects_}},get bindingsPerObject(){return o._bindings.length}}}return Object(_.a)(e,[{key:"add",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._paths,r=this._parsedPaths,o=this._bindings,l=o.length,c=void 0,h=e.length,d=this.nCachedObjects_,f=0,m=arguments.length;f!==m;++f){var object=arguments[f],v=object.uuid,y=t[v];if(void 0===y){y=h++,t[v]=y,e.push(object);for(var x=0,_=l;x!==_;++x)o[x].push(new mc(object,n[x],r[x]))}else if(y<d){c=e[y];var w=--d,M=e[w];t[M.uuid]=y,e[y]=M,t[v]=w,e[w]=object;for(var S=0,E=l;S!==E;++S){var T=o[S],C=T[w],L=T[y];T[y]=C,void 0===L&&(L=new mc(object,n[S],r[S])),T[w]=L}}else e[y]!==c&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=d}},{key:"remove",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,o=this.nCachedObjects_,l=0,c=arguments.length;l!==c;++l){var object=arguments[l],h=object.uuid,d=t[h];if(void 0!==d&&d>=o){var f=o++,m=e[f];t[m.uuid]=d,e[d]=m,t[h]=f,e[f]=object;for(var v=0,y=r;v!==y;++v){var x=n[v],_=x[f],w=x[d];x[d]=_,x[f]=w}}}this.nCachedObjects_=o}},{key:"uncache",value:function(){for(var e=this._objects,t=this._indicesByUUID,n=this._bindings,r=n.length,o=this.nCachedObjects_,l=e.length,c=0,h=arguments.length;c!==h;++c){var object=arguments[c],d=object.uuid,f=t[d];if(void 0!==f)if(delete t[d],f<o){var m=--o,v=e[m],y=--l,x=e[y];t[v.uuid]=f,e[f]=v,t[x.uuid]=m,e[m]=x,e.pop();for(var _=0,w=r;_!==w;++_){var M=n[_],S=M[m],E=M[y];M[f]=S,M[m]=E,M.pop()}}else{var T=--l,C=e[T];T>0&&(t[C.uuid]=f),e[f]=C,e.pop();for(var L=0,A=r;L!==A;++L){var R=n[L];R[f]=R[T],R.pop()}}}this.nCachedObjects_=o}},{key:"subscribe_",value:function(path,e){var t=this._bindingsIndicesByPath,n=t[path],r=this._bindings;if(void 0!==n)return r[n];var o=this._paths,l=this._parsedPaths,c=this._objects,h=c.length,d=this.nCachedObjects_,f=new Array(h);n=r.length,t[path]=n,o.push(path),l.push(e),r.push(f);for(var m=d,v=c.length;m!==v;++m){var object=c[m];f[m]=new mc(object,path,e)}return f}},{key:"unsubscribe_",value:function(path){var e=this._bindingsIndicesByPath,t=e[path];if(void 0!==t){var n=this._paths,r=this._parsedPaths,o=this._bindings,l=o.length-1,c=o[l];e[path[l]]=t,o[t]=c,o.pop(),r[t]=r[l],r.pop(),n[t]=n[l],n.pop()}}}]),e}();vc.prototype.isAnimationObjectGroup=!0;var gc=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n.blendMode;Object(x.a)(this,e),this._mixer=t,this._clip=n,this._localRoot=r,this.blendMode=o;for(var l=n.tracks,c=l.length,h=new Array(c),d={endingStart:oe,endingEnd:oe},f=0;f!==c;++f){var m=l[f].createInterpolant(null);h[f]=m,m.settings=d}this._interpolantSettings=d,this._interpolants=h,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}return Object(_.a)(e,[{key:"play",value:function(){return this._mixer._activateAction(this),this}},{key:"stop",value:function(){return this._mixer._deactivateAction(this),this.reset()}},{key:"reset",value:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}},{key:"isRunning",value:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}},{key:"isScheduled",value:function(){return this._mixer._isActiveAction(this)}},{key:"startAt",value:function(time){return this._startTime=time,this}},{key:"setLoop",value:function(e,t){return this.loop=e,this.repetitions=t,this}},{key:"setEffectiveWeight",value:function(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}},{key:"getEffectiveWeight",value:function(){return this._effectiveWeight}},{key:"fadeIn",value:function(e){return this._scheduleFading(e,0,1)}},{key:"fadeOut",value:function(e){return this._scheduleFading(e,1,0)}},{key:"crossFadeFrom",value:function(e,t,n){if(e.fadeOut(t),this.fadeIn(t),n){var r=this._clip.duration,o=e._clip.duration,l=o/r,c=r/o;e.warp(1,l,t),this.warp(c,1,t)}return this}},{key:"crossFadeTo",value:function(e,t,n){return e.crossFadeFrom(this,t,n)}},{key:"stopFading",value:function(){var e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"setEffectiveTimeScale",value:function(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}},{key:"getEffectiveTimeScale",value:function(){return this._effectiveTimeScale}},{key:"setDuration",value:function(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}},{key:"syncWith",value:function(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}},{key:"halt",value:function(e){return this.warp(this._effectiveTimeScale,0,e)}},{key:"warp",value:function(e,t,n){var r=this._mixer,o=r.time,l=this.timeScale,c=this._timeScaleInterpolant;null===c&&(c=r._lendControlInterpolant(),this._timeScaleInterpolant=c);var h=c.parameterPositions,d=c.sampleValues;return h[0]=o,h[1]=o+n,d[0]=e/l,d[1]=t/l,this}},{key:"stopWarping",value:function(){var e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}},{key:"getMixer",value:function(){return this._mixer}},{key:"getClip",value:function(){return this._clip}},{key:"getRoot",value:function(){return this._localRoot||this._mixer._root}},{key:"_update",value:function(time,e,t,n){if(this.enabled){var r=this._startTime;if(null!==r){var o=(time-r)*t;if(o<0||0===t)return;this._startTime=null,e=t*o}e*=this._updateTimeScale(time);var l=this._updateTime(e),c=this._updateWeight(time);if(c>0){var h=this._interpolants,d=this._propertyBindings;if(this.blendMode===ue)for(var f=0,m=h.length;f!==m;++f)h[f].evaluate(l),d[f].accumulateAdditive(c);else for(var v=0,y=h.length;v!==y;++v)h[v].evaluate(l),d[v].accumulate(n,c)}}else this._updateWeight(time)}},{key:"_updateWeight",value:function(time){var e=0;if(this.enabled){e=this.weight;var t=this._weightInterpolant;if(null!==t){var n=t.evaluate(time)[0];e*=n,time>t.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=e,e}},{key:"_updateTimeScale",value:function(time){var e=0;if(!this.paused){e=this.timeScale;var t=this._timeScaleInterpolant;if(null!==t)e*=t.evaluate(time)[0],time>t.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}return this._effectiveTimeScale=e,e}},{key:"_updateTime",value:function(e){var t=this._clip.duration,n=this.loop,time=this.time+e,r=this._loopCount,o=2202===n;if(0===e)return-1===r?time:o&&1==(1&r)?t-time:time;if(2200===n){-1===r&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(time>=t)time=t;else{if(!(time<0)){this.time=time;break e}time=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=time,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===r&&(e>=0?(r=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),time>=t||time<0){var l=Math.floor(time/t);time-=t*l,r+=Math.abs(l);var c=this.repetitions-r;if(c<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,time=e>0?t:0,this.time=time,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===c){var h=e<0;this._setEndings(h,!h,o)}else this._setEndings(!1,!1,o);this._loopCount=r,this.time=time,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:l})}}else this.time=time;if(o&&1==(1&r))return t-time}return time}},{key:"_setEndings",value:function(e,t,n){var r=this._interpolantSettings;n?(r.endingStart=se,r.endingEnd=se):(r.endingStart=e?this.zeroSlopeAtStart?se:oe:le,r.endingEnd=t?this.zeroSlopeAtEnd?se:oe:le)}},{key:"_scheduleFading",value:function(e,t,n){var r=this._mixer,o=r.time,l=this._weightInterpolant;null===l&&(l=r._lendControlInterpolant(),this._weightInterpolant=l);var c=l.parameterPositions,h=l.sampleValues;return c[0]=o,h[0]=t,c[1]=o+e,h[1]=n,this}}]),e}();(function(e){Object(v.a)(n,e);var t=S(n);function n(e){var r;return Object(x.a)(this,n),(r=t.call(this))._root=e,r._initMemoryManager(),r._accuIndex=0,r.time=0,r.timeScale=1,r}return Object(_.a)(n,[{key:"_bindAction",value:function(e,t){var n=e._localRoot||this._root,r=e._clip.tracks,o=r.length,l=e._propertyBindings,c=e._interpolants,h=n.uuid,d=this._bindingsByRootAndName,f=d[h];void 0===f&&(f={},d[h]=f);for(var m=0;m!==o;++m){var track=r[m],v=track.name,y=f[v];if(void 0!==y)l[m]=y;else{if(void 0!==(y=l[m])){null===y._cacheIndex&&(++y.referenceCount,this._addInactiveBinding(y,h,v));continue}var path=t&&t._propertyBindings[m].binding.parsedPath;++(y=new ic(mc.create(n,v,path),track.ValueTypeName,track.getValueSize())).referenceCount,this._addInactiveBinding(y,h,v),l[m]=y}c[m].resultBuffer=y.buffer}}},{key:"_activateAction",value:function(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){var t=(e._localRoot||this._root).uuid,n=e._clip.uuid,r=this._actionsByClip[n];this._bindAction(e,r&&r.knownActions[0]),this._addInactiveAction(e,n,t)}for(var o=e._propertyBindings,l=0,c=o.length;l!==c;++l){var h=o[l];0==h.useCount++&&(this._lendBinding(h),h.saveOriginalState())}this._lendAction(e)}}},{key:"_deactivateAction",value:function(e){if(this._isActiveAction(e)){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var o=t[n];0==--o.useCount&&(o.restoreOriginalState(),this._takeBackBinding(o))}this._takeBackAction(e)}}},{key:"_initMemoryManager",value:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}},{key:"_isActiveAction",value:function(e){var t=e._cacheIndex;return null!==t&&t<this._nActiveActions}},{key:"_addInactiveAction",value:function(e,t,n){var r=this._actions,o=this._actionsByClip,l=o[t];if(void 0===l)l={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,o[t]=l;else{var c=l.knownActions;e._byClipCacheIndex=c.length,c.push(e)}e._cacheIndex=r.length,r.push(e),l.actionByRoot[n]=e}},{key:"_removeInactiveAction",value:function(e){var t=this._actions,n=t[t.length-1],r=e._cacheIndex;n._cacheIndex=r,t[r]=n,t.pop(),e._cacheIndex=null;var o=e._clip.uuid,l=this._actionsByClip,c=l[o],h=c.knownActions,d=h[h.length-1],f=e._byClipCacheIndex;d._byClipCacheIndex=f,h[f]=d,h.pop(),e._byClipCacheIndex=null,delete c.actionByRoot[(e._localRoot||this._root).uuid],0===h.length&&delete l[o],this._removeInactiveBindingsForAction(e)}},{key:"_removeInactiveBindingsForAction",value:function(e){for(var t=e._propertyBindings,n=0,r=t.length;n!==r;++n){var o=t[n];0==--o.referenceCount&&this._removeInactiveBinding(o)}}},{key:"_lendAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=this._nActiveActions++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}},{key:"_takeBackAction",value:function(e){var t=this._actions,n=e._cacheIndex,r=--this._nActiveActions,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}},{key:"_addInactiveBinding",value:function(e,t,n){var r=this._bindingsByRootAndName,o=this._bindings,l=r[t];void 0===l&&(l={},r[t]=l),l[n]=e,e._cacheIndex=o.length,o.push(e)}},{key:"_removeInactiveBinding",value:function(e){var t=this._bindings,n=e.binding,r=n.rootNode.uuid,o=n.path,l=this._bindingsByRootAndName,c=l[r],h=t[t.length-1],d=e._cacheIndex;h._cacheIndex=d,t[d]=h,t.pop(),delete c[o],0===Object.keys(c).length&&delete l[r]}},{key:"_lendBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=this._nActiveBindings++,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}},{key:"_takeBackBinding",value:function(e){var t=this._bindings,n=e._cacheIndex,r=--this._nActiveBindings,o=t[r];e._cacheIndex=r,t[r]=e,o._cacheIndex=n,t[n]=o}},{key:"_lendControlInterpolant",value:function(){var e=this._controlInterpolants,t=this._nActiveControlInterpolants++,n=e[t];return void 0===n&&((n=new Ts(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer)).__cacheIndex=t,e[t]=n),n}},{key:"_takeBackControlInterpolant",value:function(e){var t=this._controlInterpolants,n=e.__cacheIndex,r=--this._nActiveControlInterpolants,o=t[r];e.__cacheIndex=r,t[r]=e,o.__cacheIndex=n,t[n]=o}},{key:"clipAction",value:function(e,t,n){var r=t||this._root,o=r.uuid,l="string"==typeof e?Ns.findByName(r,e):e,c=null!==l?l.uuid:e,h=this._actionsByClip[c],d=null;if(void 0===n&&(n=null!==l?l.blendMode:ce),void 0!==h){var f=h.actionByRoot[o];if(void 0!==f&&f.blendMode===n)return f;d=h.knownActions[0],null===l&&(l=d._clip)}if(null===l)return null;var m=new gc(this,l,t,n);return this._bindAction(m,d),this._addInactiveAction(m,c,o),m}},{key:"existingAction",value:function(e,t){var n=t||this._root,r=n.uuid,o="string"==typeof e?Ns.findByName(n,e):e,l=o?o.uuid:e,c=this._actionsByClip[l];return void 0!==c&&c.actionByRoot[r]||null}},{key:"stopAllAction",value:function(){for(var e=this._actions,t=this._nActiveActions-1;t>=0;--t)e[t].stop();return this}},{key:"update",value:function(e){e*=this.timeScale;for(var t=this._actions,n=this._nActiveActions,time=this.time+=e,r=Math.sign(e),o=this._accuIndex^=1,l=0;l!==n;++l){t[l]._update(time,e,r,o)}for(var c=this._bindings,h=this._nActiveBindings,d=0;d!==h;++d)c[d].apply(o);return this}},{key:"setTime",value:function(e){this.time=0;for(var t=0;t<this._actions.length;t++)this._actions[t].time=0;return this.update(e)}},{key:"getRoot",value:function(){return this._root}},{key:"uncacheClip",value:function(e){var t=this._actions,n=e.uuid,r=this._actionsByClip,o=r[n];if(void 0!==o){for(var l=o.knownActions,c=0,h=l.length;c!==h;++c){var d=l[c];this._deactivateAction(d);var f=d._cacheIndex,m=t[t.length-1];d._cacheIndex=null,d._byClipCacheIndex=null,m._cacheIndex=f,t[f]=m,t.pop(),this._removeInactiveBindingsForAction(d)}delete r[n]}}},{key:"uncacheRoot",value:function(e){var t=e.uuid,n=this._actionsByClip;for(var r in n){var o=n[r].actionByRoot[t];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var l=this._bindingsByRootAndName[t];if(void 0!==l)for(var c in l){var h=l[c];h.restoreOriginalState(),this._removeInactiveBinding(h)}}},{key:"uncacheAction",value:function(e,t){var n=this.existingAction(e,t);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}]),n})(xe).prototype._controlInterpolantsResultBuffer=new Float32Array(1);var yc=function(){function e(t){Object(x.a)(this,e),"string"==typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}return Object(_.a)(e,[{key:"clone",value:function(){return new e(void 0===this.value.clone?this.value:this.value.clone())}}]),e}();function xc(e,t,n){Ia.call(this,e,t),this.meshPerAttribute=n||1}function bc(e,t,n,r,o){this.buffer=e,this.type=t,this.itemSize=n,this.elementSize=r,this.count=o,this.version=0}function _c(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1/0;this.ray=new ht(e,t),this.near=n,this.far=r,this.camera=null,this.layers=new St,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function wc(a,b){return a.distance-b.distance}function Mc(object,e,t,n){if(object.layers.test(e.layers)&&object.raycast(e,t),!0===n)for(var r=object.children,o=0,l=r.length;o<l;o++)Mc(r[o],e,t,!0)}xc.prototype=Object.assign(Object.create(Ia.prototype),{constructor:xc,isInstancedInterleavedBuffer:!0,copy:function(source){return Ia.prototype.copy.call(this,source),this.meshPerAttribute=source.meshPerAttribute,this},clone:function(data){var e=Ia.prototype.clone.call(this,data);return e.meshPerAttribute=this.meshPerAttribute,e},toJSON:function(data){var e=Ia.prototype.toJSON.call(this,data);return e.isInstancedInterleavedBuffer=!0,e.meshPerAttribute=this.meshPerAttribute,e}}),Object.defineProperty(bc.prototype,"needsUpdate",{set:function(e){!0===e&&this.version++}}),Object.assign(bc.prototype,{isGLBufferAttribute:!0,setBuffer:function(e){return this.buffer=e,this},setType:function(e,t){return this.type=e,this.elementSize=t,this},setItemSize:function(e){return this.itemSize=e,this},setCount:function(e){return this.count=e,this}}),Object.assign(_c.prototype,{set:function(e,t){this.ray.set(e,t)},setFromCamera:function(e,t){t&&t.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(t.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(t).sub(this.ray.origin).normalize(),this.camera=t):t&&t.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(t.near+t.far)/(t.near-t.far)).unproject(t),this.ray.direction.set(0,0,-1).transformDirection(t.matrixWorld),this.camera=t):console.error("THREE.Raycaster: Unsupported camera type: "+t.type)},intersectObject:function(object){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];return Mc(object,this,t,e),t.sort(wc),t},intersectObjects:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=0,o=e.length;r<o;r++)Mc(e[r],this,n,t);return n.sort(wc),n}});var Sc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(x.a)(this,e),this.radius=t,this.phi=n,this.theta=r,this}return Object(_.a)(e,[{key:"set",value:function(e,t,n){return this.radius=e,this.phi=t,this.theta=n,this}},{key:"copy",value:function(e){return this.radius=e.radius,this.phi=e.phi,this.theta=e.theta,this}},{key:"makeSafe",value:function(){var e=1e-6;return this.phi=Math.max(e,Math.min(Math.PI-e,this.phi)),this}},{key:"setFromVector3",value:function(e){return this.setFromCartesianCoords(e.x,e.y,e.z)}},{key:"setFromCartesianCoords",value:function(e,t,n){return this.radius=Math.sqrt(e*e+t*t+n*n),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(e,n),this.phi=Math.acos(Me.clamp(t/this.radius,-1,1))),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}(),Ec=new Se,Tc=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Se(1/0,1/0),n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Se(-1/0,-1/0);Object(x.a)(this,e),this.min=t,this.max=n}return Object(_.a)(e,[{key:"set",value:function(e,t){return this.min.copy(e),this.max.copy(t),this}},{key:"setFromPoints",value:function(e){this.makeEmpty();for(var t=0,n=e.length;t<n;t++)this.expandByPoint(e[t]);return this}},{key:"setFromCenterAndSize",value:function(e,t){var n=Ec.copy(t).multiplyScalar(.5);return this.min.copy(e).sub(n),this.max.copy(e).add(n),this}},{key:"clone",value:function(){return(new this.constructor).copy(this)}},{key:"copy",value:function(e){return this.min.copy(e.min),this.max.copy(e.max),this}},{key:"makeEmpty",value:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}},{key:"isEmpty",value:function(){return this.max.x<this.min.x||this.max.y<this.min.y}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getCenter() target is now required"),e=new Se),this.isEmpty()?e.set(0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}},{key:"getSize",value:function(e){return void 0===e&&(console.warn("THREE.Box2: .getSize() target is now required"),e=new Se),this.isEmpty()?e.set(0,0):e.subVectors(this.max,this.min)}},{key:"expandByPoint",value:function(e){return this.min.min(e),this.max.max(e),this}},{key:"expandByVector",value:function(e){return this.min.sub(e),this.max.add(e),this}},{key:"expandByScalar",value:function(e){return this.min.addScalar(-e),this.max.addScalar(e),this}},{key:"containsPoint",value:function(e){return!(e.x<this.min.x||e.x>this.max.x||e.y<this.min.y||e.y>this.max.y)}},{key:"containsBox",value:function(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y}},{key:"getParameter",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .getParameter() target is now required"),t=new Se),t.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y))}},{key:"intersectsBox",value:function(e){return!(e.max.x<this.min.x||e.min.x>this.max.x||e.max.y<this.min.y||e.min.y>this.max.y)}},{key:"clampPoint",value:function(e,t){return void 0===t&&(console.warn("THREE.Box2: .clampPoint() target is now required"),t=new Se),t.copy(e).clamp(this.min,this.max)}},{key:"distanceToPoint",value:function(e){return Ec.copy(e).clamp(this.min,this.max).sub(e).length()}},{key:"intersect",value:function(e){return this.min.max(e.min),this.max.min(e.max),this}},{key:"union",value:function(e){return this.min.min(e.min),this.max.max(e.max),this}},{key:"translate",value:function(e){return this.min.add(e),this.max.add(e),this}},{key:"equals",value:function(e){return e.min.equals(this.min)&&e.max.equals(this.max)}}]),e}();Tc.prototype.isBox2=!0;var Cc=new Ie,Lc=new Ie,Ac=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Ie,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Ie;Object(x.a)(this,e),this.start=t,this.end=n}return Object(_.a)(e,[{key:"set",value:function(e,t){return this.start.copy(e),this.end.copy(t),this}},{key:"copy",value:function(line){return this.start.copy(line.start),this.end.copy(line.end),this}},{key:"getCenter",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .getCenter() target is now required"),e=new Ie),e.addVectors(this.start,this.end).multiplyScalar(.5)}},{key:"delta",value:function(e){return void 0===e&&(console.warn("THREE.Line3: .delta() target is now required"),e=new Ie),e.subVectors(this.end,this.start)}},{key:"distanceSq",value:function(){return this.start.distanceToSquared(this.end)}},{key:"distance",value:function(){return this.start.distanceTo(this.end)}},{key:"at",value:function(e,t){return void 0===t&&(console.warn("THREE.Line3: .at() target is now required"),t=new Ie),this.delta(t).multiplyScalar(e).add(this.start)}},{key:"closestPointToPointParameter",value:function(e,t){Cc.subVectors(e,this.start),Lc.subVectors(this.end,this.start);var n=Lc.dot(Lc),r=Lc.dot(Cc)/n;return t&&(r=Me.clamp(r,0,1)),r}},{key:"closestPointToPoint",value:function(e,t,n){var r=this.closestPointToPointParameter(e,t);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new Ie),this.delta(n).multiplyScalar(r).add(this.start)}},{key:"applyMatrix4",value:function(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}},{key:"equals",value:function(line){return line.start.equals(this.start)&&line.end.equals(this.end)}},{key:"clone",value:function(){return(new this.constructor).copy(this)}}]),e}();function Rc(e){zt.call(this),this.material=e,this.render=function(){},this.hasPositions=!1,this.hasNormals=!1,this.hasColors=!1,this.hasUvs=!1,this.positionArray=null,this.normalArray=null,this.colorArray=null,this.uvArray=null,this.count=0}Rc.prototype=Object.create(zt.prototype),Rc.prototype.constructor=Rc,Rc.prototype.isImmediateRenderObject=!0;var kc=new Ie,Pc=new pt,Oc=new pt,Ic=function(e){Object(v.a)(n,e);var t=S(n);function n(object){var e;Object(x.a)(this,n);for(var r=Dc(object),o=new Pn,l=[],c=[],h=new cn(0,0,1),d=new cn(0,1,0),f=0;f<r.length;f++){var m=r[f];m.parent&&m.parent.isBone&&(l.push(0,0,0),l.push(0,0,0),c.push(h.r,h.g,h.b),c.push(d.r,d.g,d.b))}o.setAttribute("position",new wn(l,3)),o.setAttribute("color",new wn(c,3));var v=new mo({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});return(e=t.call(this,o,v)).type="SkeletonHelper",e.isSkeletonHelper=!0,e.root=object,e.bones=r,e.matrix=object.matrixWorld,e.matrixAutoUpdate=!1,e}return Object(_.a)(n,[{key:"updateMatrixWorld",value:function(e){var t=this.bones,r=this.geometry,o=r.getAttribute("position");Oc.copy(this.root.matrixWorld).invert();for(var l=0,h=0;l<t.length;l++){var f=t[l];f.parent&&f.parent.isBone&&(Pc.multiplyMatrices(Oc,f.matrixWorld),kc.setFromMatrixPosition(Pc),o.setXYZ(h,kc.x,kc.y,kc.z),Pc.multiplyMatrices(Oc,f.parent.matrixWorld),kc.setFromMatrixPosition(Pc),o.setXYZ(h+1,kc.x,kc.y,kc.z),h+=2)}r.getAttribute("position").needsUpdate=!0,d(Object(c.a)(n.prototype),"updateMatrixWorld",this).call(this,e)}}]),n}(So);function Dc(object){var e=[];object&&object.isBone&&e.push(object);for(var t=0;t<object.children.length;t++)e.push.apply(e,Dc(object.children[t]));return e}var Nc=function(e){Object(v.a)(n,e);var t=S(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:4473924,c=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8947848;Object(x.a)(this,n),l=new cn(l),c=new cn(c);for(var h=o/2,d=r/o,f=r/2,m=[],v=[],y=0,_=0,w=-f;y<=o;y++,w+=d){m.push(-f,0,w,f,0,w),m.push(w,0,-f,w,0,f);var M=y===h?l:c;M.toArray(v,_),_+=3,M.toArray(v,_),_+=3,M.toArray(v,_),_+=3,M.toArray(v,_),_+=3}var S=new Pn;S.setAttribute("position",new wn(m,3)),S.setAttribute("color",new wn(v,3));var E=new mo({vertexColors:!0,toneMapped:!1});return(e=t.call(this,S,E)).type="GridHelper",e}return Object(_.a)(n)}(So);var Hc=new Float32Array(1),zc=(new Int32Array(Hc.buffer),Math.pow(2,8),[.125,.215,.35,.446,.526,.582]),Fc=5+zc.length,Bc=(f={},Object(o.a)(f,he,0),Object(o.a)(f,de,1),Object(o.a)(f,fe,2),Object(o.a)(f,3004,3),Object(o.a)(f,3005,4),Object(o.a)(f,3006,5),Object(o.a)(f,pe,6),new un({side:1,depthWrite:!1,depthTest:!1})),Uc=(new Jn(new Kn,Bc),jc());Uc._lodPlanes,Uc._sizeLods,Uc._sigmas,Math.sqrt(5);function jc(){for(var e=[],t=[],n=[],r=8,i=0;i<Fc;i++){var o=Math.pow(2,r);t.push(o);var l=1/o;i>4?l=zc[i-8+4-1]:0==i&&(l=0),n.push(l);for(var c=1/(o-1),h=-c/2,d=1+c/2,f=[h,h,d,h,d,d,h,h,d,d,h,d],m=new Float32Array(108),v=new Float32Array(72),y=new Float32Array(36),x=0;x<6;x++){var _=x%3*2/3-1,w=x>2?0:-1,M=[_,w,0,_+2/3,w,0,_+2/3,w+1,0,_,w,0,_+2/3,w+1,0,_,w+1,0];m.set(M,18*x),v.set(f,12*x);var S=[x,x,x,x,x,x];y.set(S,6*x)}var E=new Pn;E.setAttribute("position",new pn(m,3)),E.setAttribute("uv",new pn(v,2)),E.setAttribute("faceIndex",new pn(y,1)),e.push(E),r>4&&r--}return{_lodPlanes:e,_sizeLods:t,_sigmas:n}}Zs.create=function(e,t){return console.log("THREE.Curve.create() has been deprecated"),e.prototype=Object.create(Zs.prototype),e.prototype.constructor=e,e.prototype.getPoint=t,e},xl.prototype.fromPoints=function(e){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(e)},Nc.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},Ic.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Us.prototype.extractUrlBase=function(e){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),jl(e)},Us.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}},Tc.prototype.center=function(e){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(e)},Tc.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},Tc.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},Tc.prototype.size=function(e){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(e)},He.prototype.center=function(e){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(e)},He.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},He.prototype.isIntersectionBox=function(e){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},He.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},He.prototype.size=function(e){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(e)},nt.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},pi.prototype.setFromMatrix=function(e){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(e)},Ac.prototype.center=function(e){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(e)},Me.random16=function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},Me.nearestPowerOfTwo=function(e){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Me.floorPowerOfTwo(e)},Me.nextPowerOfTwo=function(e){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Me.ceilPowerOfTwo(e)},Te.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},Te.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Te.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},Te.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),e.applyMatrix3(this)},Te.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},Te.prototype.getInverse=function(e){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},pt.prototype.extractPosition=function(e){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(e)},pt.prototype.flattenToArrayOffset=function(e,t){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(e,t)},pt.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),(new Ie).setFromMatrixColumn(this,3)},pt.prototype.setRotationFromQuaternion=function(q){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(q)},pt.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},pt.prototype.multiplyVector3=function(e){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.multiplyVector4=function(e){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},pt.prototype.rotateAxis=function(e){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),e.transformDirection(this)},pt.prototype.crossVector=function(e){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},pt.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},pt.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},pt.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},pt.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},pt.prototype.applyToBufferAttribute=function(e){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),e.applyMatrix4(this)},pt.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},pt.prototype.makeFrustum=function(e,t,n,r,o,l){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(e,t,r,n,o,l)},pt.prototype.getInverse=function(e){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(e).invert()},jt.prototype.isIntersectionLine=function(line){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(line)},Oe.prototype.multiplyVector3=function(e){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),e.applyQuaternion(this)},Oe.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},ht.prototype.isIntersectionBox=function(e){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(e)},ht.prototype.isIntersectionPlane=function(e){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(e)},ht.prototype.isIntersectionSphere=function(e){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(e)},Qt.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Qt.prototype.barycoordFromPoint=function(e,t){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(e,t)},Qt.prototype.midpoint=function(e){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(e)},Qt.prototypenormal=function(e){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(e)},Qt.prototype.plane=function(e){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(e)},Qt.barycoordFromPoint=function(e,a,b,t,n){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Qt.getBarycoord(e,a,b,t,n)},Qt.normal=function(a,b,e,t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Qt.getNormal(a,b,e,t)},bl.prototype.extractAllPoints=function(e){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(e)},bl.prototype.extrude=function(e){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new cs(this,e)},bl.prototype.makeGeometry=function(e){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new ds(this,e)},Se.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Se.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Se.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},Ie.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},Ie.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},Ie.prototype.getPositionFromMatrix=function(e){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(e)},Ie.prototype.getScaleFromMatrix=function(e){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(e)},Ie.prototype.getColumnFromMatrix=function(e,t){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(t,e)},Ie.prototype.applyProjection=function(e){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(e)},Ie.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},Ie.prototype.distanceToManhattan=function(e){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(e)},Ie.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ke.prototype.fromAttribute=function(e,t,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(e,t,n)},ke.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},zt.prototype.getChildByName=function(e){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(e)},zt.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},zt.prototype.translate=function(e,t){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(t,e)},zt.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},zt.prototype.applyMatrix=function(e){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(zt.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(e){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=e}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Jn.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties(Jn.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),0},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),ro.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},Object.defineProperty(Zs.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(e){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=e}}),ri.prototype.setLens=function(e,t){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==t&&(this.filmGauge=t),this.setFocalLength(e)},Object.defineProperties(_l.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(e){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=e}},shadowCameraLeft:{set:function(e){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=e}},shadowCameraRight:{set:function(e){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=e}},shadowCameraTop:{set:function(e){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=e}},shadowCameraBottom:{set:function(e){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=e}},shadowCameraNear:{set:function(e){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=e}},shadowCameraFar:{set:function(e){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=e}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(e){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=e}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(e){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=e}},shadowMapHeight:{set:function(e){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=e}}}),Object.defineProperties(pn.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===ge},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(ge)}}}),pn.prototype.setDynamic=function(e){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?ge:ve),this},pn.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},pn.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Pn.prototype.addIndex=function(e){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(e)},Pn.prototype.addAttribute=function(e,t){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),t&&t.isBufferAttribute||t&&t.isInterleavedBufferAttribute?"index"===e?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(t),this):this.setAttribute(e,t):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(e,new pn(arguments[1],arguments[2])))},Pn.prototype.addDrawCall=function(e,t,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(e,t)},Pn.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},Pn.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},Pn.prototype.removeAttribute=function(e){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(e)},Pn.prototype.applyMatrix=function(e){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(e)},Object.defineProperties(Pn.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.defineProperties(Gl.prototype,{maxInstancedCount:{get:function(){return console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount},set:function(e){console.warn("THREE.InstancedBufferGeometry: .maxInstancedCount has been renamed to .instanceCount."),this.instanceCount=e}}}),Object.defineProperties(_c.prototype,{linePrecision:{get:function(){return console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold},set:function(e){console.warn("THREE.Raycaster: .linePrecision has been deprecated. Use .params.Line.threshold instead."),this.params.Line.threshold=e}}}),Object.defineProperties(Ia.prototype,{dynamic:{get:function(){return console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.usage===ge},set:function(e){console.warn("THREE.InterleavedBuffer: .length has been deprecated. Use .usage instead."),this.setUsage(e)}}}),Ia.prototype.setDynamic=function(e){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(!0===e?ge:ve),this},Ia.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},cs.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},cs.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},cs.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},Oa.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},yc.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(tn.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new cn}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(e){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=1===e}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(e){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=e}}}),Object.defineProperties(vs.prototype,{transparency:{get:function(){return console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission},set:function(e){console.warn("THREE.MeshPhysicalMaterial: .transparency has been renamed to .transmission."),this.transmission=e}}}),Object.defineProperties(ni.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(e){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=e}}}),Aa.prototype.clearTarget=function(e,t,n,r){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(e),this.clear(t,n,r)},Aa.prototype.animate=function(e){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(e)},Aa.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},Aa.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},Aa.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},Aa.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},Aa.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},Aa.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},Aa.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},Aa.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},Aa.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},Aa.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},Aa.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},Aa.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},Aa.prototype.enableScissorTest=function(e){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(e)},Aa.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},Aa.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},Aa.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},Aa.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},Aa.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},Aa.prototype.allocTextureUnit=function(){console.warn("THREE.WebGLRenderer: .allocTextureUnit() has been removed.")},Aa.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},Aa.prototype.setTexture2D=function(){console.warn("THREE.WebGLRenderer: .setTexture2D() has been removed.")},Aa.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},Aa.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(Aa.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=e}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(e){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=e}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(e){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=!0===e?de:he}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}}}),Object.defineProperties(ba.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(Pe.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=e}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(e){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=e}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=e}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(e){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=e}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(e){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=e}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(e){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=e}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(e){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=e}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(e){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=e}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(e){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=e}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(e){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=e}}}),tc.prototype.load=function(e){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var t=this;return(new Kl).load(e,(function(e){t.setBuffer(e)})),this},nc.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},oi.prototype.updateCubeMap=function(e,t){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(e,t)},oi.prototype.clear=function(e,t,n,r){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(e,t,n,r)},Ce.crossOrigin=void 0,Ce.loadTexture=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var o=new Ys;o.setCrossOrigin(this.crossOrigin);var l=o.load(e,n,void 0,r);return t&&(l.mapping=t),l},Ce.loadTextureCube=function(e,t,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var o=new qs;o.setCrossOrigin(this.crossOrigin);var l=o.load(e,n,void 0,r);return t&&(l.mapping=t),l},Ce.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},Ce.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};"undefined"!=typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"127"}})),"undefined"!=typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="127");var Gc=n(21),Vc=(n(177),n(508),n(239),function(){function e(e){Us.call(this,e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register((function(e){return new l(e)})),this.register((function(e){return new h(e)})),this.register((function(e){return new d(e)})),this.register((function(e){return new c(e)})),this.register((function(e){return new r(e)})),this.register((function(e){return new f(e)}))}function t(){var e={};return{get:function(t){return e[t]},add:function(t,object){e[t]=object},remove:function(t){delete e[t]},removeAll:function(){e={}}}}e.prototype=Object.assign(Object.create(Us.prototype),{constructor:e,load:function(e,t,n,r){var o,l=this;o=""!==this.resourcePath?this.resourcePath:""!==this.path?this.path:jl(e),this.manager.itemStart(e);var c=function(t){r?r(t):console.error(t),l.manager.itemError(e),l.manager.itemEnd(e)},h=new Gs(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(this.withCredentials),h.load(e,(function(data){try{l.parse(data,o,(function(n){t(n),l.manager.itemEnd(e)}),c)}catch(e){c(e)}}),n,c)},setDRACOLoader:function(e){return this.dracoLoader=e,this},setDDSLoader:function(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')},setKTX2Loader:function(e){return this.ktx2Loader=e,this},setMeshoptDecoder:function(e){return this.meshoptDecoder=e,this},register:function(e){return-1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this},unregister:function(e){return-1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this},parse:function(data,path,e,t){var content,r={},l={};if("string"==typeof data)content=data;else if(Ul(new Uint8Array(data,0,4))===m){try{r[n.KHR_BINARY_GLTF]=new x(data)}catch(e){return void(t&&t(e))}content=r[n.KHR_BINARY_GLTF].content}else content=Ul(new Uint8Array(data));var c=JSON.parse(content);if(void 0===c.asset||c.asset.version[0]<2)t&&t(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));else{var h=new le(c,{path:path||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(var i=0;i<this.pluginCallbacks.length;i++){var d=this.pluginCallbacks[i](h);l[d.name]=d,r[d.name]=!0}if(c.extensionsUsed)for(i=0;i<c.extensionsUsed.length;++i){var f=c.extensionsUsed[i],v=c.extensionsRequired||[];switch(f){case n.KHR_MATERIALS_UNLIT:r[f]=new o;break;case n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:r[f]=new S;break;case n.KHR_DRACO_MESH_COMPRESSION:r[f]=new _(c,this.dracoLoader);break;case n.KHR_TEXTURE_TRANSFORM:r[f]=new w;break;case n.KHR_MESH_QUANTIZATION:r[f]=new E;break;default:v.indexOf(f)>=0&&void 0===l[f]&&console.warn('THREE.GLTFLoader: Unknown extension "'+f+'".')}}h.setExtensions(r),h.setPlugins(l),h.parse(e,t)}}});var n={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};function r(e){this.parser=e,this.name=n.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}function o(){this.name=n.KHR_MATERIALS_UNLIT}function l(e){this.parser=e,this.name=n.KHR_MATERIALS_CLEARCOAT}function c(e){this.parser=e,this.name=n.KHR_MATERIALS_TRANSMISSION}function h(e){this.parser=e,this.name=n.KHR_TEXTURE_BASISU}function d(e){this.parser=e,this.name=n.EXT_TEXTURE_WEBP,this.isSupported=null}function f(e){this.name=n.EXT_MESHOPT_COMPRESSION,this.parser=e}r.prototype._markDefs=function(){for(var e=this.parser,t=this.parser.json.nodes||[],n=0,r=t.length;n<r;n++){var o=t[n];o.extensions&&o.extensions[this.name]&&void 0!==o.extensions[this.name].light&&e._addNodeRef(this.cache,o.extensions[this.name].light)}},r.prototype._loadLight=function(e){var t=this.parser,n="light:"+e,r=t.cache.get(n);if(r)return r;var o,l=t.json,c=((l.extensions&&l.extensions[this.name]||{}).lights||[])[e],h=new cn(16777215);void 0!==c.color&&h.fromArray(c.color);var d=void 0!==c.range?c.range:0;switch(c.type){case"directional":(o=new Nl(h)).target.position.set(0,0,-1),o.add(o.target);break;case"point":(o=new Ol(h)).distance=d;break;case"spot":(o=new Ll(h)).distance=d,c.spot=c.spot||{},c.spot.innerConeAngle=void 0!==c.spot.innerConeAngle?c.spot.innerConeAngle:0,c.spot.outerConeAngle=void 0!==c.spot.outerConeAngle?c.spot.outerConeAngle:Math.PI/4,o.angle=c.spot.outerConeAngle,o.penumbra=1-c.spot.innerConeAngle/c.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+c.type)}return o.position.set(0,0,0),o.decay=2,void 0!==c.intensity&&(o.intensity=c.intensity),o.name=t.createUniqueName(c.name||"light_"+e),r=Promise.resolve(o),t.cache.add(n,r),r},r.prototype.createNodeAttachment=function(e){var t=this,n=this.parser,r=n.json.nodes[e],o=(r.extensions&&r.extensions[this.name]||{}).light;return void 0===o?null:this._loadLight(o).then((function(e){return n._getNodeRef(t.cache,o,e)}))},o.prototype.getMaterialType=function(){return un},o.prototype.extendParams=function(e,t,n){var r=[];e.color=new cn(1,1,1),e.opacity=1;var o=t.pbrMetallicRoughness;if(o){if(Array.isArray(o.baseColorFactor)){var l=o.baseColorFactor;e.color.fromArray(l),e.opacity=l[3]}void 0!==o.baseColorTexture&&r.push(n.assignTexture(e,"map",o.baseColorTexture))}return Promise.all(r)},l.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?vs:null},l.prototype.extendMaterialParams=function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var o=[],l=r.extensions[this.name];if(void 0!==l.clearcoatFactor&&(t.clearcoat=l.clearcoatFactor),void 0!==l.clearcoatTexture&&o.push(n.assignTexture(t,"clearcoatMap",l.clearcoatTexture)),void 0!==l.clearcoatRoughnessFactor&&(t.clearcoatRoughness=l.clearcoatRoughnessFactor),void 0!==l.clearcoatRoughnessTexture&&o.push(n.assignTexture(t,"clearcoatRoughnessMap",l.clearcoatRoughnessTexture)),void 0!==l.clearcoatNormalTexture&&(o.push(n.assignTexture(t,"clearcoatNormalMap",l.clearcoatNormalTexture)),void 0!==l.clearcoatNormalTexture.scale)){var c=l.clearcoatNormalTexture.scale;t.clearcoatNormalScale=new Se(c,-c)}return Promise.all(o)},c.prototype.getMaterialType=function(e){var t=this.parser.json.materials[e];return t.extensions&&t.extensions[this.name]?vs:null},c.prototype.extendMaterialParams=function(e,t){var n=this.parser,r=n.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();var o=[],l=r.extensions[this.name];return void 0!==l.transmissionFactor&&(t.transmission=l.transmissionFactor),void 0!==l.transmissionTexture&&o.push(n.assignTexture(t,"transmissionMap",l.transmissionTexture)),Promise.all(o)},h.prototype.loadTexture=function(e){var t=this.parser,n=t.json,r=n.textures[e];if(!r.extensions||!r.extensions[this.name])return null;var o=r.extensions[this.name],source=n.images[o.source],l=t.options.ktx2Loader;if(!l){if(n.extensionsRequired&&n.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return t.loadTextureImage(e,source,l)},d.prototype.loadTexture=function(e){var t=this.name,n=this.parser,r=n.json,o=r.textures[e];if(!o.extensions||!o.extensions[t])return null;var l=o.extensions[t],source=r.images[l.source],c=n.textureLoader;if(source.uri){var h=n.options.manager.getHandler(source.uri);null!==h&&(c=h)}return this.detectSupport().then((function(o){if(o)return n.loadTextureImage(e,source,c);if(r.extensionsRequired&&r.extensionsRequired.indexOf(t)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return n.loadTexture(e)}))},d.prototype.detectSupport=function(){return this.isSupported||(this.isSupported=new Promise((function(e){var image=new Image;image.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",image.onload=image.onerror=function(){e(1===image.height)}}))),this.isSupported},f.prototype.loadBufferView=function(e){var t=this.parser.json,n=t.bufferViews[e];if(n.extensions&&n.extensions[this.name]){var r=n.extensions[this.name],o=this.parser.getDependency("buffer",r.buffer),l=this.parser.options.meshoptDecoder;if(!l||!l.supported){if(t.extensionsRequired&&t.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([o,l.ready]).then((function(e){var t=r.byteOffset||0,n=r.byteLength||0,o=r.count,c=r.byteStride,h=new ArrayBuffer(o*c),source=new Uint8Array(e[0],t,n);return l.decodeGltfBuffer(new Uint8Array(h),o,c,source,r.mode,r.filter),h}))}return null};var m="glTF",v=1313821514,y=5130562;function x(data){this.name=n.KHR_BINARY_GLTF,this.content=null,this.body=null;var e=new DataView(data,0,12);if(this.header={magic:Ul(new Uint8Array(data.slice(0,4))),version:e.getUint32(4,!0),length:e.getUint32(8,!0)},this.header.magic!==m)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");for(var t=this.header.length-12,r=new DataView(data,12),o=0;o<t;){var l=r.getUint32(o,!0);o+=4;var c=r.getUint32(o,!0);if(o+=4,c===v){var h=new Uint8Array(data,12+o,l);this.content=Ul(h)}else if(c===y){var d=12+o;this.body=data.slice(d,d+l)}o+=l}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function _(e,t){if(!t)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=n.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=t,this.dracoLoader.preload()}function w(){this.name=n.KHR_TEXTURE_TRANSFORM}function M(e){ms.call(this),this.isGLTFSpecularGlossinessMaterial=!0;var t=["#ifdef USE_SPECULARMAP","\tuniform sampler2D specularMap;","#endif"].join("\n"),n=["#ifdef USE_GLOSSINESSMAP","\tuniform sampler2D glossinessMap;","#endif"].join("\n"),r=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","\tvec4 texelSpecular = texture2D( specularMap, vUv );","\ttexelSpecular = sRGBToLinear( texelSpecular );","\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","\tspecularFactor *= texelSpecular.rgb;","#endif"].join("\n"),o=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );","\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","\tglossinessFactor *= texelGlossiness.a;","#endif"].join("\n"),l=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.specularRoughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.specularRoughness += geometryRoughness;","material.specularRoughness = min( material.specularRoughness, 1.0 );","material.specularColor = specularFactor;"].join("\n"),c={specular:{value:(new cn).setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=c,this.onBeforeCompile=function(e){for(var h in c)e.uniforms[h]=c[h];e.fragmentShader=e.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",t).replace("#include <metalnessmap_pars_fragment>",n).replace("#include <roughnessmap_fragment>",r).replace("#include <metalnessmap_fragment>",o).replace("#include <lights_physical_fragment>",l)},Object.defineProperties(this,{specular:{get:function(){return c.specular.value},set:function(e){c.specular.value=e}},specularMap:{get:function(){return c.specularMap.value},set:function(e){c.specularMap.value=e,e?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return c.glossiness.value},set:function(e){c.glossiness.value=e}},glossinessMap:{get:function(){return c.glossinessMap.value},set:function(e){c.glossinessMap.value=e,e?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(e)}function S(){return{name:n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return M},extendParams:function(e,t,n){var r=t.extensions[this.name];e.color=new cn(1,1,1),e.opacity=1;var o=[];if(Array.isArray(r.diffuseFactor)){var l=r.diffuseFactor;e.color.fromArray(l),e.opacity=l[3]}if(void 0!==r.diffuseTexture&&o.push(n.assignTexture(e,"map",r.diffuseTexture)),e.emissive=new cn(0,0,0),e.glossiness=void 0!==r.glossinessFactor?r.glossinessFactor:1,e.specular=new cn(1,1,1),Array.isArray(r.specularFactor)&&e.specular.fromArray(r.specularFactor),void 0!==r.specularGlossinessTexture){var c=r.specularGlossinessTexture;o.push(n.assignTexture(e,"glossinessMap",c)),o.push(n.assignTexture(e,"specularMap",c))}return Promise.all(o)},createMaterial:function(e){var t=new M(e);return t.fog=!0,t.color=e.color,t.map=void 0===e.map?null:e.map,t.lightMap=null,t.lightMapIntensity=1,t.aoMap=void 0===e.aoMap?null:e.aoMap,t.aoMapIntensity=1,t.emissive=e.emissive,t.emissiveIntensity=1,t.emissiveMap=void 0===e.emissiveMap?null:e.emissiveMap,t.bumpMap=void 0===e.bumpMap?null:e.bumpMap,t.bumpScale=1,t.normalMap=void 0===e.normalMap?null:e.normalMap,t.normalMapType=0,e.normalScale&&(t.normalScale=e.normalScale),t.displacementMap=null,t.displacementScale=1,t.displacementBias=0,t.specularMap=void 0===e.specularMap?null:e.specularMap,t.specular=e.specular,t.glossinessMap=void 0===e.glossinessMap?null:e.glossinessMap,t.glossiness=e.glossiness,t.alphaMap=null,t.envMap=void 0===e.envMap?null:e.envMap,t.envMapIntensity=1,t.refractionRatio=.98,t}}}function E(){this.name=n.KHR_MESH_QUANTIZATION}function T(e,t,n,r){Ss.call(this,e,t,n,r)}_.prototype.decodePrimitive=function(e,t){var n=this.json,r=this.dracoLoader,o=e.extensions[this.name].bufferView,l=e.extensions[this.name].attributes,c={},h={},d={};for(var f in l){var m=Y[f]||f.toLowerCase();c[m]=l[f]}for(f in e.attributes){m=Y[f]||f.toLowerCase();if(void 0!==l[f]){var v=n.accessors[e.attributes[f]],y=I[v.componentType];d[m]=y,h[m]=!0===v.normalized}}return t.getDependency("bufferView",o).then((function(e){return new Promise((function(t){r.decodeDracoFile(e,(function(e){for(var n in e.attributes){var r=e.attributes[n],o=h[n];void 0!==o&&(r.normalized=o)}t(e)}),c,d)}))}))},w.prototype.extendTexture=function(e,t){return e=e.clone(),void 0!==t.offset&&e.offset.fromArray(t.offset),void 0!==t.rotation&&(e.rotation=t.rotation),void 0!==t.scale&&e.repeat.fromArray(t.scale),void 0!==t.texCoord&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),e.needsUpdate=!0,e},M.prototype=Object.create(ms.prototype),M.prototype.constructor=M,M.prototype.copy=function(source){return ms.prototype.copy.call(this,source),this.specularMap=source.specularMap,this.specular.copy(source.specular),this.glossinessMap=source.glossinessMap,this.glossiness=source.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this},T.prototype=Object.create(Ss.prototype),T.prototype.constructor=T,T.prototype.copySampleValue_=function(e){for(var t=this.resultBuffer,n=this.sampleValues,r=this.valueSize,o=e*r*3+r,i=0;i!==r;i++)t[i]=n[o+i];return t},T.prototype.beforeStart_=T.prototype.copySampleValue_,T.prototype.afterEnd_=T.prototype.copySampleValue_,T.prototype.interpolate_=function(e,t,n,r){for(var o=this.resultBuffer,l=this.sampleValues,c=this.valueSize,h=2*c,d=3*c,td=r-t,p=(n-t)/td,f=p*p,m=f*p,v=e*d,y=v-d,x=-2*m+3*f,_=m-f,w=1-x,M=_-f+p,i=0;i!==c;i++){var S=l[y+i+c],E=l[y+i+h]*td,T=l[v+i+c],C=l[v+i]*td;o[i]=w*S+M*E+x*T+_*C}return o};var C=0,L=1,A=2,R=3,k=4,P=5,O=6,I={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},D={9728:B,9729:G,9984:U,9985:V,9986:j,9987:W},N={33071:z,33648:F,10497:H},X={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},Y={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},Z={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},J={CUBICSPLINE:void 0,LINEAR:re,STEP:ie},$="OPAQUE",K="MASK",ee="BLEND";function te(e,path){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(path)&&/^\//.test(e)&&(path=path.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:path+e)}function ne(e,object,t){for(var n in t.extensions)void 0===e[n]&&(object.userData.gltfExtensions=object.userData.gltfExtensions||{},object.userData.gltfExtensions[n]=t.extensions[n])}function ae(object,e){void 0!==e.extras&&("object"===Object(Gc.a)(e.extras)?Object.assign(object.userData,e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+e.extras))}function oe(e,t){if(e.updateMorphTargets(),void 0!==t.weights)for(var i=0,n=t.weights.length;i<n;i++)e.morphTargetInfluences[i]=t.weights[i];if(t.extras&&Array.isArray(t.extras.targetNames)){var r=t.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(i=0,n=r.length;i<n;i++)e.morphTargetDictionary[r[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function se(e){for(var t="",n=Object.keys(e).sort(),i=0,r=n.length;i<r;i++)t+=n[i]+":"+e[n[i]]+";";return t}function le(e,n){this.json=e||{},this.extensions={},this.plugins={},this.options=n||{},this.cache=new t,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.nodeNamesUsed={},"undefined"!=typeof createImageBitmap&&!1===/Firefox/.test(navigator.userAgent)?this.textureLoader=new Wl(this.options.manager):this.textureLoader=new Ys(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new Gs(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}function ce(e,t,n){var r=t.attributes,o=[];function l(t,r){return n.getDependency("accessor",t).then((function(t){e.setAttribute(r,t)}))}for(var c in r){var h=Y[c]||c.toLowerCase();h in e.attributes||o.push(l(r[c],h))}if(void 0!==t.indices&&!e.index){var d=n.getDependency("accessor",t.indices).then((function(t){e.setIndex(t)}));o.push(d)}return ae(e,t),function(e,t,n){var r=t.attributes,o=new He;if(void 0!==r.POSITION){var l=(v=n.json.accessors[r.POSITION]).min,c=v.max;if(void 0!==l&&void 0!==c){o.set(new Ie(l[0],l[1],l[2]),new Ie(c[0],c[1],c[2]));var h=t.targets;if(void 0!==h){for(var d=new Ie,f=new Ie,i=0,m=h.length;i<m;i++){var v,y=h[i];if(void 0!==y.POSITION)l=(v=n.json.accessors[y.POSITION]).min,c=v.max,void 0!==l&&void 0!==c?(f.setX(Math.max(Math.abs(l[0]),Math.abs(c[0]))),f.setY(Math.max(Math.abs(l[1]),Math.abs(c[1]))),f.setZ(Math.max(Math.abs(l[2]),Math.abs(c[2]))),d.max(f)):console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}o.expandByVector(d)}e.boundingBox=o;var x=new nt;o.getCenter(x.center),x.radius=o.min.distanceTo(o.max)/2,e.boundingSphere=x}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}(e,t,n),Promise.all(o).then((function(){return void 0!==t.targets?function(e,t,n){for(var r=!1,o=!1,i=0,l=t.length;i<l&&(void 0!==(d=t[i]).POSITION&&(r=!0),void 0!==d.NORMAL&&(o=!0),!r||!o);i++);if(!r&&!o)return Promise.resolve(e);var c=[],h=[];for(i=0,l=t.length;i<l;i++){var d=t[i];if(r){var f=void 0!==d.POSITION?n.getDependency("accessor",d.POSITION):e.attributes.position;c.push(f)}o&&(f=void 0!==d.NORMAL?n.getDependency("accessor",d.NORMAL):e.attributes.normal,h.push(f))}return Promise.all([Promise.all(c),Promise.all(h)]).then((function(t){var n=t[0],l=t[1];return r&&(e.morphAttributes.position=n),o&&(e.morphAttributes.normal=l),e.morphTargetsRelative=!0,e}))}(e,t.targets,n):e}))}function ue(e,t){var n=e.getIndex();if(null===n){var r=[],o=e.getAttribute("position");if(void 0===o)return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(var i=0;i<o.count;i++)r.push(i);e.setIndex(r),n=e.getIndex()}var l=n.count-2,c=[];if(2===t)for(i=1;i<=l;i++)c.push(n.getX(0)),c.push(n.getX(i)),c.push(n.getX(i+1));else for(i=0;i<l;i++)i%2==0?(c.push(n.getX(i)),c.push(n.getX(i+1)),c.push(n.getX(i+2))):(c.push(n.getX(i+2)),c.push(n.getX(i+1)),c.push(n.getX(i)));c.length/3!==l&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");var h=e.clone();return h.setIndex(c),h}return le.prototype.setExtensions=function(e){this.extensions=e},le.prototype.setPlugins=function(e){this.plugins=e},le.prototype.parse=function(e,t){var n=this,r=this.json,o=this.extensions;this.cache.removeAll(),this._invokeAll((function(e){return e._markDefs&&e._markDefs()})),Promise.all(this._invokeAll((function(e){return e.beforeRoot&&e.beforeRoot()}))).then((function(){return Promise.all([n.getDependencies("scene"),n.getDependencies("animation"),n.getDependencies("camera")])})).then((function(t){var l={scene:t[0][r.scene||0],scenes:t[0],animations:t[1],cameras:t[2],asset:r.asset,parser:n,userData:{}};ne(o,l,r),ae(l,r),Promise.all(n._invokeAll((function(e){return e.afterRoot&&e.afterRoot(l)}))).then((function(){e(l)}))})).catch(t)},le.prototype._markDefs=function(){for(var e=this.json.nodes||[],t=this.json.skins||[],n=this.json.meshes||[],r=0,o=t.length;r<o;r++)for(var l=t[r].joints,i=0,c=l.length;i<c;i++)e[l[i]].isBone=!0;for(var h=0,d=e.length;h<d;h++){var f=e[h];void 0!==f.mesh&&(this._addNodeRef(this.meshCache,f.mesh),void 0!==f.skin&&(n[f.mesh].isSkinnedMesh=!0)),void 0!==f.camera&&this._addNodeRef(this.cameraCache,f.camera)}},le.prototype._addNodeRef=function(e,t){void 0!==t&&(void 0===e.refs[t]&&(e.refs[t]=e.uses[t]=0),e.refs[t]++)},le.prototype._getNodeRef=function(e,t,object){if(e.refs[t]<=1)return object;var n=object.clone();return n.name+="_instance_"+e.uses[t]++,n},le.prototype._invokeOne=function(e){var t=Object.values(this.plugins);t.push(this);for(var i=0;i<t.length;i++){var n=e(t[i]);if(n)return n}},le.prototype._invokeAll=function(e){var t=Object.values(this.plugins);t.unshift(this);for(var n=[],i=0;i<t.length;i++){var r=e(t[i]);r&&n.push(r)}return n},le.prototype.getDependency=function(e,t){var n=e+":"+t,r=this.cache.get(n);if(!r){switch(e){case"scene":r=this.loadScene(t);break;case"node":r=this.loadNode(t);break;case"mesh":r=this._invokeOne((function(e){return e.loadMesh&&e.loadMesh(t)}));break;case"accessor":r=this.loadAccessor(t);break;case"bufferView":r=this._invokeOne((function(e){return e.loadBufferView&&e.loadBufferView(t)}));break;case"buffer":r=this.loadBuffer(t);break;case"material":r=this._invokeOne((function(e){return e.loadMaterial&&e.loadMaterial(t)}));break;case"texture":r=this._invokeOne((function(e){return e.loadTexture&&e.loadTexture(t)}));break;case"skin":r=this.loadSkin(t);break;case"animation":r=this.loadAnimation(t);break;case"camera":r=this.loadCamera(t);break;default:throw new Error("Unknown type: "+e)}this.cache.add(n,r)}return r},le.prototype.getDependencies=function(e){var t=this.cache.get(e);if(!t){var n=this,defs=this.json[e+("mesh"===e?"es":"s")]||[];t=Promise.all(defs.map((function(t,r){return n.getDependency(e,r)}))),this.cache.add(e,t)}return t},le.prototype.loadBuffer=function(e){var t=this.json.buffers[e],r=this.fileLoader;if(t.type&&"arraybuffer"!==t.type)throw new Error("THREE.GLTFLoader: "+t.type+" buffer type is not supported.");if(void 0===t.uri&&0===e)return Promise.resolve(this.extensions[n.KHR_BINARY_GLTF].body);var o=this.options;return new Promise((function(e,n){r.load(te(t.uri,o.path),e,void 0,(function(){n(new Error('THREE.GLTFLoader: Failed to load buffer "'+t.uri+'".'))}))}))},le.prototype.loadBufferView=function(e){var t=this.json.bufferViews[e];return this.getDependency("buffer",t.buffer).then((function(e){var n=t.byteLength||0,r=t.byteOffset||0;return e.slice(r,r+n)}))},le.prototype.loadAccessor=function(e){var t=this,n=this.json,r=this.json.accessors[e];if(void 0===r.bufferView&&void 0===r.sparse)return Promise.resolve(null);var o=[];return void 0!==r.bufferView?o.push(this.getDependency("bufferView",r.bufferView)):o.push(null),void 0!==r.sparse&&(o.push(this.getDependency("bufferView",r.sparse.indices.bufferView)),o.push(this.getDependency("bufferView",r.sparse.values.bufferView))),Promise.all(o).then((function(e){var o,l=e[0],c=X[r.type],h=I[r.componentType],d=h.BYTES_PER_ELEMENT,f=d*c,m=r.byteOffset||0,v=void 0!==r.bufferView?n.bufferViews[r.bufferView].byteStride:void 0,y=!0===r.normalized;if(v&&v!==f){var x=Math.floor(m/v),_="InterleavedBuffer:"+r.bufferView+":"+r.componentType+":"+x+":"+r.count,w=t.cache.get(_);w||(w=new Ia(new h(l,x*v,r.count*v/d),v/d),t.cache.add(_,w)),o=new Na(w,c,m%v/d,y)}else o=new pn(null===l?new h(r.count*c):new h(l,m,r.count*c),c,y);if(void 0!==r.sparse){var M=X.SCALAR,S=I[r.sparse.indices.componentType],E=r.sparse.indices.byteOffset||0,T=r.sparse.values.byteOffset||0,C=new S(e[1],E,r.sparse.count*M),L=new h(e[2],T,r.sparse.count*c);null!==l&&(o=new pn(o.array.slice(),o.itemSize,o.normalized));for(var i=0,A=C.length;i<A;i++){var R=C[i];if(o.setX(R,L[i*c]),c>=2&&o.setY(R,L[i*c+1]),c>=3&&o.setZ(R,L[i*c+2]),c>=4&&o.setW(R,L[i*c+3]),c>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return o}))},le.prototype.loadTexture=function(e){var t=this.json,n=this.options,r=t.textures[e],source=t.images[r.source],o=this.textureLoader;if(source.uri){var l=n.manager.getHandler(source.uri);null!==l&&(o=l)}return this.loadTextureImage(e,source,o)},le.prototype.loadTextureImage=function(e,source,t){var n=this,r=this.json,o=this.options,l=r.textures[e],c=self.URL||self.webkitURL,h=source.uri,d=!1,f=!0;if("image/jpeg"===source.mimeType&&(f=!1),void 0!==source.bufferView)h=n.getDependency("bufferView",source.bufferView).then((function(e){if("image/png"===source.mimeType){var t=new DataView(e,25,1).getUint8(0,!1);f=6===t||4===t||3===t}d=!0;var n=new Blob([e],{type:source.mimeType});return h=c.createObjectURL(n)}));else if(void 0===source.uri)throw new Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");return Promise.resolve(h).then((function(e){return new Promise((function(n,r){var l=n;!0===t.isImageBitmapLoader&&(l=function(e){n(new Io(e))}),t.load(te(e,o.path),l,void 0,r)}))})).then((function(t){!0===d&&c.revokeObjectURL(h),t.flipY=!1,l.name&&(t.name=l.name),f||(t.format=Q);var o=(r.samplers||{})[l.sampler]||{};return t.magFilter=D[o.magFilter]||G,t.minFilter=D[o.minFilter]||W,t.wrapS=N[o.wrapS]||H,t.wrapT=N[o.wrapT]||H,n.associations.set(t,{type:"textures",index:e}),t}))},le.prototype.assignTexture=function(e,t,r){var o=this;return this.getDependency("texture",r.index).then((function(l){if(void 0===r.texCoord||0==r.texCoord||"aoMap"===t&&1==r.texCoord||console.warn("THREE.GLTFLoader: Custom UV set "+r.texCoord+" for texture "+t+" not yet supported."),o.extensions[n.KHR_TEXTURE_TRANSFORM]){var c=void 0!==r.extensions?r.extensions[n.KHR_TEXTURE_TRANSFORM]:void 0;if(c){var h=o.associations.get(l);l=o.extensions[n.KHR_TEXTURE_TRANSFORM].extendTexture(l,c),o.associations.set(l,h)}}e[t]=l}))},le.prototype.assignFinalMaterial=function(e){var t=e.geometry,n=e.material,r=void 0!==t.attributes.tangent,o=void 0!==t.attributes.color,l=void 0===t.attributes.normal,c=!0===e.isSkinnedMesh,h=Object.keys(t.morphAttributes).length>0,d=h&&void 0!==t.morphAttributes.normal;if(e.isPoints){var f="PointsMaterial:"+n.uuid,m=this.cache.get(f);m||(m=new To,tn.prototype.copy.call(m,n),m.color.copy(n.color),m.map=n.map,m.sizeAttenuation=!1,this.cache.add(f,m)),n=m}else if(e.isLine){f="LineBasicMaterial:"+n.uuid;var v=this.cache.get(f);v||(v=new mo,tn.prototype.copy.call(v,n),v.color.copy(n.color),this.cache.add(f,v)),n=v}if(r||o||l||c||h){f="ClonedMaterial:"+n.uuid+":";n.isGLTFSpecularGlossinessMaterial&&(f+="specular-glossiness:"),c&&(f+="skinning:"),r&&(f+="vertex-tangents:"),o&&(f+="vertex-colors:"),l&&(f+="flat-shading:"),h&&(f+="morph-targets:"),d&&(f+="morph-normals:");var y=this.cache.get(f);y||(y=n.clone(),c&&(y.skinning=!0),o&&(y.vertexColors=!0),l&&(y.flatShading=!0),h&&(y.morphTargets=!0),d&&(y.morphNormals=!0),r&&(y.vertexTangents=!0,y.normalScale&&(y.normalScale.y*=-1),y.clearcoatNormalScale&&(y.clearcoatNormalScale.y*=-1)),this.cache.add(f,y),this.associations.set(y,this.associations.get(n))),n=y}n.aoMap&&void 0===t.attributes.uv2&&void 0!==t.attributes.uv&&t.setAttribute("uv2",t.attributes.uv),e.material=n},le.prototype.getMaterialType=function(){return ms},le.prototype.loadMaterial=function(e){var t,r=this,o=this.json,l=this.extensions,c=o.materials[e],h={},d=c.extensions||{},f=[];if(d[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var m=l[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];t=m.getMaterialType(),f.push(m.extendParams(h,c,r))}else if(d[n.KHR_MATERIALS_UNLIT]){var v=l[n.KHR_MATERIALS_UNLIT];t=v.getMaterialType(),f.push(v.extendParams(h,c,r))}else{var y=c.pbrMetallicRoughness||{};if(h.color=new cn(1,1,1),h.opacity=1,Array.isArray(y.baseColorFactor)){var x=y.baseColorFactor;h.color.fromArray(x),h.opacity=x[3]}void 0!==y.baseColorTexture&&f.push(r.assignTexture(h,"map",y.baseColorTexture)),h.metalness=void 0!==y.metallicFactor?y.metallicFactor:1,h.roughness=void 0!==y.roughnessFactor?y.roughnessFactor:1,void 0!==y.metallicRoughnessTexture&&(f.push(r.assignTexture(h,"metalnessMap",y.metallicRoughnessTexture)),f.push(r.assignTexture(h,"roughnessMap",y.metallicRoughnessTexture))),t=this._invokeOne((function(t){return t.getMaterialType&&t.getMaterialType(e)})),f.push(Promise.all(this._invokeAll((function(t){return t.extendMaterialParams&&t.extendMaterialParams(e,h)}))))}!0===c.doubleSided&&(h.side=2);var _=c.alphaMode||$;return _===ee?(h.transparent=!0,h.depthWrite=!1):(h.transparent=!1,_===K&&(h.alphaTest=void 0!==c.alphaCutoff?c.alphaCutoff:.5)),void 0!==c.normalTexture&&t!==un&&(f.push(r.assignTexture(h,"normalMap",c.normalTexture)),h.normalScale=new Se(1,-1),void 0!==c.normalTexture.scale&&h.normalScale.set(c.normalTexture.scale,-c.normalTexture.scale)),void 0!==c.occlusionTexture&&t!==un&&(f.push(r.assignTexture(h,"aoMap",c.occlusionTexture)),void 0!==c.occlusionTexture.strength&&(h.aoMapIntensity=c.occlusionTexture.strength)),void 0!==c.emissiveFactor&&t!==un&&(h.emissive=(new cn).fromArray(c.emissiveFactor)),void 0!==c.emissiveTexture&&t!==un&&f.push(r.assignTexture(h,"emissiveMap",c.emissiveTexture)),Promise.all(f).then((function(){var o;return o=t===M?l[n.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(h):new t(h),c.name&&(o.name=c.name),o.map&&(o.map.encoding=de),o.emissiveMap&&(o.emissiveMap.encoding=de),ae(o,c),r.associations.set(o,{type:"materials",index:e}),c.extensions&&ne(l,o,c),o}))},le.prototype.createUniqueName=function(e){for(var t=mc.sanitizeNodeName(e||""),n=t,i=1;this.nodeNamesUsed[n];++i)n=t+"_"+i;return this.nodeNamesUsed[n]=!0,n},le.prototype.loadGeometries=function(e){var t=this,r=this.extensions,o=this.primitiveCache;function l(e){return r[n.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,t).then((function(n){return ce(n,e,t)}))}for(var c,h,d=[],i=0,f=e.length;i<f;i++){var m,v=e[i],y=(h=void 0,(h=(c=v).extensions&&c.extensions[n.KHR_DRACO_MESH_COMPRESSION])?"draco:"+h.bufferView+":"+h.indices+":"+se(h.attributes):c.indices+":"+se(c.attributes)+":"+c.mode),x=o[y];if(x)d.push(x.promise);else m=v.extensions&&v.extensions[n.KHR_DRACO_MESH_COMPRESSION]?l(v):ce(new Pn,v,t),o[y]={primitive:v,promise:m},d.push(m)}return Promise.all(d)},le.prototype.loadMesh=function(e){for(var t,n=this,r=this.json,o=this.extensions,l=r.meshes[e],c=l.primitives,h=[],i=0,d=c.length;i<d;i++){var f=void 0===c[i].material?(void 0===(t=this.cache).DefaultMaterial&&(t.DefaultMaterial=new ms({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),t.DefaultMaterial):this.getDependency("material",c[i].material);h.push(f)}return h.push(n.loadGeometries(c)),Promise.all(h).then((function(t){for(var r=t.slice(0,t.length-1),h=t[t.length-1],d=[],i=0,f=h.length;i<f;i++){var m,v=h[i],y=c[i],x=r[i];if(y.mode===k||y.mode===P||y.mode===O||void 0===y.mode)!0!==(m=!0===l.isSkinnedMesh?new ro(v,x):new Jn(v,x)).isSkinnedMesh||m.geometry.attributes.skinWeight.normalized||m.normalizeSkinWeights(),y.mode===P?m.geometry=ue(m.geometry,1):y.mode===O&&(m.geometry=ue(m.geometry,2));else if(y.mode===L)m=new So(v,x);else if(y.mode===R)m=new _o(v,x);else if(y.mode===A)m=new Eo(v,x);else{if(y.mode!==C)throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+y.mode);m=new ko(v,x)}Object.keys(m.geometry.morphAttributes).length>0&&oe(m,l),m.name=n.createUniqueName(l.name||"mesh_"+e),ae(m,l),y.extensions&&ne(o,m,y),n.assignFinalMaterial(m),d.push(m)}if(1===d.length)return d[0];var _=new Ea;for(i=0,f=d.length;i<f;i++)_.add(d[i]);return _}))},le.prototype.loadCamera=function(e){var t,n=this.json.cameras[e],r=n[n.type];if(r)return"perspective"===n.type?t=new ri(Me.radToDeg(r.yfov),r.aspectRatio||1,r.znear||1,r.zfar||2e6):"orthographic"===n.type&&(t=new Il(-r.xmag,r.xmag,r.ymag,-r.ymag,r.znear,r.zfar)),n.name&&(t.name=this.createUniqueName(n.name)),ae(t,n),Promise.resolve(t);console.warn("THREE.GLTFLoader: Missing camera parameters.")},le.prototype.loadSkin=function(e){var t=this.json.skins[e],n={joints:t.joints};return void 0===t.inverseBindMatrices?Promise.resolve(n):this.getDependency("accessor",t.inverseBindMatrices).then((function(e){return n.inverseBindMatrices=e,n}))},le.prototype.loadAnimation=function(e){for(var t=this.json.animations[e],n=[],r=[],o=[],l=[],c=[],i=0,h=t.channels.length;i<h;i++){var d=t.channels[i],f=t.samplers[d.sampler],m=d.target,v=void 0!==m.node?m.node:m.id,input=void 0!==t.parameters?t.parameters[f.input]:f.input,output=void 0!==t.parameters?t.parameters[f.output]:f.output;n.push(this.getDependency("node",v)),r.push(this.getDependency("accessor",input)),o.push(this.getDependency("accessor",output)),l.push(f),c.push(m)}return Promise.all([Promise.all(n),Promise.all(r),Promise.all(o),Promise.all(l),Promise.all(c)]).then((function(n){for(var r=n[0],o=n[1],l=n[2],c=n[3],h=n[4],d=[],i=0,f=r.length;i<f;i++){var m=r[i],v=o[i],y=l[i],x=c[i],_=h[i];if(void 0!==m){var w;switch(m.updateMatrix(),m.matrixAutoUpdate=!0,Z[_.path]){case Z.weights:w=ks;break;case Z.rotation:w=Os;break;default:w=Ds}var M=m.name?m.name:m.uuid,S=void 0!==x.interpolation?J[x.interpolation]:re,E=[];Z[_.path]===Z.weights?m.traverse((function(object){!0===object.isMesh&&object.morphTargetInfluences&&E.push(object.name?object.name:object.uuid)})):E.push(M);var C=y.array;if(y.normalized){var L;if(C.constructor===Int8Array)L=1/127;else if(C.constructor===Uint8Array)L=1/255;else if(C.constructor==Int16Array)L=1/32767;else{if(C.constructor!==Uint16Array)throw new Error("THREE.GLTFLoader: Unsupported output accessor component type.");L=1/65535}for(var A=new Float32Array(C.length),R=0,k=C.length;R<k;R++)A[R]=C[R]*L;C=A}for(R=0,k=E.length;R<k;R++){var track=new w(E[R]+"."+Z[_.path],v.array,C,S);"CUBICSPLINE"===x.interpolation&&(track.createInterpolant=function(e){return new T(this.times,this.values,this.getValueSize()/3,e)},track.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),d.push(track)}}}var P=t.name?t.name:"animation_"+e;return new Ns(P,void 0,d)}))},le.prototype.loadNode=function(e){var t,n=this.json,r=this.extensions,o=this,l=n.nodes[e],c=l.name?o.createUniqueName(l.name):"";return(t=[],void 0!==l.mesh&&t.push(o.getDependency("mesh",l.mesh).then((function(e){var t=o._getNodeRef(o.meshCache,l.mesh,e);return void 0!==l.weights&&t.traverse((function(e){if(e.isMesh)for(var i=0,t=l.weights.length;i<t;i++)e.morphTargetInfluences[i]=l.weights[i]})),t}))),void 0!==l.camera&&t.push(o.getDependency("camera",l.camera).then((function(e){return o._getNodeRef(o.cameraCache,l.camera,e)}))),o._invokeAll((function(t){return t.createNodeAttachment&&t.createNodeAttachment(e)})).forEach((function(e){t.push(e)})),Promise.all(t)).then((function(t){var n;if((n=!0===l.isBone?new ao:t.length>1?new Ea:1===t.length?t[0]:new zt)!==t[0])for(var i=0,h=t.length;i<h;i++)n.add(t[i]);if(l.name&&(n.userData.name=l.name,n.name=c),ae(n,l),l.extensions&&ne(r,n,l),void 0!==l.matrix){var d=new pt;d.fromArray(l.matrix),n.applyMatrix4(d)}else void 0!==l.translation&&n.position.fromArray(l.translation),void 0!==l.rotation&&n.quaternion.fromArray(l.rotation),void 0!==l.scale&&n.scale.fromArray(l.scale);return o.associations.set(n,{type:"nodes",index:e}),n}))},le.prototype.loadScene=function(){function e(t,n,r,o){var l=r.nodes[t];return o.getDependency("node",t).then((function(e){return void 0===l.skin?e:o.getDependency("skin",l.skin).then((function(e){for(var n=[],i=0,r=(t=e).joints.length;i<r;i++)n.push(o.getDependency("node",t.joints[i]));return Promise.all(n)})).then((function(n){return e.traverse((function(e){if(e.isMesh){for(var r=[],o=[],l=0,c=n.length;l<c;l++){var h=n[l];if(h){r.push(h);var d=new pt;void 0!==t.inverseBindMatrices&&d.fromArray(t.inverseBindMatrices.array,16*l),o.push(d)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',t.joints[l])}e.bind(new lo(r,o),e.matrixWorld)}})),e}));var t})).then((function(t){n.add(t);var c=[];if(l.children)for(var h=l.children,i=0,d=h.length;i<d;i++){var f=h[i];c.push(e(f,t,r,o))}return Promise.all(c)}))}return function(t){var n=this.json,r=this.extensions,o=this.json.scenes[t],l=new Ea;o.name&&(l.name=this.createUniqueName(o.name)),ae(l,o),o.extensions&&ne(r,l,o);for(var c=o.nodes||[],h=[],i=0,d=c.length;i<d;i++)h.push(e(c[i],l,n,this));return Promise.all(h).then((function(){return l}))}}(),e}()),Wc=function(object,e){var t,n,r,o,l,c;void 0===e&&console.warn('THREE.OrbitControls: The second parameter "domElement" is now mandatory.'),e===document&&console.error('THREE.OrbitControls: "document" should not be used as the target "domElement". Please use "renderer.domElement" instead.'),this.object=object,this.domElement=e,this.enabled=!0,this.target=new Ie,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:E,MIDDLE:T,RIGHT:C},this.touches={ONE:L,TWO:R},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this.getPolarAngle=function(){return _.phi},this.getAzimuthalAngle=function(){return _.theta},this.listenToKeyEvents=function(e){e.addEventListener("keydown",ue),this._domElementKeyEvents=e},this.saveState=function(){h.target0.copy(h.target),h.position0.copy(h.object.position),h.zoom0=h.object.zoom},this.reset=function(){h.target.copy(h.target0),h.object.position.copy(h.position0),h.object.zoom=h.zoom0,h.object.updateProjectionMatrix(),h.dispatchEvent(d),h.update(),y=v.NONE},this.update=(t=new Ie,n=(new Oe).setFromUnitVectors(object.up,new Ie(0,1,0)),r=n.clone().invert(),o=new Ie,l=new Oe,c=2*Math.PI,function(){var e=h.object.position;t.copy(e).sub(h.target),t.applyQuaternion(n),_.setFromVector3(t),h.autoRotate&&y===v.NONE&&G(2*Math.PI/60/60*h.autoRotateSpeed),h.enableDamping?(_.theta+=w.theta*h.dampingFactor,_.phi+=w.phi*h.dampingFactor):(_.theta+=w.theta,_.phi+=w.phi);var f=h.minAzimuthAngle,m=h.maxAzimuthAngle;return isFinite(f)&&isFinite(m)&&(f<-Math.PI?f+=c:f>Math.PI&&(f-=c),m<-Math.PI?m+=c:m>Math.PI&&(m-=c),_.theta=f<=m?Math.max(f,Math.min(m,_.theta)):_.theta>(f+m)/2?Math.max(f,_.theta):Math.min(m,_.theta)),_.phi=Math.max(h.minPolarAngle,Math.min(h.maxPolarAngle,_.phi)),_.makeSafe(),_.radius*=M,_.radius=Math.max(h.minDistance,Math.min(h.maxDistance,_.radius)),!0===h.enableDamping?h.target.addScaledVector(S,h.dampingFactor):h.target.add(S),t.setFromSpherical(_),t.applyQuaternion(r),e.copy(h.target).add(t),h.object.lookAt(h.target),!0===h.enableDamping?(w.theta*=1-h.dampingFactor,w.phi*=1-h.dampingFactor,S.multiplyScalar(1-h.dampingFactor)):(w.set(0,0,0),S.set(0,0,0)),M=1,!!(P||o.distanceToSquared(h.object.position)>x||8*(1-l.dot(h.object.quaternion))>x)&&(h.dispatchEvent(d),o.copy(h.object.position),l.copy(h.object.quaternion),P=!1,!0)}),this.dispose=function(){h.domElement.removeEventListener("contextmenu",fe),h.domElement.removeEventListener("pointerdown",oe),h.domElement.removeEventListener("wheel",ce),h.domElement.removeEventListener("touchstart",he),h.domElement.removeEventListener("touchend",pe),h.domElement.removeEventListener("touchmove",de),h.domElement.ownerDocument.removeEventListener("pointermove",se),h.domElement.ownerDocument.removeEventListener("pointerup",le),null!==h._domElementKeyEvents&&h._domElementKeyEvents.removeEventListener("keydown",ue)};var h=this,d={type:"change"},f={type:"start"},m={type:"end"},v={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},y=v.NONE,x=1e-6,_=new Sc,w=new Sc,M=1,S=new Ie,P=!1,O=new Se,I=new Se,D=new Se,N=new Se,H=new Se,z=new Se,F=new Se,B=new Se,U=new Se;function j(){return Math.pow(.95,h.zoomSpeed)}function G(e){w.theta-=e}function V(e){w.phi-=e}var W,X=(W=new Ie,function(e,t){W.setFromMatrixColumn(t,0),W.multiplyScalar(-e),S.add(W)}),Y=function(){var e=new Ie;return function(t,n){!0===h.screenSpacePanning?e.setFromMatrixColumn(n,1):(e.setFromMatrixColumn(n,0),e.crossVectors(h.object.up,e)),e.multiplyScalar(t),S.add(e)}}(),Z=function(){var e=new Ie;return function(t,n){var element=h.domElement;if(h.object.isPerspectiveCamera){var r=h.object.position;e.copy(r).sub(h.target);var o=e.length();o*=Math.tan(h.object.fov/2*Math.PI/180),X(2*t*o/element.clientHeight,h.object.matrix),Y(2*n*o/element.clientHeight,h.object.matrix)}else h.object.isOrthographicCamera?(X(t*(h.object.right-h.object.left)/h.object.zoom/element.clientWidth,h.object.matrix),Y(n*(h.object.top-h.object.bottom)/h.object.zoom/element.clientHeight,h.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),h.enablePan=!1)}}();function J(e){h.object.isPerspectiveCamera?M/=e:h.object.isOrthographicCamera?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom*e)),h.object.updateProjectionMatrix(),P=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function $(e){h.object.isPerspectiveCamera?M*=e:h.object.isOrthographicCamera?(h.object.zoom=Math.max(h.minZoom,Math.min(h.maxZoom,h.object.zoom/e)),h.object.updateProjectionMatrix(),P=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),h.enableZoom=!1)}function K(e){O.set(e.clientX,e.clientY)}function Q(e){N.set(e.clientX,e.clientY)}function ee(e){if(1==e.touches.length)O.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);O.set(t,n)}}function te(e){if(1==e.touches.length)N.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);N.set(t,n)}}function ne(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);F.set(0,r)}function ie(e){if(1==e.touches.length)I.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);I.set(t,n)}D.subVectors(I,O).multiplyScalar(h.rotateSpeed);var element=h.domElement;G(2*Math.PI*D.x/element.clientHeight),V(2*Math.PI*D.y/element.clientHeight),O.copy(I)}function re(e){if(1==e.touches.length)H.set(e.touches[0].pageX,e.touches[0].pageY);else{var t=.5*(e.touches[0].pageX+e.touches[1].pageX),n=.5*(e.touches[0].pageY+e.touches[1].pageY);H.set(t,n)}z.subVectors(H,N).multiplyScalar(h.panSpeed),Z(z.x,z.y),N.copy(H)}function ae(e){var t=e.touches[0].pageX-e.touches[1].pageX,n=e.touches[0].pageY-e.touches[1].pageY,r=Math.sqrt(t*t+n*n);B.set(0,r),U.set(0,Math.pow(B.y/F.y,h.zoomSpeed)),J(U.y),F.copy(B)}function oe(e){if(!1!==h.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){var t;switch(e.preventDefault(),h.domElement.focus?h.domElement.focus():window.focus(),e.button){case 0:t=h.mouseButtons.LEFT;break;case 1:t=h.mouseButtons.MIDDLE;break;case 2:t=h.mouseButtons.RIGHT;break;default:t=-1}switch(t){case T:if(!1===h.enableZoom)return;!function(e){F.set(e.clientX,e.clientY)}(e),y=v.DOLLY;break;case E:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enablePan)return;Q(e),y=v.PAN}else{if(!1===h.enableRotate)return;K(e),y=v.ROTATE}break;case C:if(e.ctrlKey||e.metaKey||e.shiftKey){if(!1===h.enableRotate)return;K(e),y=v.ROTATE}else{if(!1===h.enablePan)return;Q(e),y=v.PAN}break;default:y=v.NONE}y!==v.NONE&&(h.domElement.ownerDocument.addEventListener("pointermove",se),h.domElement.ownerDocument.addEventListener("pointerup",le),h.dispatchEvent(f))}(e)}}function se(e){if(!1!==h.enabled)switch(e.pointerType){case"mouse":case"pen":!function(e){if(!1===h.enabled)return;switch(e.preventDefault(),y){case v.ROTATE:if(!1===h.enableRotate)return;!function(e){I.set(e.clientX,e.clientY),D.subVectors(I,O).multiplyScalar(h.rotateSpeed);var element=h.domElement;G(2*Math.PI*D.x/element.clientHeight),V(2*Math.PI*D.y/element.clientHeight),O.copy(I),h.update()}(e);break;case v.DOLLY:if(!1===h.enableZoom)return;!function(e){B.set(e.clientX,e.clientY),U.subVectors(B,F),U.y>0?J(j()):U.y<0&&$(j()),F.copy(B),h.update()}(e);break;case v.PAN:if(!1===h.enablePan)return;!function(e){H.set(e.clientX,e.clientY),z.subVectors(H,N).multiplyScalar(h.panSpeed),Z(z.x,z.y),N.copy(H),h.update()}(e)}}(e)}}function le(e){switch(e.pointerType){case"mouse":case"pen":!function(e){if(h.domElement.ownerDocument.removeEventListener("pointermove",se),h.domElement.ownerDocument.removeEventListener("pointerup",le),!1===h.enabled)return;h.dispatchEvent(m),y=v.NONE}()}}function ce(e){!1===h.enabled||!1===h.enableZoom||y!==v.NONE&&y!==v.ROTATE||(e.preventDefault(),h.dispatchEvent(f),function(e){e.deltaY<0?$(j()):e.deltaY>0&&J(j()),h.update()}(e),h.dispatchEvent(m))}function ue(e){!1!==h.enabled&&!1!==h.enablePan&&function(e){var t=!1;switch(e.code){case h.keys.UP:Z(0,h.keyPanSpeed),t=!0;break;case h.keys.BOTTOM:Z(0,-h.keyPanSpeed),t=!0;break;case h.keys.LEFT:Z(h.keyPanSpeed,0),t=!0;break;case h.keys.RIGHT:Z(-h.keyPanSpeed,0),t=!0}t&&(e.preventDefault(),h.update())}(e)}function he(e){if(!1!==h.enabled){switch(e.preventDefault(),e.touches.length){case 1:switch(h.touches.ONE){case L:if(!1===h.enableRotate)return;ee(e),y=v.TOUCH_ROTATE;break;case A:if(!1===h.enablePan)return;te(e),y=v.TOUCH_PAN;break;default:y=v.NONE}break;case 2:switch(h.touches.TWO){case R:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&ne(e),h.enablePan&&te(e)}(e),y=v.TOUCH_DOLLY_PAN;break;case k:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&ne(e),h.enableRotate&&ee(e)}(e),y=v.TOUCH_DOLLY_ROTATE;break;default:y=v.NONE}break;default:y=v.NONE}y!==v.NONE&&h.dispatchEvent(f)}}function de(e){if(!1!==h.enabled)switch(e.preventDefault(),y){case v.TOUCH_ROTATE:if(!1===h.enableRotate)return;ie(e),h.update();break;case v.TOUCH_PAN:if(!1===h.enablePan)return;re(e),h.update();break;case v.TOUCH_DOLLY_PAN:if(!1===h.enableZoom&&!1===h.enablePan)return;!function(e){h.enableZoom&&ae(e),h.enablePan&&re(e)}(e),h.update();break;case v.TOUCH_DOLLY_ROTATE:if(!1===h.enableZoom&&!1===h.enableRotate)return;!function(e){h.enableZoom&&ae(e),h.enableRotate&&ie(e)}(e),h.update();break;default:y=v.NONE}}function pe(e){!1!==h.enabled&&(h.dispatchEvent(m),y=v.NONE)}function fe(e){!1!==h.enabled&&e.preventDefault()}h.domElement.addEventListener("contextmenu",fe),h.domElement.addEventListener("pointerdown",oe),h.domElement.addEventListener("wheel",ce),h.domElement.addEventListener("touchstart",he),h.domElement.addEventListener("touchend",pe),h.domElement.addEventListener("touchmove",de),this.update()};(Wc.prototype=Object.create(xe.prototype)).constructor=Wc;var qc=function(object,e){Wc.call(this,object,e),this.screenSpacePanning=!1,this.mouseButtons.LEFT=C,this.mouseButtons.RIGHT=E,this.touches.ONE=A,this.touches.TWO=k};(qc.prototype=Object.create(xe.prototype)).constructor=qc;var Xc={data:function(){return{load:!0,model:null,cubeMap:null,openModal:1}},methods:{colorFn:function(a,b){var e=this.model,t=new gs({color:parseInt("0x"+b.replace("#","")),shininess:0,envMap:this.cubeMap,combine:1,reflectivity:.1,specular:parseInt("0x"+b.replace("#",""))});"fullcar"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("body003"!=e.name&&"body007"!=e.name&&"body006"!=e.name&&"body018"!=e.name&&"body008"!=e.name&&"body_parts001"!=e.name&&"body011"!=e.name&&"body012"!=e.name&&"body005"!=e.name&&"body015"!=e.name&&"body004"!=e.name&&"body016"!=e.name&&"body002"!=e.name&&"body"!=e.name&&"body_parts003"!=e.name&&"body_parts002"!=e.name&&"body010"!=e.name&&"body013"!=e.name&&"front_side_door_handle"!=e.name&&"rear_side_door_handle"!=e.name&&"body014"!=e.name&&"body017"!=e.name&&"body009"!=e.name&&"body001"!=e.name&&"body019"!=e.name&&"body020"!=e.name&&"body021"!=e.name&&"side_dackward_mirror_parts"!=e.name&&"body_parts"!=e.name||(e.material=t))})),"duotoneup"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("body003"!=e.name&&"body_parts002"!=e.name&&"body014"!=e.name&&"body"!=e.name&&"body017"!=e.name&&"body018"!=e.name&&"body_parts003"!=e.name&&"body019"!=e.name&&"body006"!=e.name&&"body015"!=e.name&&"body016"!=e.name&&"body020"!=e.name&&"body012"!=e.name&&"side_dackward_mirror_parts"!=e.name&&"body013"!=e.name||(e.material=t))})),"duotonedown"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("body007"!=e.name&&"body008"!=e.name&&"body_parts001"!=e.name&&"body011"!=e.name&&"body005"!=e.name&&"body004"!=e.name&&"body002"!=e.name&&"body010"!=e.name&&"front_side_door_handle"!=e.name&&"rear_side_door_handle"!=e.name&&"body009"!=e.name&&"body001"!=e.name&&"body021"!=e.name&&"body_parts"!=e.name||(e.material=t))})),"nocup"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&"body003"==e.name&&(e.material=t)})),"nocvai"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("body003"!=e.name&&"body_parts003"!=e.name&&"body_parts002"!=e.name&&"side_dackward_mirror_parts"!=e.name&&"body019"!=e.name&&"body018"!=e.name&&"body006"!=e.name||(e.material=t))})),"vienkinh"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("window_parts_edge_window001"!=e.name&&"window_parts_edge_window003"!=e.name||(e.material=t))})),"calant"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&"grid"==e.name&&(e.material=t)})),"guong"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&"side_dackward_mirror_parts"==e.name&&(e.material=t)})),"namcua"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("front_side_door_handle"!=e.name&&"rear_side_door_handle"!=e.name||(e.material=t))})),"logo"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("front_logo"!=e.name&&"rear_logo"!=e.name||(e.material=t))})),"viencop"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&"body006"==e.name&&(e.material=t)})),"lazang"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("front_rim04"!=e.name&&"front_rim03"!=e.name&&"front_rim"!=e.name&&"front_rim02"!=e.name||(e.material=t))})),"alldiem"==a&&e.traverse((function(e){e.isMesh&&null!=e.name&&("front_rim04"!=e.name&&"front_rim03"!=e.name&&"front_rim"!=e.name&&"front_rim02"!=e.name&&"body006"!=e.name&&"front_side_door_handle"!=e.name&&"rear_side_door_handle"!=e.name&&"side_dackward_mirror_parts"!=e.name&&"grid"!=e.name&&"window_parts_edge_window001"!=e.name&&"window_parts_edge_window003"!=e.name&&"front_logo"!=e.name&&"rear_logo"!=e.name||(e.material=t))}))},openMenuFn:function(){this.openModal=1},closeMenuFn:function(){this.openModal=0}},mounted:function(){var e,t=this,n=new Oa,r=new Aa({canvas:document.querySelector("#main-car"),antialias:!0});r.setPixelRatio(window.devicePixelRatio),document.body.appendChild(r.domElement);var o=new ri(50,window.innerWidth/window.innerHeight,.1,1e3);o.position.z=5,o.position.x=0,n.rotation.y=-Math.PI/4;var l=(new qs).setPath("textures/cubemap/").load(["HDR_03_r.jpg","HDR_03_l.jpg","HDR_03_t.jpg","HDR_03_d.jpg","HDR_03_f.jpg","HDR_03_b.jpg"]);t.cubeMap=l,n.background=l;var c=new vi(1e3,1e3),h=(new Ys).load("textures/floor.jpg");h.repeat.set(1e3,1e3),h.offset.set(0,0),h.wrapS=H,h.wrapT=H;var d=new Jn(c,new gs({map:h,transparent:!0,opacity:.7}));d.rotation.x=-.5*Math.PI,d.receiveShadow=!0,d.position.y=-1,n.add(d),(new Vc).load("/model/car7.glb",(function(r){e=r.scene,console.log(e),t.model=e,e.traverse((function(e){e.isMesh&&(e.castShadow=!0,e.receiveShadow=!0)})),e.position.y=-1,n.add(e),t.load=!1}),void 0,(function(e){console.error(e)}));var f=new wl(16777215,16777215,.64);f.position.set(0,10,0),n.add(f);var m=new Ol(16777215,.6);m.position.set(0,3,0),m.distance=100,n.add(m);var v=new Wc(o,r.domElement);v.maxPolarAngle=Math.PI/2,v.minPolarAngle=Math.PI/3,v.enableDamping=!0,v.enablePan=!1,v.dampingFactor=.1,v.autoRotate=!1,v.autoRotateSpeed=.1,function animate(){if(v.update(),r.render(n,o),requestAnimationFrame(animate),function(e){var canvas=e.domElement,t=window.innerWidth,n=window.innerHeight,r=canvas.width/window.devicePixelRatio,o=canvas.height/window.devicePixelRatio,l=r!==t||o!==n;l&&e.setSize(t,n,!1);return l}(r)){var e=r.domElement;o.aspect=e.clientWidth/e.clientHeight,o.updateProjectionMatrix()}}()}},Yc=(n(511),n(72)),component=Object(Yc.a)(Xc,(function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("Loading",{directives:[{name:"show",rawName:"v-show",value:e.load,expression:"load"}]}),e._v(" "),n("canvas",{attrs:{id:"main-car"}}),e._v(" "),n("Gui"),e._v(" "),n("Buttonfloat",{on:{openMenu:e.openMenuFn}}),e._v(" "),n("Setting",{attrs:{openModal:this.openModal},on:{closeMenu:e.closeMenuFn,changeColor:e.colorFn}})],1)}),[],!1,null,null,null);t.default=component.exports;installComponents(component,{Loading:n(453).default,Gui:n(454).default,Buttonfloat:n(455).default,Setting:n(391).default})}}]);